<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-modules/arc" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">ARC module | Rspamd Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/arc"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ru"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ARC module | Rspamd Documentation"><meta data-rh="true" name="description" content="This module verifies and signs ARC (Authenticated Received Chain) signatures and seals for emails. ARC provides a mechanism for preserving email authentication results across trusted intermediaries, which is particularly useful for mailing lists and forwarding services that may modify messages in ways that break SPF and DKIM alignment."><meta data-rh="true" property="og:description" content="This module verifies and signs ARC (Authenticated Received Chain) signatures and seals for emails. ARC provides a mechanism for preserving email authentication results across trusted intermediaries, which is particularly useful for mailing lists and forwarding services that may modify messages in ways that break SPF and DKIM alignment."><link data-rh="true" rel="icon" href="/docs.rspamd.com/branches/docs/arc-update/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/arc"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/arc" hreflang="en"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/ru/modules/arc" hreflang="ru"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/arc" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Modules","item":"https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/"},{"@type":"ListItem","position":2,"name":"ARC module","item":"https://rspamd.com/docs.rspamd.com/branches/docs/arc-update/modules/arc"}]}</script><link rel="alternate" type="application/rss+xml" href="/docs.rspamd.com/branches/docs/arc-update/blog/rss.xml" title="Rspamd Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs.rspamd.com/branches/docs/arc-update/blog/atom.xml" title="Rspamd Blog Atom Feed">




<script>window.SEARCH_BACKEND_CONFIG={endpoint:"/api"}</script>

<link rel="alternate" type="application/rss+xml" title="Rspamd Changelog RSS" href="/rss/changelog.xml">
<link rel="alternate" type="application/rss+xml" title="Rspamd Blog RSS" href="/blog/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Rspamd Blog Atom" href="/blog/atom.xml"><link rel="stylesheet" href="/docs.rspamd.com/branches/docs/arc-update/assets/css/styles.10e2e935.css">
<script src="/docs.rspamd.com/branches/docs/arc-update/assets/js/runtime~main.407686a6.js" defer="defer"></script>
<script src="/docs.rspamd.com/branches/docs/arc-update/assets/js/main.a05e7519.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs.rspamd.com/branches/docs/arc-update/img/rspamd_logo_black.png"><link rel="preload" as="image" href="/docs.rspamd.com/branches/docs/arc-update/img/rspamd_logo_navbar.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.rspamd.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs.rspamd.com/branches/docs/arc-update/img/rspamd_logo_black.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs.rspamd.com/branches/docs/arc-update/img/rspamd_logo_navbar.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/about/">About</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/docs/arc-update/tutorials/">Tutorials</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/modules/">Modules</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/other/usage_policy">Usage Policy</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/faq">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/support">Support</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/docs/arc-update/downloads">Downloads</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/docs/arc-update/blog">Blog</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/docs/arc-update/changelog">Changelog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div><div class="elasticsearch-search-container"><form class="elasticsearch-search-form"><div class="elasticsearch-search-input-container"><input type="text" placeholder="Search documentation..." class="elasticsearch-search-input" aria-label="Search documentation" value=""><div class="elasticsearch-search-shortcut"><span>⌘K</span></div></div></form></div></div><div class="navbar__item"><div id="font-size-control-mount"></div></div><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/docs/arc-update/"><span title="About Rspamd" class="linkLabel_WmDU">About Rspamd</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs.rspamd.com/branches/docs/arc-update/tutorials/migration"><span title="How-To Guides" class="categoryLinkLabel_W154">How-To Guides</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/docs/arc-update/faq"><span title="Frequently asked questions" class="linkLabel_WmDU">Frequently asked questions</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/about/"><span title="About" class="categoryLinkLabel_W154">About</span></a><button aria-label="Expand sidebar category &#x27;About&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/docs/arc-update/support"><span title="Rspamd Support" class="linkLabel_WmDU">Rspamd Support</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/docs/arc-update/downloads"><span title="Downloads" class="linkLabel_WmDU">Downloads</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/configuration/"><span title="Configuration" class="categoryLinkLabel_W154">Configuration</span></a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/workers/"><span title="Workers" class="categoryLinkLabel_W154">Workers</span></a><button aria-label="Expand sidebar category &#x27;Workers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs.rspamd.com/branches/docs/arc-update/modules/"><span title="Modules" class="categoryLinkLabel_W154">Modules</span></a><button aria-label="Collapse sidebar category &#x27;Modules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/antivirus"><span title="Antivirus module" class="linkLabel_WmDU">Antivirus module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/arc"><span title="ARC module" class="linkLabel_WmDU">ARC module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/asn"><span title="ASN module" class="linkLabel_WmDU">ASN module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/bayes_expiry"><span title="Bayes expiry module" class="linkLabel_WmDU">Bayes expiry module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/chartable"><span title="Chartable module" class="linkLabel_WmDU">Chartable module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/clickhouse"><span title="Clickhouse module" class="linkLabel_WmDU">Clickhouse module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/dcc"><span title="DCC module" class="linkLabel_WmDU">DCC module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/dkim"><span title="DKIM module" class="linkLabel_WmDU">DKIM module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/dkim_signing"><span title="DKIM signing module" class="linkLabel_WmDU">DKIM signing module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/dmarc"><span title="DMARC module" class="linkLabel_WmDU">DMARC module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/elastic"><span title="Elasticsearch module" class="linkLabel_WmDU">Elasticsearch module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/emails"><span title="Emails module" class="linkLabel_WmDU">Emails module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/external_relay"><span title="External Relay module" class="linkLabel_WmDU">External Relay module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/external_services"><span title="External Services module" class="linkLabel_WmDU">External Services module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/force_actions"><span title="Force Actions module" class="linkLabel_WmDU">Force Actions module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/fuzzy_check"><span title="Fuzzy check module" class="linkLabel_WmDU">Fuzzy check module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/gpt"><span title="GPT Plugin" class="linkLabel_WmDU">GPT Plugin</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/greylisting"><span title="Greylisting module" class="linkLabel_WmDU">Greylisting module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/hfilter"><span title="Hfilter module" class="linkLabel_WmDU">Hfilter module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/history_redis"><span title="Redis history module" class="linkLabel_WmDU">Redis history module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/ip_score"><span title="IP Score module" class="linkLabel_WmDU">IP Score module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/known_senders"><span title="Known senders module" class="linkLabel_WmDU">Known senders module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/maillist"><span title="Mailing lists module" class="linkLabel_WmDU">Mailing lists module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/metadata_exporter"><span title="Metadata exporter" class="linkLabel_WmDU">Metadata exporter</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/metric_exporter"><span title="Metric exporter" class="linkLabel_WmDU">Metric exporter</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/mid"><span title="MID module" class="linkLabel_WmDU">MID module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/milter_headers"><span title="Milter headers module" class="linkLabel_WmDU">Milter headers module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/mime_types"><span title="Mime types modules" class="linkLabel_WmDU">Mime types modules</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/multimap"><span title="Multimap module" class="linkLabel_WmDU">Multimap module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/mx_check"><span title="MX Check module" class="linkLabel_WmDU">MX Check module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/neural"><span title="Neural network module" class="linkLabel_WmDU">Neural network module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/once_received"><span title="Once received module" class="linkLabel_WmDU">Once received module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/phishing"><span title="Phishing module" class="linkLabel_WmDU">Phishing module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/ratelimit"><span title="Ratelimit module" class="linkLabel_WmDU">Ratelimit module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/rbl"><span title="RBL module" class="linkLabel_WmDU">RBL module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/regexp"><span title="Regexp module" class="linkLabel_WmDU">Regexp module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/replies"><span title="Replies module" class="linkLabel_WmDU">Replies module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/reputation"><span title="Reputation module" class="linkLabel_WmDU">Reputation module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/rspamd_update"><span title="Rspamd update module" class="linkLabel_WmDU">Rspamd update module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/spamassassin"><span title="SpamAssassin rules module" class="linkLabel_WmDU">SpamAssassin rules module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/spamtrap"><span title="Spamtrap module" class="linkLabel_WmDU">Spamtrap module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/spf"><span title="SPF module" class="linkLabel_WmDU">SPF module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/surbl"><span title="SURBL module" class="linkLabel_WmDU">SURBL module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/trie"><span title="Trie module" class="linkLabel_WmDU">Trie module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/url_redirector"><span title="URL redirector module" class="linkLabel_WmDU">URL redirector module</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/docs/arc-update/modules/whitelist"><span title="Whitelist module" class="linkLabel_WmDU">Whitelist module</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/lua/"><span title="Lua API" class="categoryLinkLabel_W154">Lua API</span></a><button aria-label="Expand sidebar category &#x27;Lua API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/developers/architecture"><span title="Developers" class="categoryLinkLabel_W154">Developers</span></a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/docs/arc-update/administration/rspamadm/"><span title="Administration Tools" class="categoryLinkLabel_W154">Administration Tools</span></a><button aria-label="Expand sidebar category &#x27;Administration Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs.rspamd.com/branches/docs/arc-update/other/gtube_patterns"><span title="Other" class="categoryLinkLabel_W154">Other</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/docs/arc-update/blog"><span title="Blog" class="linkLabel_WmDU">Blog</span></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs.rspamd.com/branches/docs/arc-update/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs.rspamd.com/branches/docs/arc-update/modules/"><span>Modules</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ARC module</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ARC module</h1></header>
<p>This module verifies and signs <a href="https://arc-spec.org/" target="_blank" rel="noopener noreferrer" class="">ARC</a> (Authenticated Received Chain) signatures and seals for emails. ARC provides a mechanism for preserving email authentication results across trusted intermediaries, which is particularly useful for mailing lists and forwarding services that may modify messages in ways that break SPF and DKIM alignment.</p>
<p>The ARC standard is defined in <a href="https://tools.ietf.org/html/rfc8617" target="_blank" rel="noopener noreferrer" class="">RFC 8617</a>. An overview presentation is available at <a href="https://dmarc.org/presentations/ARC-Overview-2016Q2-v03.pdf" target="_blank" rel="noopener noreferrer" class="">https://dmarc.org/presentations/ARC-Overview-2016Q2-v03.pdf</a>.</p>
<p>Rspamd supports both ARC verification and signing since version 1.6. It uses the <a class="" href="/docs.rspamd.com/branches/docs/arc-update/modules/dkim">dkim</a> module internally for cryptographic operations.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="symbols">Symbols<a href="#symbols" class="hash-link" aria-label="Direct link to Symbols" title="Direct link to Symbols" translate="no">​</a></h2>
<p>The module registers the following symbols:</p>













































<table><thead><tr><th>Symbol</th><th>Score</th><th>Description</th></tr></thead><tbody><tr><td><code>ARC_ALLOW</code></td><td>-1.0</td><td>Valid ARC chain found</td></tr><tr><td><code>ARC_REJECT</code></td><td>2.0</td><td>ARC chain validation failed</td></tr><tr><td><code>ARC_INVALID</code></td><td>1.0</td><td>ARC chain structure is invalid</td></tr><tr><td><code>ARC_DNSFAIL</code></td><td>0.0</td><td>DNS lookup failed during validation</td></tr><tr><td><code>ARC_NA</code></td><td>0.0</td><td>No ARC headers present</td></tr><tr><td><code>ARC_ALLOW_TRUSTED</code></td><td>-2.0</td><td>Valid ARC chain from a trusted forwarder (requires <code>whitelisted_signers_map</code>)</td></tr><tr><td><code>ARC_SIGNED</code></td><td>0.0</td><td>Message was signed with ARC</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" translate="no">​</a></h2>
<p>Settings should be added to <code>/etc/rspamd/local.d/arc.conf</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-settings">Basic settings<a href="#basic-settings" class="hash-link" aria-label="Direct link to Basic settings" title="Direct link to Basic settings" translate="no">​</a></h3>



































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>selector</code></td><td>string</td><td><code>arc</code></td><td>Default selector for ARC signing</td></tr><tr><td><code>path</code></td><td>string</td><td><code>${DBDIR}/arc/$domain.$selector.key</code></td><td>Path to signing key (supports <code>$domain</code> and <code>$selector</code> variables)</td></tr><tr><td><code>sign_symbol</code></td><td>string</td><td><code>ARC_SIGNED</code></td><td>Symbol added when message is signed</td></tr><tr><td><code>try_fallback</code></td><td>boolean</td><td><code>true</code></td><td>Fall back to global config if domain-specific config not found</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="domain-selection">Domain selection<a href="#domain-selection" class="hash-link" aria-label="Direct link to Domain selection" title="Direct link to Domain selection" translate="no">​</a></h3>















































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>use_domain</code></td><td>string</td><td><code>header</code></td><td>Domain source: <code>header</code> (MIME From), <code>envelope</code> (SMTP From), <code>recipient</code> (SMTP To), <code>auth</code> (authenticated user), or explicit domain name</td></tr><tr><td><code>use_esld</code></td><td>boolean</td><td><code>true</code></td><td>Normalize domains to effective second-level domain (eSLD)</td></tr><tr><td><code>use_domain_sign_networks</code></td><td>string</td><td>-</td><td>Override <code>use_domain</code> for sign_networks</td></tr><tr><td><code>use_domain_sign_local</code></td><td>string</td><td>-</td><td>Override <code>use_domain</code> for local IPs</td></tr><tr><td><code>use_domain_sign_inbound</code></td><td>string</td><td>-</td><td>Override <code>use_domain</code> for inbound mail</td></tr><tr><td><code>use_domain_custom</code></td><td>string/function</td><td>-</td><td>Custom Lua function to determine signing domain</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="signing-eligibility">Signing eligibility<a href="#signing-eligibility" class="hash-link" aria-label="Direct link to Signing eligibility" title="Direct link to Signing eligibility" translate="no">​</a></h3>





















































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>sign_authenticated</code></td><td>boolean</td><td><code>true</code></td><td>Sign messages from authenticated users</td></tr><tr><td><code>sign_local</code></td><td>boolean</td><td><code>true</code></td><td>Sign messages from local IP addresses</td></tr><tr><td><code>sign_inbound</code></td><td>boolean</td><td><code>false</code></td><td>Sign inbound messages (not local, not authenticated)</td></tr><tr><td><code>sign_networks</code></td><td>map</td><td>-</td><td>Map of networks eligible for signing</td></tr><tr><td><code>skip_spam_sign</code></td><td>boolean</td><td><code>false</code></td><td>Skip signing if message is marked as spam</td></tr><tr><td><code>allowed_ids</code></td><td>table</td><td>-</td><td>List of settings IDs that allow signing</td></tr><tr><td><code>forbidden_ids</code></td><td>table</td><td>-</td><td>List of settings IDs that forbid signing</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="headerenvelope-validation">Header/envelope validation<a href="#headerenvelope-validation" class="hash-link" aria-label="Direct link to Header/envelope validation" title="Direct link to Header/envelope validation" translate="no">​</a></h3>















































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>allow_envfrom_empty</code></td><td>boolean</td><td><code>true</code></td><td>Allow signing with empty envelope From</td></tr><tr><td><code>allow_hdrfrom_mismatch</code></td><td>boolean</td><td><code>false</code></td><td>Allow envelope/header From domain mismatch</td></tr><tr><td><code>allow_hdrfrom_mismatch_local</code></td><td>boolean</td><td><code>false</code></td><td>Allow mismatch for local IPs</td></tr><tr><td><code>allow_hdrfrom_mismatch_sign_networks</code></td><td>boolean</td><td><code>false</code></td><td>Allow mismatch for sign_networks</td></tr><tr><td><code>allow_hdrfrom_multiple</code></td><td>boolean</td><td><code>false</code></td><td>Allow multiple From headers (only first is used)</td></tr><tr><td><code>allow_username_mismatch</code></td><td>boolean</td><td><code>false</code></td><td>Allow authenticated user domain to differ from signing domain</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="trusted-forwarders-and-whitelisting">Trusted forwarders and whitelisting<a href="#trusted-forwarders-and-whitelisting" class="hash-link" aria-label="Direct link to Trusted forwarders and whitelisting" title="Direct link to Trusted forwarders and whitelisting" translate="no">​</a></h3>





























<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>whitelisted_signers_map</code></td><td>map</td><td>-</td><td>Map of trusted ARC forwarder domains</td></tr><tr><td><code>whitelist</code></td><td>map</td><td>-</td><td>Map of domains with broken ARC implementations to trust despite validation failures</td></tr><tr><td><code>adjust_dmarc</code></td><td>boolean</td><td><code>true</code></td><td>Adjust DMARC score when trusted forwarder provides valid ARC chain</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="redis-integration">Redis integration<a href="#redis-integration" class="hash-link" aria-label="Direct link to Redis integration" title="Direct link to Redis integration" translate="no">​</a></h3>





























<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>use_redis</code></td><td>boolean</td><td><code>false</code></td><td>Load signing keys from Redis</td></tr><tr><td><code>key_prefix</code></td><td>string</td><td><code>arc_keys</code></td><td>Redis hash name for keys</td></tr><tr><td><code>selector_prefix</code></td><td>string</td><td>-</td><td>Redis hash name for selectors (optional)</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="vault-integration">Vault integration<a href="#vault-integration" class="hash-link" aria-label="Direct link to Vault integration" title="Direct link to Vault integration" translate="no">​</a></h3>















































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>use_vault</code></td><td>boolean</td><td><code>false</code></td><td>Load signing keys from HashiCorp Vault</td></tr><tr><td><code>vault_url</code></td><td>string</td><td>-</td><td>Vault server URL</td></tr><tr><td><code>vault_token</code></td><td>string</td><td>-</td><td>Vault authentication token</td></tr><tr><td><code>vault_path</code></td><td>string</td><td><code>dkim</code></td><td>Path in Vault for keys</td></tr><tr><td><code>vault_kv_version</code></td><td>number</td><td><code>1</code></td><td>Vault KV secrets engine version (1 or 2)</td></tr><tr><td><code>vault_domains</code></td><td>map</td><td>-</td><td>Map of domains to look up in Vault</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="public-key-verification">Public key verification<a href="#public-key-verification" class="hash-link" aria-label="Direct link to Public key verification" title="Direct link to Public key verification" translate="no">​</a></h3>























<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>check_pubkey</code></td><td>boolean</td><td><code>false</code></td><td>Verify public key exists before signing</td></tr><tr><td><code>allow_pubkey_mismatch</code></td><td>boolean</td><td><code>false</code></td><td>Continue signing even if public key lookup fails</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="authentication-results">Authentication results<a href="#authentication-results" class="hash-link" aria-label="Direct link to Authentication results" title="Direct link to Authentication results" translate="no">​</a></h3>

















<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>reuse_auth_results</code></td><td>boolean</td><td><code>false</code></td><td>Reuse existing Authentication-Results header instead of generating new one</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="http-headers-for-proxy-integration">HTTP headers (for proxy integration)<a href="#http-headers-for-proxy-integration" class="hash-link" aria-label="Direct link to HTTP headers (for proxy integration)" title="Direct link to HTTP headers (for proxy integration)" translate="no">​</a></h3>















































<table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>use_http_headers</code></td><td>boolean</td><td><code>false</code></td><td>Get signing parameters from HTTP request headers</td></tr><tr><td><code>http_sign_header</code></td><td>string</td><td><code>PerformDkimSign</code></td><td>Header indicating signing should be performed</td></tr><tr><td><code>http_domain_header</code></td><td>string</td><td><code>DkimDomain</code></td><td>Header containing domain</td></tr><tr><td><code>http_selector_header</code></td><td>string</td><td><code>DkimSelector</code></td><td>Header containing selector</td></tr><tr><td><code>http_key_header</code></td><td>string</td><td><code>DkimPrivateKey</code></td><td>Header containing private key</td></tr><tr><td><code>allow_headers_fallback</code></td><td>boolean</td><td><code>false</code></td><td>Fall back to normal signing if headers missing</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-configuration-example">Basic configuration example<a href="#basic-configuration-example" class="hash-link" aria-label="Direct link to Basic configuration example" title="Direct link to Basic configuration example" translate="no">​</a></h2>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default signing selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector = &quot;arc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Path template for keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path = &quot;${DBDIR}/arc/$domain.$selector.key&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sign mail from authenticated users and local networks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sign_authenticated = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sign_local = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use header From domain for signing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use_domain = &quot;header&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use_esld = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Domain-specific configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  example.com {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path = &quot;${DBDIR}/arc/example.com.key&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    selector = &quot;arc2024&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="trusted-arc-forwarders">Trusted ARC forwarders<a href="#trusted-arc-forwarders" class="hash-link" aria-label="Direct link to Trusted ARC forwarders" title="Direct link to Trusted ARC forwarders" translate="no">​</a></h2>
<p>The <code>whitelisted_signers_map</code> setting allows you to configure trusted ARC forwarders. When an email has a valid ARC chain that includes a signature from one of these trusted domains, Rspamd will:</p>
<ol>
<li class="">Add the <code>ARC_ALLOW_TRUSTED</code> symbol with a score of -2.0</li>
<li class="">If <code>adjust_dmarc</code> is enabled (default), reduce the impact of DMARC failures</li>
</ol>
<p>This is particularly useful for legitimate email forwarding services that may alter messages in ways that break DKIM signatures, but can be trusted based on their ARC signatures.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Inline array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whitelisted_signers_map = [&quot;mailgun.org&quot;, &quot;sendgrid.net&quot;, &quot;amazonses.com&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Or file-based map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whitelisted_signers_map = &quot;file:///etc/rspamd/maps/arc_trusted_signers.map&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Adjust DMARC policy for trusted forwarders (enabled by default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adjust_dmarc = true;</span><br></span></code></pre></div></div>
<p>For file-based maps, create a simple text file with one domain per line:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mailgun.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sendgrid.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">amazonses.com</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="handling-broken-arc-implementations">Handling broken ARC implementations<a href="#handling-broken-arc-implementations" class="hash-link" aria-label="Direct link to Handling broken ARC implementations" title="Direct link to Handling broken ARC implementations" translate="no">​</a></h2>
<p>Some email services have broken ARC implementations that fail validation despite being legitimate forwarders. The <code>whitelist</code> option allows ARC chain validation to continue despite failures from specified domains.</p>
<p>When a domain is in the whitelist:</p>
<ul>
<li class="">ARC signature/seal validation failures for that domain are logged but treated as valid</li>
<li class="">The ARC chain validation continues to the next step</li>
<li class="">This preserves the security of the overall chain while accommodating known bugs</li>
</ul>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Domains with known broken ARC implementations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whitelist = [&quot;broken-forwarder.com&quot;, &quot;buggy-arc.example&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Or file-based map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whitelist = &quot;file:///etc/rspamd/maps/arc_whitelist.map&quot;;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="arc-keys-in-redis">ARC keys in Redis<a href="#arc-keys-in-redis" class="hash-link" aria-label="Direct link to ARC keys in Redis" title="Direct link to ARC keys in Redis" translate="no">​</a></h2>
<p>To store ARC signing keys in Redis:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use_redis = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_prefix = &quot;arc_keys&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector = &quot;myselector&quot;;</span><br></span></code></pre></div></div>
<p>Populate the hash with keys using the format <code>selector.domain</code>:</p>
<div class="language-lua codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-lua codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Run with: redis-cli --eval script.lua</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:rgb(222, 71, 0)">local</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">[[-----BEGIN PRIVATE KEY-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBANe3EETkiI1Exyrb</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">-----END PRIVATE KEY-----]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;HMSET&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arc_keys&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;myselector.example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-maps-for-selectors-and-paths">Using maps for selectors and paths<a href="#using-maps-for-selectors-and-paths" class="hash-link" aria-label="Direct link to Using maps for selectors and paths" title="Direct link to Using maps for selectors and paths" translate="no">​</a></h2>
<p>Use <code>selector_map</code> and <code>path_map</code> to configure per-domain selectors and key paths:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try_fallback = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path = &quot;${DBDIR}/arc/$domain.$selector.key&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector_map = &quot;/etc/rspamd/arc_selectors.map&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector = &quot;arc&quot;;</span><br></span></code></pre></div></div>
<p>Map format (domain followed by value):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.net arc2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.org default</span><br></span></code></pre></div></div>
<p>For paths:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.net /var/lib/rspamd/arc/example.net.$selector.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.org /etc/rspamd/arc/example.org.key</span><br></span></code></pre></div></div>
<p>To require explicit configuration for each domain (no fallback):</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try_fallback = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector_map = &quot;/etc/rspamd/arc_selectors.map&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path_map = &quot;/etc/rspamd/arc_paths.map&quot;;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="vault-integration-1">Vault integration<a href="#vault-integration-1" class="hash-link" aria-label="Direct link to Vault integration" title="Direct link to Vault integration" translate="no">​</a></h2>
<p>For HashiCorp Vault integration:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use_vault = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vault_url = &quot;https://vault.example.com:8200&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vault_token = &quot;your-vault-token&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vault_path = &quot;secret/dkim&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vault_kv_version = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Optional: restrict to specific domains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vault_domains = [&quot;example.com&quot;, &quot;example.org&quot;];</span><br></span></code></pre></div></div>
<p>Expected Vault secret structure at <code>secret/dkim/example.com</code>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;selectors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;selector&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;arc2024&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;domain&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-----BEGIN PRIVATE KEY-----\n...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;valid_start&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1704067200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;valid_end&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1735689600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="sign-headers">Sign headers<a href="#sign-headers" class="hash-link" aria-label="Direct link to Sign headers" title="Direct link to Sign headers" translate="no">​</a></h2>
<p>From version 1.8.4, Rspamd uses a specific set of headers for ARC signing. The default can be overridden:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/arc.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sign_headers = &quot;(o)from:(o)sender:(o)reply-to:(o)subject:(o)date:(o)message-id:(o)to:(o)cc:(o)mime-version:(o)content-type:(o)content-transfer-encoding:resent-to:resent-cc:resent-from:resent-sender:resent-message-id:(o)in-reply-to:(o)references:list-id:list-owner:list-unsubscribe:list-subscribe:list-post:dkim-signature&quot;;</span><br></span></code></pre></div></div>
<p>The <code>(o)</code> prefix indicates optional headers (included only if present).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/arc.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs.rspamd.com/branches/docs/arc-update/modules/antivirus"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Antivirus module</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs.rspamd.com/branches/docs/arc-update/modules/asn"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ASN module</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#symbols" class="table-of-contents__link toc-highlight">Symbols</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#basic-settings" class="table-of-contents__link toc-highlight">Basic settings</a></li><li><a href="#domain-selection" class="table-of-contents__link toc-highlight">Domain selection</a></li><li><a href="#signing-eligibility" class="table-of-contents__link toc-highlight">Signing eligibility</a></li><li><a href="#headerenvelope-validation" class="table-of-contents__link toc-highlight">Header/envelope validation</a></li><li><a href="#trusted-forwarders-and-whitelisting" class="table-of-contents__link toc-highlight">Trusted forwarders and whitelisting</a></li><li><a href="#redis-integration" class="table-of-contents__link toc-highlight">Redis integration</a></li><li><a href="#vault-integration" class="table-of-contents__link toc-highlight">Vault integration</a></li><li><a href="#public-key-verification" class="table-of-contents__link toc-highlight">Public key verification</a></li><li><a href="#authentication-results" class="table-of-contents__link toc-highlight">Authentication results</a></li><li><a href="#http-headers-for-proxy-integration" class="table-of-contents__link toc-highlight">HTTP headers (for proxy integration)</a></li></ul></li><li><a href="#basic-configuration-example" class="table-of-contents__link toc-highlight">Basic configuration example</a></li><li><a href="#trusted-arc-forwarders" class="table-of-contents__link toc-highlight">Trusted ARC forwarders</a></li><li><a href="#handling-broken-arc-implementations" class="table-of-contents__link toc-highlight">Handling broken ARC implementations</a></li><li><a href="#arc-keys-in-redis" class="table-of-contents__link toc-highlight">ARC keys in Redis</a></li><li><a href="#using-maps-for-selectors-and-paths" class="table-of-contents__link toc-highlight">Using maps for selectors and paths</a></li><li><a href="#vault-integration-1" class="table-of-contents__link toc-highlight">Vault integration</a></li><li><a href="#sign-headers" class="table-of-contents__link toc-highlight">Sign headers</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/tutorials/quickstart">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/configuration">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/modules">Modules</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/tutorials">Tutorials</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/downloads">Downloads</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/changelog">Changelog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/tutorials/site_contributing">Contributing</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Subscribe</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/rss/changelog.xml">Changelog RSS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/blog/rss.xml">Blog RSS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/docs/arc-update/blog/atom.xml">Blog Atom</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Rspamd Project. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>