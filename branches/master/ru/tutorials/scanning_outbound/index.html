<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/scanning_outbound" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Scanning outbound mail | Rspamd Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rspamd.com/docs.rspamd.com/branches/master/ru/tutorials/scanning_outbound"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Scanning outbound mail | Rspamd Documentation"><meta data-rh="true" name="description" content="Why scan outbound mail"><meta data-rh="true" property="og:description" content="Why scan outbound mail"><link data-rh="true" rel="icon" href="/docs.rspamd.com/branches/master/ru/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rspamd.com/docs.rspamd.com/branches/master/ru/tutorials/scanning_outbound"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/master/tutorials/scanning_outbound" hreflang="en"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/master/ru/tutorials/scanning_outbound" hreflang="ru"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/master/tutorials/scanning_outbound" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Scanning outbound mail","item":"https://rspamd.com/docs.rspamd.com/branches/master/ru/tutorials/scanning_outbound"}]}</script><link rel="alternate" type="application/rss+xml" href="/docs.rspamd.com/branches/master/ru/blog/rss.xml" title="Rspamd Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs.rspamd.com/branches/master/ru/blog/atom.xml" title="Rspamd Blog Atom Feed">




<script>window.SEARCH_BACKEND_CONFIG={endpoint:"/api"}</script>

<link rel="alternate" type="application/rss+xml" title="Rspamd Changelog RSS" href="/rss/changelog.xml">
<link rel="alternate" type="application/rss+xml" title="Rspamd Blog RSS" href="/blog/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Rspamd Blog Atom" href="/blog/atom.xml"><link rel="stylesheet" href="/docs.rspamd.com/branches/master/ru/assets/css/styles.5200ff8d.css">
<script src="/docs.rspamd.com/branches/master/ru/assets/js/runtime~main.72ee80c0.js" defer="defer"></script>
<script src="/docs.rspamd.com/branches/master/ru/assets/js/main.544a51e8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs.rspamd.com/branches/master/ru/img/rspamd_logo_black.png"><link rel="preload" as="image" href="/docs.rspamd.com/branches/master/ru/img/rspamd_logo_navbar.png"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.rspamd.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs.rspamd.com/branches/master/ru/img/rspamd_logo_black.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs.rspamd.com/branches/master/ru/img/rspamd_logo_navbar.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/">Documentation</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/master/ru/about/">About</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/master/ru/tutorials/">Tutorials</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/modules/">Modules</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/other/usage_policy">Usage Policy</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/faq">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/support">Support</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/master/ru/downloads">Downloads</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/master/ru/blog">Blog</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/master/ru/changelog">Changelog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div><div class="elasticsearch-search-container"><form class="elasticsearch-search-form"><div class="elasticsearch-search-input-container"><input type="text" placeholder="Search documentation..." class="elasticsearch-search-input" aria-label="Search documentation" value=""><div class="elasticsearch-search-shortcut"><span>⌘K</span></div></div></form></div></div><div class="navbar__item"><div id="font-size-control-mount"></div></div><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Переключение между темным и светлым режимом (сейчас используется system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/master/ru/"><span title="About Rspamd" class="linkLabel_WmDU">About Rspamd</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs.rspamd.com/branches/master/ru/tutorials/migration"><span title="How-To Guides" class="categoryLinkLabel_W154">How-To Guides</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/migration"><span title="Upgrading" class="linkLabel_WmDU">Upgrading</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/migrate_sa"><span title="Migrating from SpamAssassin" class="linkLabel_WmDU">Migrating from SpamAssassin</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/scanning_outbound"><span title="Scanning outbound mail" class="linkLabel_WmDU">Scanning outbound mail</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/fuzzy_storage"><span title="Usage of fuzzy hashes" class="linkLabel_WmDU">Usage of fuzzy hashes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/redis_replication"><span title="Multi-instance Redis replication" class="linkLabel_WmDU">Multi-instance Redis replication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/stunnel_setup"><span title="Setup stunnel to protect Redis" class="linkLabel_WmDU">Setup stunnel to protect Redis</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/integration"><span title="MTA integration" class="linkLabel_WmDU">MTA integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/feedback_from_users_with_IMAPSieve"><span title="Getting feedback from users with IMAPSieve" class="linkLabel_WmDU">Getting feedback from users with IMAPSieve</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/site_contributing"><span title="Contributing to Rspamd Documentation" class="linkLabel_WmDU">Contributing to Rspamd Documentation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs.rspamd.com/branches/master/ru/tutorials/multimap_guide"><span title="Module Guides" class="categoryLinkLabel_W154">Module Guides</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/master/ru/faq"><span title="Frequently Asked Questions" class="linkLabel_WmDU">Frequently Asked Questions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/master/ru/support"><span title="Rspamd Support" class="linkLabel_WmDU">Rspamd Support</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/master/ru/downloads"><span title="Downloads" class="linkLabel_WmDU">Downloads</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/configuration/"><span title="Configuration" class="categoryLinkLabel_W154">Configuration</span></a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/workers/"><span title="Workers" class="categoryLinkLabel_W154">Workers</span></a><button aria-label="Expand sidebar category &#x27;Workers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/modules/"><span title="Modules" class="categoryLinkLabel_W154">Modules</span></a><button aria-label="Expand sidebar category &#x27;Modules&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/lua/"><span title="Lua API" class="categoryLinkLabel_W154">Lua API</span></a><button aria-label="Expand sidebar category &#x27;Lua API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/developers/architecture"><span title="Developers" class="categoryLinkLabel_W154">Developers</span></a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs.rspamd.com/branches/master/ru/administration/rspamadm/"><span title="Administration Tools" class="categoryLinkLabel_W154">Administration Tools</span></a><button aria-label="Expand sidebar category &#x27;Administration Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs.rspamd.com/branches/master/ru/other/gtube_patterns"><span title="Other" class="categoryLinkLabel_W154">Other</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/master/ru/blog"><span title="Blog" class="linkLabel_WmDU">Blog</span></a></li></ul></nav><button type="button" title="Свернуть сайдбар" aria-label="Свернуть сайдбар" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/docs.rspamd.com/branches/master/ru/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">How-To Guides</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Scanning outbound mail</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><header><h1>Scanning outbound mail</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-scan-outbound-mail">Why scan outbound mail<a href="#why-scan-outbound-mail" class="hash-link" aria-label="Прямая ссылка на Why scan outbound mail" title="Прямая ссылка на Why scan outbound mail" translate="no">​</a></h2>
<p>Sending outbound spam can have severe negative consequences on your system&#x27;s email delivery capabilities. It is crucial to prevent the occurrence of spam and its associated issues. In the event of an outbreak of outbound spam, it may become necessary to initiate incident response measures, such as changing the passwords of affected accounts. Conducting human analysis to verify the authenticity of the spam may also be beneficial, but it is essential to consider privacy laws and company policies, as this analysis could potentially infringe upon them. To determine the appropriate actions for dealing with suspected outbound spam, it is advisable to seek advice from legal experts and involve relevant stakeholders. Please be aware that this document does not offer specific guidance on handling such emails, although it may be expanded in the future to include illustrative strategies.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-rspamd-considers-outbound">What Rspamd considers outbound<a href="#what-rspamd-considers-outbound" class="hash-link" aria-label="Прямая ссылка на What Rspamd considers outbound" title="Прямая ссылка на What Rspamd considers outbound" translate="no">​</a></h2>
<p>Rspamd classifies a message as <strong>outbound</strong> (or locally originated) when at least one of the following conditions is true:</p>
<ul>
<li class="">The message was sent by an <strong>authenticated user</strong> (i.e. SMTP AUTH was used and the MTA passed the user identity to Rspamd).</li>
<li class="">The message was received from an IP address listed in <strong><a class="" href="/docs.rspamd.com/branches/master/ru/configuration/options">local_addrs</a></strong> (by default this includes RFC 1918 private ranges and loopback addresses).</li>
</ul>
<p>These two conditions are checked independently by most modules. Some modules only check one of them (e.g. <a class="" href="/docs.rspamd.com/branches/master/ru/modules/ratelimit">Ratelimit</a> only tracks authenticated users, not <code>local_addrs</code>). Each module typically exposes <code>check_local</code> and <code>check_authed</code> options (both default to <code>false</code>) so you can override the default behaviour and force checks even for outbound mail.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-behaviour-for-outbound-mail">Module behaviour for outbound mail<a href="#module-behaviour-for-outbound-mail" class="hash-link" aria-label="Прямая ссылка на Module behaviour for outbound mail" title="Прямая ссылка на Module behaviour for outbound mail" translate="no">​</a></h2>
<p>With proper <a class="" href="/docs.rspamd.com/branches/master/ru/tutorials/integration">integration</a>, Rspamd can identify the authenticated user and source IP of a message. The following modules automatically adjust their behaviour for outbound mail:</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="checks-disabled-for-outbound">Checks disabled for outbound<a href="#checks-disabled-for-outbound" class="hash-link" aria-label="Прямая ссылка на Checks disabled for outbound" title="Прямая ссылка на Checks disabled for outbound" translate="no">​</a></h3>




























































<table><thead><tr><th>Module</th><th>Behaviour</th><th>Override</th></tr></thead><tbody><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/asn">ASN</a></td><td>Disabled for local IPs</td><td>Set <code>check_local = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/dkim">DKIM checking</a></td><td>Verification is disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/dmarc">DMARC</a></td><td>Disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/greylisting">Greylist</a></td><td>Disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/mx_check">MX Check</a></td><td>Disabled</td><td>No override (hardcoded)</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/once_received">One Received header policy</a></td><td>Disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/spf">SPF</a></td><td>Disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/whitelist">Whitelist</a></td><td>Disabled (DKIM/SPF/DMARC whitelisting is not applied)</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/p0f">p0f</a></td><td>Disabled for local IPs (OS fingerprinting is meaningless)</td><td>No override</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/spamtrap">Spamtrap</a></td><td>Disabled</td><td>Set <code>check_local = true</code> or <code>check_authed = true</code></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="checks-with-modified-behaviour-for-outbound">Checks with modified behaviour for outbound<a href="#checks-with-modified-behaviour-for-outbound" class="hash-link" aria-label="Прямая ссылка на Checks with modified behaviour for outbound" title="Прямая ссылка на Checks with modified behaviour for outbound" translate="no">​</a></h3>









































<table><thead><tr><th>Module</th><th>Behaviour</th></tr></thead><tbody><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/dkim_signing">DKIM signing</a></td><td>Signing is <strong>enabled</strong> when the appropriate key and rule are found</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/arc">ARC signing</a></td><td>ARC signing is <strong>enabled</strong> similarly to DKIM signing</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/hfilter">HFilter</a></td><td>Only URL-checks are applied; header and received checks are skipped</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/ratelimit">Ratelimit</a></td><td>Only the <code>user</code> bucket is applied (to authenticated users only; does not use <code>local_addrs</code>)</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/rbl">RBL</a></td><td>Individual RBL rules are disabled according to their <code>exclude_users</code> and <code>exclude_local</code> settings (URL-based lists are typically checked for all directions)</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/replies">Replies</a></td><td>Reply tracking works for outbound messages (stores message IDs from authenticated/local senders) but the forced action is <strong>not</strong> applied to outbound messages</td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/milter_headers">Milter Headers</a></td><td>Headers are <strong>not</strong> added by default for local or authenticated connections (<code>skip_local = true</code>, <code>skip_authenticated = true</code>); you can control which headers are still added via <code>local_headers</code> and <code>authenticated_headers</code></td></tr><tr><td><a class="" href="/docs.rspamd.com/branches/master/ru/modules/reputation">Reputation</a></td><td>Supports separate <code>outbound</code> and <code>inbound</code> selectors per rule, allowing different reputation tracking for each direction</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="modules-unaffected-by-direction">Modules unaffected by direction<a href="#modules-unaffected-by-direction" class="hash-link" aria-label="Прямая ссылка на Modules unaffected by direction" title="Прямая ссылка на Modules unaffected by direction" translate="no">​</a></h3>
<p>Most other modules (e.g. <a class="" href="/docs.rspamd.com/branches/master/ru/modules/antivirus">Antivirus</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/fuzzy_check">Fuzzy check</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/multimap">Multimap</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/neural">Neural</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/phishing">Phishing</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/mime_types">MIME types</a>, <a class="" href="/docs.rspamd.com/branches/master/ru/modules/external_services">External services</a>) run for all messages regardless of direction. You can use the <a class="" href="/docs.rspamd.com/branches/master/ru/configuration/settings">Settings module</a> to selectively enable or disable any of these for outbound mail.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-settings-to-control-outbound-scanning">Using settings to control outbound scanning<a href="#using-settings-to-control-outbound-scanning" class="hash-link" aria-label="Прямая ссылка на Using settings to control outbound scanning" title="Прямая ссылка на Using settings to control outbound scanning" translate="no">​</a></h2>
<p>The <a class="" href="/docs.rspamd.com/branches/master/ru/configuration/settings">settings module</a> provides a powerful way to customise Rspamd behaviour per direction. Settings can match on <code>authenticated</code>, <code>local</code>, <code>user</code>, <code>ip</code>, and other conditions, then apply custom scores, enable/disable specific symbols or groups, and override actions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="separating-inbound-and-outbound-flows">Separating inbound and outbound flows<a href="#separating-inbound-and-outbound-flows" class="hash-link" aria-label="Прямая ссылка на Separating inbound and outbound flows" title="Прямая ссылка на Separating inbound and outbound flows" translate="no">​</a></h3>
<p>The simplest approach is to use <code>authenticated = yes</code> or <code>local = yes</code> matchers:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/settings.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outbound {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  priority = high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authenticated = yes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apply {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    groups_disabled = [&quot;rbl&quot;, &quot;spf&quot;, &quot;dmarc&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actions {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      greylist = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-settings-id-from-mta">Using Settings-ID from MTA<a href="#using-settings-id-from-mta" class="hash-link" aria-label="Прямая ссылка на Using Settings-ID from MTA" title="Прямая ссылка на Using Settings-ID from MTA" translate="no">​</a></h3>
<p>For more precise control, you can pass a <code>Settings-ID</code> header from your MTA to split inbound and outbound flows explicitly. This is the most performant approach since Rspamd can skip condition evaluation entirely:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/settings.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outbound_scan {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id = &quot;outbound&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apply {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    groups_enabled = [&quot;dkim&quot;, &quot;ratelimit&quot;, &quot;fuzzy&quot;, &quot;neural&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actions {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      reject = 15.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;add header&quot; = 6.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Then in your MTA, set the header for outbound submissions:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Postfix example (submission service in master.cf)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-o smtpd_milter_maps=cdb:/etc/postfix/milter_settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Or pass it directly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-o milter_header_checks=pcre:/etc/postfix/milter_header_checks</span><br></span></code></pre></div></div>
<p>Or use <code>rspamc</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rspamc --header=&quot;settings-id=outbound&quot; message.eml</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="rescoring-symbols-for-outbound">Rescoring symbols for outbound<a href="#rescoring-symbols-for-outbound" class="hash-link" aria-label="Прямая ссылка на Rescoring symbols for outbound" title="Прямая ссылка на Rescoring symbols for outbound" translate="no">​</a></h3>
<p>You can adjust symbol weights specifically for outbound mail:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/settings.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outbound_rescoring {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  priority = high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authenticated = yes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apply {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BAYES_SPAM = 8.0;   # Treat Bayes spam more seriously for outbound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NEURAL_SPAM = 6.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actions {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      reject = 12.0;    # Lower reject threshold for outbound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="limiting-checks-for-authenticated-users">Limiting checks for authenticated users<a href="#limiting-checks-for-authenticated-users" class="hash-link" aria-label="Прямая ссылка на Limiting checks for authenticated users" title="Прямая ссылка на Limiting checks for authenticated users" translate="no">​</a></h3>
<p>To run only specific checks for authenticated users (e.g. only fuzzy, neural, and ratelimit):</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/settings.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authenticated_minimal {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  priority = high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authenticated = yes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apply {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    groups_enabled = [&quot;fuzzy&quot;, &quot;neural&quot;, &quot;ratelimit&quot;, &quot;antivirus&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="mta-configuration">MTA configuration<a href="#mta-configuration" class="hash-link" aria-label="Прямая ссылка на MTA configuration" title="Прямая ссылка на MTA configuration" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="mta-with-milter-support-eg-postfix-or-sendmail">MTA with milter support (e.g. Postfix or Sendmail)<a href="#mta-with-milter-support-eg-postfix-or-sendmail" class="hash-link" aria-label="Прямая ссылка на MTA with milter support (e.g. Postfix or Sendmail)" title="Прямая ссылка на MTA with milter support (e.g. Postfix or Sendmail)" translate="no">​</a></h3>
<p>To enable Rspamd to scan emails sent directly via <code>sendmail</code> or other local delivery agents, you can include the <code>non_smtpd_milters</code> setting in the configuration. This will direct the Rspamd proxy worker to perform the scanning. Here is an example configuration for Postfix MTA:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># postfix/main.cf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_milters=inet:127.0.0.1:11332 # For inbound scan or outbound scan via SMTP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">non_smtpd_milters=inet:127.0.0.1:11332 # For invocation via LDA</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exim">Exim<a href="#exim" class="hash-link" aria-label="Прямая ссылка на Exim" title="Прямая ссылка на Exim" translate="no">​</a></h3>
<p>Here is an example configuration suitable for filtering outbound email.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Global options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spamd_address = 127.0.0.1 11333 variant=rspamd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acl_smtp_data = acl_check_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin acl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acl_check_data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Set default value for a variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set acl_m_outspam = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Always scan mail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spam = nobody:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Honor &quot;reject&quot; action for inbound mail...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deny</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ! authenticated = *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    condition = ${if eq{$spam_action}{reject}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    message = Discarded high-probability spam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # If it&#x27;s our user set acl_m_outspam = 1 instead</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  warn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authenticated = *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    condition = ${if eq{$spam_action}{reject}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set acl_m_outspam = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  accept</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Apply special handling to messages with $acl_m_outspam==1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redirect_outbound_spam:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  driver = redirect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  condition = ${if eq{$acl_m_outspam}{1}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = admin@example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &lt;rest of configuration&gt;</span><br></span></code></pre></div></div>
<p>See the <a href="https://www.exim.org/exim-html-current/doc/html/spec_html/" target="_blank" rel="noopener noreferrer" class="">Exim specification</a> for more information.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="haraka">Haraka<a href="#haraka" class="hash-link" aria-label="Прямая ссылка на Haraka" title="Прямая ссылка на Haraka" translate="no">​</a></h3>
<p>To enable scanning of outbound mail set the following in <code>config/rspamd.ini</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[check]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authenticated=true</span><br></span></code></pre></div></div>
<p>If you wish to honor <code>reject</code> action for authenticated users set the following:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[reject]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authenticated=true</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/rspamd/docs.rspamd.com/edit/master/docs/tutorials/scanning_outbound.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Отредактировать эту страницу</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs.rspamd.com/branches/master/ru/tutorials/migrate_sa"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Migrating from SpamAssassin</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs.rspamd.com/branches/master/ru/tutorials/fuzzy_storage"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Usage of fuzzy hashes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-scan-outbound-mail" class="table-of-contents__link toc-highlight">Why scan outbound mail</a></li><li><a href="#what-rspamd-considers-outbound" class="table-of-contents__link toc-highlight">What Rspamd considers outbound</a></li><li><a href="#module-behaviour-for-outbound-mail" class="table-of-contents__link toc-highlight">Module behaviour for outbound mail</a><ul><li><a href="#checks-disabled-for-outbound" class="table-of-contents__link toc-highlight">Checks disabled for outbound</a></li><li><a href="#checks-with-modified-behaviour-for-outbound" class="table-of-contents__link toc-highlight">Checks with modified behaviour for outbound</a></li><li><a href="#modules-unaffected-by-direction" class="table-of-contents__link toc-highlight">Modules unaffected by direction</a></li></ul></li><li><a href="#using-settings-to-control-outbound-scanning" class="table-of-contents__link toc-highlight">Using settings to control outbound scanning</a><ul><li><a href="#separating-inbound-and-outbound-flows" class="table-of-contents__link toc-highlight">Separating inbound and outbound flows</a></li><li><a href="#using-settings-id-from-mta" class="table-of-contents__link toc-highlight">Using Settings-ID from MTA</a></li><li><a href="#rescoring-symbols-for-outbound" class="table-of-contents__link toc-highlight">Rescoring symbols for outbound</a></li><li><a href="#limiting-checks-for-authenticated-users" class="table-of-contents__link toc-highlight">Limiting checks for authenticated users</a></li></ul></li><li><a href="#mta-configuration" class="table-of-contents__link toc-highlight">MTA configuration</a><ul><li><a href="#mta-with-milter-support-eg-postfix-or-sendmail" class="table-of-contents__link toc-highlight">MTA with milter support (e.g. Postfix or Sendmail)</a></li><li><a href="#exim" class="table-of-contents__link toc-highlight">Exim</a></li><li><a href="#haraka" class="table-of-contents__link toc-highlight">Haraka</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/tutorials/quickstart">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/configuration">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/modules">Modules</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/tutorials">Tutorials</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/downloads">Downloads</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/changelog">Changelog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/tutorials/site_contributing">Contributing</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Subscribe</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/rss/changelog.xml">Changelog RSS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/blog/rss.xml">Blog RSS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/master/ru/blog/atom.xml">Blog Atom</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Rspamd Project. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>