"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[7442],{6662:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"tutorials/quickstart","title":"Quick start","description":"Rspamd is a powerful, fast and free spam filtering system that uses multiple analysis techniques to identify spam. This guide will help you understand, install, and configure Rspamd step by step.","source":"@site/docs/tutorials/quickstart.md","sourceDirName":"tutorials","slug":"/tutorials/quickstart","permalink":"/docs.rspamd.com/branches/master/ru/tutorials/quickstart","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/tutorials/quickstart.md","tags":[],"version":"current","frontMatter":{"title":"Quick start"},"sidebar":"docs","previous":{"title":"Tutorials and Guides","permalink":"/docs.rspamd.com/branches/master/ru/tutorials/"},"next":{"title":"Upgrading","permalink":"/docs.rspamd.com/branches/master/ru/tutorials/migration"}}');var r=n(4848),t=n(8453);const l={title:"Quick start"},a="Rspamd quick start",d={},o=[{value:"What you&#39;ll learn",id:"what-youll-learn",level:2},{value:"What is Rspamd?",id:"what-is-rspamd",level:2},{value:"Understanding Rspamd Configuration",id:"understanding-rspamd-configuration",level:2},{value:"1. <strong>Modules</strong> - What tests to perform",id:"1-modules---what-tests-to-perform",level:3},{value:"2. <strong>Scores/Weights</strong> - How much each test contributes",id:"2-scoresweights---how-much-each-test-contributes",level:3},{value:"3. <strong>Actions</strong> - What to do at different score thresholds",id:"3-actions---what-to-do-at-different-score-thresholds",level:3},{value:"4. <strong>Workers</strong> - How Rspamd processes operate",id:"4-workers---how-rspamd-processes-operate",level:3},{value:"5. <strong>General options</strong> - Timeouts, DNS settings, etc.",id:"5-general-options---timeouts-dns-settings-etc",level:3},{value:"Installation Overview",id:"installation-overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Install Rspamd",id:"step-1-install-rspamd",level:2},{value:"Installing from packages (Recommended)",id:"installing-from-packages-recommended",level:3},{value:"Start and enable Rspamd",id:"start-and-enable-rspamd",level:3},{value:"Step 2: Basic Rspamd Configuration",id:"step-2-basic-rspamd-configuration",level:2},{value:"Understanding Rspamd&#39;s configuration structure",id:"understanding-rspamds-configuration-structure",level:3},{value:"Set up basic actions and scores",id:"set-up-basic-actions-and-scores",level:3},{value:"Configure Redis (Essential)",id:"configure-redis-essential",level:3},{value:"Set the controller password",id:"set-the-controller-password",level:3},{value:"Restart Rspamd",id:"restart-rspamd",level:3},{value:"Step 3: Install and Configure Redis",id:"step-3-install-and-configure-redis",level:2},{value:"Step 4: Connect to Your Mail Server",id:"step-4-connect-to-your-mail-server",level:2},{value:"Step 5: Test Your Setup",id:"step-5-test-your-setup",level:2},{value:"Test message scanning",id:"test-message-scanning",level:3},{value:"Access the Web Interface",id:"access-the-web-interface",level:3},{value:"Step 6: Configure Bayesian Learning",id:"step-6-configure-bayesian-learning",level:2},{value:"Common Configuration Tasks",id:"common-configuration-tasks",level:2},{value:"Adjusting Spam Score Thresholds",id:"adjusting-spam-score-thresholds",level:3},{value:"Customizing Individual Symbol Scores",id:"customizing-individual-symbol-scores",level:3},{value:"Whitelisting Trusted Senders",id:"whitelisting-trusted-senders",level:3},{value:"Using the Configuration Wizard",id:"using-the-configuration-wizard",level:3},{value:"Using Rspamd",id:"using-rspamd",level:2},{value:"Command Line Tools",id:"command-line-tools",level:3},{value:"Automatic Learning with Email Clients",id:"automatic-learning-with-email-clients",level:3},{value:"Understanding Rspamd&#39;s Configuration System",id:"understanding-rspamds-configuration-system",level:2},{value:"Configuration Directories",id:"configuration-directories",level:3},{value:"How Scoring Works",id:"how-scoring-works",level:3},{value:"Common Symbol Groups",id:"common-symbol-groups",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Important Log Files",id:"important-log-files",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Immediate Improvements",id:"immediate-improvements",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Advanced Topics",id:"advanced-topics",level:2},{value:"Multiple Mail Server Integration",id:"multiple-mail-server-integration",level:3},{value:"Large-Scale Deployments",id:"large-scale-deployments",level:3},{value:"Security Considerations",id:"security-considerations",level:3},{value:"Additional Resources",id:"additional-resources",level:2},{value:"Official Documentation",id:"official-documentation",level:3},{value:"Community Resources",id:"community-resources",level:3},{value:"Tools and Add-ons",id:"tools-and-add-ons",level:3}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"rspamd-quick-start",children:"Rspamd quick start"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Rspamd"})," is a powerful, fast and free spam filtering system that uses multiple analysis techniques to identify spam. This guide will help you understand, install, and configure Rspamd step by step."]}),"\n",(0,r.jsx)(s.h2,{id:"what-youll-learn",children:"What you'll learn"}),"\n",(0,r.jsx)(s.p,{children:"By the end of this guide, you'll understand:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"What"})," Rspamd can do and what you can configure"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"How"})," to install and set up Rspamd with your mail server"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"How"})," to configure basic settings like spam scores and actions"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"How"})," to use Rspamd's web interface and command-line tools"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"what-is-rspamd",children:"What is Rspamd?"}),"\n",(0,r.jsx)(s.p,{children:"Rspamd is a spam filtering daemon that integrates with your mail server (MTA) to analyze incoming and outgoing emails. It uses various techniques including:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Bayesian classification (machine learning)"}),"\n",(0,r.jsx)(s.li,{children:"DNS blacklists (RBLs)"}),"\n",(0,r.jsx)(s.li,{children:"Fuzzy hashing"}),"\n",(0,r.jsx)(s.li,{children:"Regular expressions"}),"\n",(0,r.jsx)(s.li,{children:"SPF, DKIM, and DMARC validation"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"understanding-rspamd-configuration",children:"Understanding Rspamd Configuration"}),"\n",(0,r.jsxs)(s.p,{children:["Before diving into installation, it's important to understand what you can configure in Rspamd. Based on the excellent ",(0,r.jsx)(s.a,{href:"https://www.0xf8.org/2018/05/an-alternative-introduction-to-rspamd-configuration-introduction/",children:"alternative introduction guide"}),", here's what Rspamd allows you to configure:"]}),"\n",(0,r.jsxs)(s.h3,{id:"1-modules---what-tests-to-perform",children:["1. ",(0,r.jsx)(s.strong,{children:"Modules"})," - What tests to perform"]}),"\n",(0,r.jsxs)(s.p,{children:["Modules are units of code that analyze messages. Each test produces a ",(0,r.jsx)(s.strong,{children:"symbol"})," (like ",(0,r.jsx)(s.code,{children:"FORGED_SENDER"}),") if the test matches."]}),"\n",(0,r.jsxs)(s.h3,{id:"2-scoresweights---how-much-each-test-contributes",children:["2. ",(0,r.jsx)(s.strong,{children:"Scores/Weights"})," - How much each test contributes"]}),"\n",(0,r.jsxs)(s.p,{children:['Each symbol has a numeric score that adds to the message\'s total "spam score" (e.g., ',(0,r.jsx)(s.code,{children:"FORGED_SENDER = 0.30"}),")."]}),"\n",(0,r.jsxs)(s.h3,{id:"3-actions---what-to-do-at-different-score-thresholds",children:["3. ",(0,r.jsx)(s.strong,{children:"Actions"})," - What to do at different score thresholds"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Greylist"})," (score 4.0): Temporarily delay the message"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Add header"})," (score 6.0): Mark as spam but deliver"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Reject"})," (score 15.0): Refuse the message entirely"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"4-workers---how-rspamd-processes-operate",children:["4. ",(0,r.jsx)(s.strong,{children:"Workers"})," - How Rspamd processes operate"]}),"\n",(0,r.jsx)(s.p,{children:"Different worker processes handle scanning, web interface, and proxy functions."}),"\n",(0,r.jsxs)(s.h3,{id:"5-general-options---timeouts-dns-settings-etc",children:["5. ",(0,r.jsx)(s.strong,{children:"General options"})," - Timeouts, DNS settings, etc."]}),"\n",(0,r.jsx)(s.h2,{id:"installation-overview",children:"Installation Overview"}),"\n",(0,r.jsx)(s.p,{children:"This guide covers setting up Rspamd with:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Ubuntu"})," (or any systemd-based OS)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Postfix"})," as the mail server"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Redis"})," for caching and statistics"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Dovecot"})," for IMAP with automatic spam learning"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(s.p,{children:"Before installing Rspamd, ensure you have:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"A working mail server (MTA)"})," - This guide uses ",(0,r.jsx)(s.a,{href:"https://www.postfix.org/",children:"Postfix"}),", but Rspamd works with other MTAs too (see ",(0,r.jsx)(s.a,{href:"/tutorials/integration",children:"integration document"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Root access"})," to your server"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"A domain"})," configured for email"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Basic familiarity"})," with Linux command line"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Note"}),": While Rspamd can work with Exim, it has limited support and is not recommended."]}),"\n",(0,r.jsxs)(s.p,{children:["Consider setting up your own ",(0,r.jsx)(s.a,{href:"/faq#resolver-setup",children:"local DNS resolver"})," for better performance."]}),"\n",(0,r.jsx)(s.h2,{id:"step-1-install-rspamd",children:"Step 1: Install Rspamd"}),"\n",(0,r.jsx)(s.h3,{id:"installing-from-packages-recommended",children:"Installing from packages (Recommended)"}),"\n",(0,r.jsxs)(s.p,{children:["Instructions for downloading Rspamd can be found on the ",(0,r.jsx)(s.a,{href:"/downloads",children:"downloads page"}),". This includes information for various Linux distributions and installation methods."]}),"\n",(0,r.jsx)(s.p,{children:"For Ubuntu/Debian:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Add Rspamd repository\ncurl https://rspamd.com/apt-stable/gpg.key | sudo apt-key add -\necho "deb https://rspamd.com/apt-stable/ $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/rspamd.list\n\n# Update and install\nsudo apt update\nsudo apt install rspamd\n'})}),"\n",(0,r.jsx)(s.h3,{id:"start-and-enable-rspamd",children:"Start and enable Rspamd"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo systemctl start rspamd\nsudo systemctl enable rspamd\nsudo systemctl status rspamd\n"})}),"\n",(0,r.jsx)(s.h2,{id:"step-2-basic-rspamd-configuration",children:"Step 2: Basic Rspamd Configuration"}),"\n",(0,r.jsx)(s.h3,{id:"understanding-rspamds-configuration-structure",children:"Understanding Rspamd's configuration structure"}),"\n",(0,r.jsx)(s.p,{children:"Rspamd uses a modular configuration system with three main ways to customize settings:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"local.d/"})})," - For adding/merging settings with defaults"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"override.d/"})})," - For completely replacing default settings"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Web interface"})," - For runtime adjustments"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Important"}),": Never edit files in ",(0,r.jsx)(s.code,{children:"/etc/rspamd/"})," directly. Always use ",(0,r.jsx)(s.code,{children:"local.d/"})," or ",(0,r.jsx)(s.code,{children:"override.d/"})," directories."]}),"\n",(0,r.jsx)(s.h3,{id:"set-up-basic-actions-and-scores",children:"Set up basic actions and scores"}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/actions.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:"# Basic action thresholds\nreject = 15;        # Reject obvious spam\nadd_header = 6;     # Add spam headers\ngreylist = 4;       # Temporary delay suspicious mail\n"})}),"\n",(0,r.jsx)(s.h3,{id:"configure-redis-essential",children:"Configure Redis (Essential)"}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/redis.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'# Redis connection for statistics and caching\nservers = "127.0.0.1:6379";\n'})}),"\n",(0,r.jsx)(s.h3,{id:"set-the-controller-password",children:"Set the controller password"}),"\n",(0,r.jsx)(s.p,{children:"Generate a password for the web interface:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"rspamadm pw\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-controller.inc"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'# Replace with your generated password\npassword = "$2$your_generated_password_here";\n'})}),"\n",(0,r.jsx)(s.h3,{id:"restart-rspamd",children:"Restart Rspamd"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart rspamd\n"})}),"\n",(0,r.jsx)(s.h2,{id:"step-3-install-and-configure-redis",children:"Step 3: Install and Configure Redis"}),"\n",(0,r.jsx)(s.p,{children:"Rspamd requires Redis for statistics and caching:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo apt install redis-server\nsudo systemctl start redis-server\nsudo systemctl enable redis-server\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Basic Redis security in ",(0,r.jsx)(s.code,{children:"/etc/redis/redis.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"# Bind only to localhost for security\nbind 127.0.0.1 ::1\n\n# Set memory limit\nmaxmemory 500mb\nmaxmemory-policy volatile-ttl\n"})}),"\n",(0,r.jsx)(s.p,{children:"Restart Redis:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart redis-server\n"})}),"\n",(0,r.jsx)(s.h2,{id:"step-4-connect-to-your-mail-server",children:"Step 4: Connect to Your Mail Server"}),"\n",(0,r.jsxs)(s.p,{children:["Add milter integration to your Postfix configuration in ",(0,r.jsx)(s.code,{children:"/etc/postfix/main.cf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"# Enable Rspamd milter\nsmtpd_milters = inet:localhost:11332\nmilter_default_action = accept\nmilter_protocol = 6\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Configure Rspamd proxy worker in ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-proxy.inc"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'# Enable milter mode for Postfix integration\nmilter = yes;\ntimeout = 120s;\nupstream "local" {\n  default = yes;\n  self_scan = yes;  # Scan messages directly\n}\n'})}),"\n",(0,r.jsx)(s.p,{children:"Restart both services:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart rspamd\nsudo systemctl restart postfix\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Note"}),": For complete Postfix/Dovecot setup details, TLS configuration, and other mail server settings, see the ",(0,r.jsx)(s.a,{href:"/tutorials/integration",children:"MTA Integration Guide"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"step-5-test-your-setup",children:"Step 5: Test Your Setup"}),"\n",(0,r.jsx)(s.h3,{id:"test-message-scanning",children:"Test message scanning"}),"\n",(0,r.jsx)(s.p,{children:"Test that Rspamd is working properly:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Check Rspamd is running\nsudo systemctl status rspamd\n\n# Test scanning a message\necho "Test message" | rspamc\n\n# Check logs for activity\nsudo tail -f /var/log/rspamd/rspamd.log\n'})}),"\n",(0,r.jsx)(s.h3,{id:"access-the-web-interface",children:"Access the Web Interface"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Open your browser to ",(0,r.jsx)(s.code,{children:"http://your-server:11334"})]}),"\n",(0,r.jsx)(s.li,{children:"Enter the password you configured earlier"}),"\n",(0,r.jsx)(s.li,{children:"You should see the Rspamd dashboard with statistics and configuration options"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"step-6-configure-bayesian-learning",children:"Step 6: Configure Bayesian Learning"}),"\n",(0,r.jsx)(s.p,{children:"Set up automatic learning to improve spam detection over time:"}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/classifier-bayes.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'# Configure Bayes classifier to use Redis\nservers = "127.0.0.1:6379";\nbackend = "redis";\n\n# Auto-learning thresholds  \nautolearn = true;\nmin_learns = 200;        # Minimum learned messages before classification\n'})}),"\n",(0,r.jsx)(s.h2,{id:"common-configuration-tasks",children:"Common Configuration Tasks"}),"\n",(0,r.jsx)(s.h3,{id:"adjusting-spam-score-thresholds",children:"Adjusting Spam Score Thresholds"}),"\n",(0,r.jsxs)(s.p,{children:["Edit ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/actions.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:"# Lower thresholds for stricter filtering\nreject = 12;     # Was 15 - reject obvious spam\nadd_header = 5;  # Was 6 - add spam headers\ngreylist = 3;    # Was 4 - temporary delay suspicious mail\n"})}),"\n",(0,r.jsx)(s.h3,{id:"customizing-individual-symbol-scores",children:"Customizing Individual Symbol Scores"}),"\n",(0,r.jsxs)(s.p,{children:["Edit ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/groups.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'symbols = {\n  "BAYES_SPAM" = {\n    score = 5.5;  # Increase Bayes spam weight\n  }\n  "SPF_FAIL" = {\n    score = 2.0;  # Reduce SPF failure penalty\n  }\n}\n'})}),"\n",(0,r.jsx)(s.h3,{id:"whitelisting-trusted-senders",children:"Whitelisting Trusted Senders"}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/multimap.conf"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-hcl",children:'WHITELIST_SENDER_DOMAIN {\n  type = "from";\n  map = "/etc/rspamd/whitelist_domains.map";\n  score = -10.0;\n  description = "Trusted sender domains";\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Create ",(0,r.jsx)(s.code,{children:"/etc/rspamd/whitelist_domains.map"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"example.com\ntrusted-partner.org\n"})}),"\n",(0,r.jsx)(s.h3,{id:"using-the-configuration-wizard",children:"Using the Configuration Wizard"}),"\n",(0,r.jsx)(s.p,{children:"Rspamd includes a helpful configuration wizard:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo rspamadm configwizard\n"})}),"\n",(0,r.jsx)(s.p,{children:"This interactive tool helps configure:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Redis server connection"}),"\n",(0,r.jsx)(s.li,{children:"Controller password"}),"\n",(0,r.jsx)(s.li,{children:"DKIM signing"}),"\n",(0,r.jsx)(s.li,{children:"Basic settings"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"using-rspamd",children:"Using Rspamd"}),"\n",(0,r.jsx)(s.h3,{id:"command-line-tools",children:"Command Line Tools"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"rspamc"})," - The main client for interacting with Rspamd:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Scan a message file\nrspamc message.eml\n\n# Train Bayesian classifier\nrspamc learn_spam spam_message.eml\nrspamc learn_ham good_message.eml\n\n# Check Rspamd statistics\nrspamc stat\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"rspamadm"})," - Administrative utilities:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Test configuration\nsudo rspamadm configtest\n\n# View configuration help\nrspamadm confighelp -k classifier\n\n# Generate DKIM keys\nrspamadm dkim_keygen -s mail -d example.com\n"})}),"\n",(0,r.jsx)(s.h3,{id:"automatic-learning-with-email-clients",children:"Automatic Learning with Email Clients"}),"\n",(0,r.jsxs)(s.p,{children:['Set up automatic spam learning by configuring your email client to move spam to a "Junk" folder. Create a Dovecot Sieve script (',(0,r.jsx)(s.code,{children:"~/.dovecot.sieve"}),"):"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sieve",children:'require ["fileinto"];\n\nif header :is "X-Spam" "Yes" {\n    fileinto "Junk";\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"understanding-rspamds-configuration-system",children:"Understanding Rspamd's Configuration System"}),"\n",(0,r.jsxs)(s.p,{children:["Rspamd uses a hierarchical configuration system based on the ",(0,r.jsx)(s.a,{href:"https://www.0xf8.org/2018/05/an-alternative-introduction-to-rspamd-configuration-introduction/",children:"excellent explanation"})," from the alternative guide:"]}),"\n",(0,r.jsx)(s.h3,{id:"configuration-directories",children:"Configuration Directories"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/rspamd/"})})," - Main configuration (DO NOT edit directly)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/rspamd/local.d/"})})," - Your custom settings (merged with defaults)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/rspamd/override.d/"})})," - Complete replacements of default settings"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Important"}),": Always use ",(0,r.jsx)(s.code,{children:"local.d/"})," or ",(0,r.jsx)(s.code,{children:"override.d/"})," for customizations, never edit the main config files directly."]}),"\n",(0,r.jsx)(s.h3,{id:"how-scoring-works",children:"How Scoring Works"}),"\n",(0,r.jsx)(s.p,{children:"Rspamd calculates a spam score by adding up weights from various tests (symbols). The final score determines the action:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Total Score = Symbol1_weight + Symbol2_weight + Symbol3_weight + ...\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Score Components"}),": Each symbol has two parts:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Static weight"})," (configured value, e.g., 3.0)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Runtime confidence"})," (dynamic value, e.g., 0.5)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Final contribution"})," = static \xd7 runtime (e.g., 3.0 \xd7 0.5 = 1.5)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"common-symbol-groups",children:"Common Symbol Groups"}),"\n",(0,r.jsx)(s.p,{children:"Symbols are organized into logical groups you can adjust:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"policies_group.conf"})})," - SPF, DKIM, DMARC validation"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"rbl_group.conf"})})," - DNS blacklist results"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"statistics_group.conf"})})," - Bayesian classifier scores"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"headers_group.conf"})})," - Email header analysis"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phishing_group.conf"})})," - URL and content analysis"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Learn more about ",(0,r.jsx)(s.a,{href:"/faq#what-are-rspamd-actions",children:"actions and scores"})," in the documentation."]}),"\n",(0,r.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(s.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Rspamd not starting:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Check status and logs\nsudo systemctl status rspamd\nsudo journalctl -u rspamd -f\n\n# Test configuration\nsudo rspamadm configtest\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Web interface not accessible:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Check firewall settings"}),"\n",(0,r.jsx)(s.li,{children:"Verify controller password is set"}),"\n",(0,r.jsx)(s.li,{children:"Ensure port 11334 is accessible"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Mail not being scanned:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Check Postfix milter configuration"}),"\n",(0,r.jsx)(s.li,{children:"Verify Rspamd proxy is running on port 11332"}),"\n",(0,r.jsxs)(s.li,{children:["Check mail logs: ",(0,r.jsx)(s.code,{children:"sudo tail -f /var/log/mail.log"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Low accuracy spam detection:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Train Bayesian classifier with more examples"}),"\n",(0,r.jsx)(s.li,{children:"Check and adjust symbol scores"}),"\n",(0,r.jsx)(s.li,{children:"Monitor learning progress in web interface"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"important-log-files",children:"Important Log Files"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Rspamd"}),": ",(0,r.jsx)(s.code,{children:"/var/log/rspamd/rspamd.log"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Mail system"}),": ",(0,r.jsx)(s.code,{children:"/var/log/mail.log"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Redis"}),": ",(0,r.jsx)(s.code,{children:"/var/log/redis/redis-server.log"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsx)(s.h3,{id:"immediate-improvements",children:"Immediate Improvements"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Set up automatic learning"})," with Dovecot Sieve"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Monitor and tune scores"})," based on your mail patterns"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configure DKIM signing"})," for outbound mail"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Set up proper TLS"})," certificates"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configure multiple Redis instances"})," for better performance"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Enable neural networks"})," for improved accuracy"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Set up rate limiting"})," to prevent spam waves"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Consider IP reputation"})," modules"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"advanced-topics",children:"Advanced Topics"}),"\n",(0,r.jsx)(s.p,{children:"For experienced users who want to dive deeper:"}),"\n",(0,r.jsx)(s.h3,{id:"multiple-mail-server-integration",children:"Multiple Mail Server Integration"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/tutorials/integration",children:"MTA Integration Guide"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/workers/rspamd_proxy",children:"Milter Protocol Configuration"})}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"large-scale-deployments",children:"Large-Scale Deployments"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/tutorials/redis_replication",children:"Redis Replication"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/modules/neural",children:"Neural Networks Setup"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"./clickhouse_analytics",children:"Clickhouse Analytics"})}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/modules/rbl",children:"RBL Usage Policies"})," - Important licensing information"]}),"\n",(0,r.jsx)(s.li,{children:"Network security and firewall configuration"}),"\n",(0,r.jsxs)(s.li,{children:["TLS setup with ",(0,r.jsx)(s.a,{href:"https://letsencrypt.org",children:"Let's Encrypt"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,r.jsx)(s.h3,{id:"official-documentation",children:"Official Documentation"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/configuration/",children:"Complete Configuration Reference"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/modules/",children:"Module Documentation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/webui",children:"WebUI Guide"})}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"community-resources",children:"Community Resources"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://www.0xf8.org/2018/05/an-alternative-introduction-to-rspamd-configuration-introduction/",children:"An alternative introduction to rspamd configuration"})," - Detailed configuration guide"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://thomas-leister.de/en/mailserver-debian-stretch/",children:"Own mail server tutorial"})," - Complete mail server setup"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://web.archive.org/web/20240914211825/www.c0ffee.net/blog/mail-server-guide",children:"FreeBSD setup guide"})," - Alternative platform guide"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"tools-and-add-ons",children:"Tools and Add-ons"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://addons.thunderbird.net/thunderbird/addon/rspamd-spamness/",children:"Thunderbird Rspamd Add-on"})," - Visualize spam scores"]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/moisseev/rspamd-spamness/",children:"Rspamd Stats Visualization"})}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Congratulations!"})," You now have a working Rspamd installation. Start with the basic configuration and gradually explore advanced features as your needs grow."]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>a});var i=n(6540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);