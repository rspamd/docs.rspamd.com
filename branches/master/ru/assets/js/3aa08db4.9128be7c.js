"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[6030],{4588:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"modules/index","title":"Modules documentation","description":"Rspamd ships with a set of modules. Some modules are written in C to speed up","source":"@site/docs/modules/index.md","sourceDirName":"modules","slug":"/modules/","permalink":"/docs.rspamd.com/branches/master/ru/modules/","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/index.md","tags":[],"version":"current","frontMatter":{"title":"Modules documentation"},"sidebar":"docs","previous":{"title":"Fuzzy storage worker","permalink":"/docs.rspamd.com/branches/master/ru/workers/fuzzy_storage"},"next":{"title":"Antivirus module","permalink":"/docs.rspamd.com/branches/master/ru/modules/antivirus"}}');var n=i(4848),l=i(8453);const a={title:"Modules documentation"},d="Rspamd modules",o={},t=[{value:"C Modules",id:"c-modules",level:2},{value:"Lua modules",id:"lua-modules",level:2},{value:"Disabling module",id:"disabling-module",level:2}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"rspamd-modules",children:"Rspamd modules"})}),"\n",(0,n.jsx)(s.p,{children:"Rspamd ships with a set of modules. Some modules are written in C to speed up\ncomplex procedures, while others are written in Lua to reduce code size.\nWe encourage you to write new modules in Lua and add the essential\nsupport to the Lua API itself. Lua modules are very close to\nC modules in terms of performance. Lua modules, however, can be written and loaded\ndynamically."}),"\n",(0,n.jsx)(s.h2,{id:"c-modules",children:"C Modules"}),"\n",(0,n.jsxs)(s.p,{children:["C modules provide the core functionality of Rspamd and are statically linked to the\nmain Rspamd code. C modules are defined in options.inc with the ",(0,n.jsx)(s.code,{children:"filters"})," attribute.\nThe default configuration enables all C modules explicitly:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-hcl",children:'filters = "chartable,dkim,regexp,fuzzy_check";\n'})}),"\n",(0,n.jsxs)(s.p,{children:["If no ",(0,n.jsx)(s.code,{children:"filters"})," attribute is defined, all C modules are disabled. To understand how to\noverride defaults, see the FAQ ",(0,n.jsx)(s.a,{href:"/faq#what-are-local-and-override-config-files",children:"here"}),"\nand ",(0,n.jsx)(s.a,{href:"/faq#what-are-the-locald-and-overrided-directories",children:"here"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"Available C modules:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/chartable",children:"chartable"}),': checks character sets of text parts in messages. (Note:\n"char" as in character, and "table" as in a table of character sets.)']}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/dkim",children:"dkim"}),": performs DKIM signatures checks."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/fuzzy_check",children:"fuzzy_check"}),": checks a message's fuzzy hashes against public blacklists."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/regexp",children:"regexp"}),": a core module that deals with regular expressions, internal\nfunctions and Lua code to filter messages."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"In prior releases other C modules were enabled by default:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/spf",children:"spf"}),": checks SPF records for messages processed. This C module was removed in\nversion 2.3 and replaced by an equivalent Lua module."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/surbl",children:"surbl"}),": extracts URLs from messages and check them against\npublic DNS black-lists to filter messages containing malicious URLs. This module was removed\nin version 2.0 and replaced by the ",(0,n.jsx)(s.a,{href:"/modules/rbl",children:"rbl module"}),". In an upgrade to v2, the existing\nconfiguration is automatically converted."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"lua-modules",children:"Lua modules"}),"\n",(0,n.jsxs)(s.p,{children:["Lua modules are dynamically loaded on Rspamd startup and are reloaded on Rspamd\nreconfiguration. Should you want to write a Lua module, consult the\n",(0,n.jsx)(s.a,{href:"/lua/",children:"Lua API documentation"}),". To define a path to Lua modules there is a section\nnamed ",(0,n.jsx)(s.code,{children:"modules"})," in common.conf:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-hcl",children:'modules {\n  path = "${PLUGINSDIR}";\n  fallback_path = "${SHAREDIR}/lua"; # Legacy path\n  try_path = "${LOCAL_CONFDIR}/plugins.d/"; # User plugins\n}\n'})}),"\n",(0,n.jsxs)(s.p,{children:["If a path is a directory then Rspamd scans it for ",(0,n.jsx)(s.code,{children:"*.lua"})," pattern and load all\nfiles matched."]}),"\n",(0,n.jsx)(s.p,{children:"The following Lua modules are enabled in the default configuration (but may require additional configuration to work, see notes below):"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/antivirus",children:"antivirus"})," - integrates virus scanners (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/arc",children:"arc"})," - checks and signs ARC signatures"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/asn",children:"asn"})," - looks up ASN-related information"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/clickhouse",children:"clickhouse"})," - pushes scan-related information to clickhouse DBMS (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/bayes_expiry",children:"bayes_expiry"})," - provides expiration of statistical tokens (requires Redis and configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/dcc",children:"dcc"})," - performs ",(0,n.jsx)(s.a,{href:"https://www.dcc-servers.net/dcc/",children:"DCC"})," lookups to determine message bulkiness (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/dkim_signing",children:"dkim_signing"})," - adds DKIM signatures to messages (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/dmarc",children:"dmarc"})," - performs DMARC policy checks (requires Redis & configuration for reporting)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/elastic",children:"elastic"})," - pushes scan-related information to Elasticsearch. (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/emails",children:"emails"})," - extract emails from a message and checks it against DNS blacklists. (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/force_actions",children:"force_actions"})," - forces actions if selected symbols are detected (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/greylisting",children:"greylisting"})," - allows to delay suspicious messages (requires Redis)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/history_redis",children:"history redis"})," - stores history in Redis (requires Redis)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/ip_score",children:"ip_score"})," - dynamically scores sender reputation (requires Redis). This module is removed since Rspamd 2.0 and replaced by ",(0,n.jsx)(s.a,{href:"/modules/reputation",children:"reputation module"}),". The existing configuration is automatically converted by Rspamd."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/maillist",children:"maillist"})," - determines the common mailing list signatures in a message."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/metadata_exporter",children:"metadata_exporter"})," - pushes message metadata to external systems (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/metric_exporter",children:"metric_exporter"})," - pushes statistics to external monitoring systems (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/mid",children:"mid"})," - selectively suppresses invalid/missing message-id rules"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/milter_headers",children:"milter_headers"})," - adds/removes headers from messages (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/mime_types",children:"mime_types"})," - applies some rules about mime types met in messages"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/multimap",children:"multimap"})," - a complex module that operates with different types of maps."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/neural",children:"neural networks"})," - allows to post-process messages using neural network classification. (requires Redis)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/once_received",children:"once_received"})," - detects messages with a single ",(0,n.jsx)(s.code,{children:"Received"})," headers and performs some additional checks for such messages."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/phishing",children:"phishing"})," - detects messages with phished URLs."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/ratelimit",children:"ratelimit"})," - implements leaked bucket algorithm for ratelimiting (requires Redis & configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/replies",children:"replies"})," - checks if an incoming message is a reply for our own message (requires Redis)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/rbl",children:"rbl"})," - a plugin that checks messages against DNS runtime blacklists."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/reputation",children:"reputation"})," - a plugin that manages reputation evaluation based on various rules."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/rspamd_update",children:"rspamd_update"})," - load dynamic rules and other Rspamd updates (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/spamassassin",children:"spamassassin"})," - load spamassassin rules (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/spf",children:"spf"})," - perform SPF checks"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/trie",children:"trie"})," - uses suffix trie for extra-fast patterns lookup in messages. (requires configuration)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/whitelist",children:"whitelist"})," - provides a flexible way to whitelist (or blacklist) messages based on SPF/DKIM/DMARC combinations"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/url_redirector",children:"url_redirector"})," - dereferences redirects (requires Redis configuration)"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["The following modules are explicitly disabled in the default configuration, set ",(0,n.jsx)(s.code,{children:"enabled = true"})," in ",(0,n.jsx)(s.code,{children:"local.d/${MODULE_NAME}.conf"})," to enable them:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/modules/mx_check",children:"mx_check"})," - checks if sending domain has a connectable MX (requires Redis)"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["The following modules are explicitly disabled and are experimental, so you need to set ",(0,n.jsx)(s.code,{children:"enabled = true"})," in ",(0,n.jsx)(s.code,{children:"local.d/${MODULE_NAME}.conf"})," ",(0,n.jsx)(s.strong,{children:"AND"})," to set the global option ",(0,n.jsx)(s.code,{children:"enable_experimental = true"})," in ",(0,n.jsx)(s.code,{children:"local.d/options.inc"}),":"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"url_reputation - assigns reputation to domains in URLs (requires Redis). Removed in Rspamd 2.0."}),"\n",(0,n.jsx)(s.li,{children:"url_tags - persists URL tags in Redis (requires Redis). Removed in Rspamd 2.0."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Experimental modules are not recommended for production usage!"}),"\n",(0,n.jsx)(s.h2,{id:"disabling-module",children:"Disabling module"}),"\n",(0,n.jsxs)(s.p,{children:["To disable an entire module you can set ",(0,n.jsx)(s.code,{children:"enabled = false;"})," in ",(0,n.jsx)(s.code,{children:"/etc/rspamd/local.d/${MODULE_NAME}.conf"})]})]})}function u(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>a,x:()=>d});var r=i(6540);const n={},l=r.createContext(n);function a(e){const s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);