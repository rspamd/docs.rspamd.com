"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[661],{28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var r=n(96540);const i={},a=r.createContext(i);function l(e){const s=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(a.Provider,{value:s},e.children)}},40434:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"getting-started/first-setup","title":"First Setup","description":"This guide covers basic Rspamd configuration for spam filtering.","source":"@site/docs/getting-started/first-setup.md","sourceDirName":"getting-started","slug":"/getting-started/first-setup","permalink":"/docs.rspamd.com/branches/master/getting-started/first-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/getting-started/first-setup.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"First Setup","sidebar_position":3},"sidebar":"docs","previous":{"title":"Installation Guide","permalink":"/docs.rspamd.com/branches/master/getting-started/installation"},"next":{"title":"Configuration Fundamentals","permalink":"/docs.rspamd.com/branches/master/guides/configuration/fundamentals"}}');var i=n(74848),a=n(28453);const l={title:"First Setup",sidebar_position:3},c="First Setup",d={},t=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Essential Configuration",id:"step-1-essential-configuration",level:2},{value:"Step 2: Test Basic Functionality",id:"step-2-test-basic-functionality",level:2},{value:"Step 3: Mail Server Integration",id:"step-3-mail-server-integration",level:2},{value:"For Postfix",id:"for-postfix",level:3},{value:"For Other MTAs",id:"for-other-mtas",level:3},{value:"Step 4: Verify End-to-End Functionality",id:"step-4-verify-end-to-end-functionality",level:2},{value:"Step 5: Fine-tuning",id:"step-5-fine-tuning",level:2},{value:"Checklist",id:"checklist",level:2},{value:"Common Issues",id:"common-issues",level:2},{value:"Connection Refused",id:"connection-refused",level:3},{value:"No Spam Headers",id:"no-spam-headers",level:3},{value:"All Messages Marked as Spam",id:"all-messages-marked-as-spam",level:3},{value:"Web Interface Won&#39;t Load",id:"web-interface-wont-load",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Getting Help",id:"getting-help",level:2},{value:"Performance Tuning",id:"performance-tuning",level:2},{value:"Worker Count",id:"worker-count",level:3},{value:"DNS Configuration",id:"dns-configuration",level:3},{value:"Memory and Size Limits",id:"memory-and-size-limits",level:3},{value:"Security Hardening",id:"security-hardening",level:2},{value:"Web Interface Access",id:"web-interface-access",level:3},{value:"HTTPS (Optional)",id:"https-optional",level:3},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Updates",id:"updates",level:3},{value:"Backup and Recovery",id:"backup-and-recovery",level:2},{value:"Configuration Backup",id:"configuration-backup",level:3},{value:"Redis Data Backup",id:"redis-data-backup",level:3},{value:"Restore",id:"restore",level:3}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"first-setup",children:"First Setup"})}),"\n",(0,i.jsx)(s.p,{children:"This guide covers basic Rspamd configuration for spam filtering."}),"\n",(0,i.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(s.p,{children:"Before starting:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Rspamd installed - see ",(0,i.jsx)(s.a,{href:"/getting-started/installation",children:"installation guide"})]}),"\n",(0,i.jsx)(s.li,{children:"Redis running (required for statistics and Bayesian learning)"}),"\n",(0,i.jsx)(s.li,{children:"Mail server (MTA) - Postfix, Exim, or Sendmail"}),"\n",(0,i.jsxs)(s.li,{children:["Root access to modify ",(0,i.jsx)(s.code,{children:"/etc/rspamd/"})," configuration"]}),"\n",(0,i.jsx)(s.li,{children:"Test email accounts for validation"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Rspamd uses a ",(0,i.jsx)(s.a,{href:"/developers/architecture",children:"multi-worker architecture"})," with specialized workers. This setup configures:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Normal worker (message scanning)"}),"\n",(0,i.jsx)(s.li,{children:"Controller worker (web UI)"}),"\n",(0,i.jsx)(s.li,{children:"Proxy worker (milter protocol bridge)"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"step-1-essential-configuration",children:"Step 1: Essential Configuration"}),"\n",(0,i.jsxs)(s.p,{children:["Set spam filtering thresholds in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/actions.conf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:"reject = 15;        # Reject obvious spam\nadd_header = 6;     # Add spam headers, deliver\ngreylist = 4;       # Temporarily delay suspicious messages\n"})}),"\n",(0,i.jsxs)(s.p,{children:["These thresholds determine actions based on cumulative scores from ",(0,i.jsx)(s.a,{href:"/getting-started/understanding-rspamd",children:"symbols"})," (SPF, DKIM, Bayes, content rules, RBLs). Actions are applied via ",(0,i.jsx)(s.a,{href:"/developers/protocol",children:"milter protocol"})," and can be overridden per-domain via ",(0,i.jsx)(s.a,{href:"/configuration/settings",children:"settings module"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Configure Redis in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/redis.conf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'servers = "127.0.0.1:6379";\ntimeout = 1s;\n# db = "0";\n# password = "your_redis_password";\n'})}),"\n",(0,i.jsx)(s.p,{children:"Redis is used for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Bayesian statistics"}),"\n",(0,i.jsx)(s.li,{children:"Rate limiting and greylisting"}),"\n",(0,i.jsx)(s.li,{children:"DMARC reports and neural network weights"}),"\n",(0,i.jsx)(s.li,{children:"Message processing history"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Without Redis, statistical learning and rate limiting are disabled. Static rules (SPF, DKIM, DMARC, RBLs) will still work."}),"\n",(0,i.jsx)(s.p,{children:"Set web interface password:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rspamadm pw\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Create ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-controller.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'password = "$2$your_generated_hash_here";\nbind_socket = "localhost:11334";\n# enable_password = "$2$another_hash";  # For dangerous operations\n'})}),"\n",(0,i.jsxs)(s.p,{children:["For remote access, use SSH tunnel: ",(0,i.jsx)(s.code,{children:"ssh -L 11334:localhost:11334 user@your-server"})]}),"\n",(0,i.jsxs)(s.p,{children:["Do not bind to ",(0,i.jsx)(s.code,{children:"0.0.0.0:11334"})," without firewall protection."]}),"\n",(0,i.jsx)(s.p,{children:"Validate configuration:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo rspamadm configtest\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Should output ",(0,i.jsx)(s.code,{children:"syntax OK"}),". Common errors: missing semicolons, unmatched braces, typos."]}),"\n",(0,i.jsx)(s.p,{children:"Restart Rspamd:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart rspamd\nsudo systemctl status rspamd\n"})}),"\n",(0,i.jsx)(s.p,{children:"Check logs if needed:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo journalctl -u rspamd -n 50\n"})}),"\n",(0,i.jsx)(s.h2,{id:"step-2-test-basic-functionality",children:"Step 2: Test Basic Functionality"}),"\n",(0,i.jsx)(s.p,{children:"Test message scanning:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'echo -e "Subject: Test\\n\\nThis is a test message" | rspamc\n'})}),"\n",(0,i.jsx)(s.p,{children:"Output shows action, symbols, and score."}),"\n",(0,i.jsx)(s.p,{children:"Test spam-like content:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'echo -e "Subject: FREE VIAGRA\\n\\nBUY NOW CLICK HERE" | rspamc\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Should show higher score and ",(0,i.jsx)(s.code,{children:"add header"})," action."]}),"\n",(0,i.jsxs)(s.p,{children:["Access web interface at ",(0,i.jsx)(s.code,{children:"http://your-server-ip:11334"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Verify Redis connection:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rspamc stat\n"})}),"\n",(0,i.jsx)(s.p,{children:"Should show statistics and Bayes data. If Redis connection fails:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"redis-cli ping  # Should return PONG\nsudo ss -tlnp | grep 6379  # Check Redis listening\nsudo journalctl -u rspamd | grep -i redis  # Check logs\n"})}),"\n",(0,i.jsx)(s.h2,{id:"step-3-mail-server-integration",children:"Step 3: Mail Server Integration"}),"\n",(0,i.jsx)(s.h3,{id:"for-postfix",children:"For Postfix"}),"\n",(0,i.jsxs)(s.p,{children:["Configure Rspamd proxy worker in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-proxy.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'milter = yes;\ntimeout = 120s;\nupstream "local" {\n  default = yes;\n  self_scan = yes;\n}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.a,{href:"/workers/rspamd_proxy",children:"proxy worker"})," bridges your MTA and the normal worker, handling milter protocol translation and connection pooling."]}),"\n",(0,i.jsxs)(s.p,{children:["Add to ",(0,i.jsx)(s.code,{children:"/etc/postfix/main.cf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"smtpd_milters = inet:localhost:11332\nnon_smtpd_milters = inet:localhost:11332\nmilter_default_action = accept\nmilter_protocol = 6\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Note: ",(0,i.jsx)(s.code,{children:"milter_default_action = accept"})," means mail is accepted if Rspamd is down. Use ",(0,i.jsx)(s.code,{children:"tempfail"})," for stricter behavior."]}),"\n",(0,i.jsx)(s.p,{children:"Restart services:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart rspamd postfix\n"})}),"\n",(0,i.jsx)(s.h3,{id:"for-other-mtas",children:"For Other MTAs"}),"\n",(0,i.jsxs)(s.p,{children:["See ",(0,i.jsx)(s.a,{href:"/tutorials/integration",children:"integration guide"})," for Exim, Sendmail, and other MTAs."]}),"\n",(0,i.jsx)(s.h2,{id:"step-4-verify-end-to-end-functionality",children:"Step 4: Verify End-to-End Functionality"}),"\n",(0,i.jsxs)(s.p,{children:["Send a regular email and check for ",(0,i.jsx)(s.code,{children:"X-Spam-Status"})," header with low score."]}),"\n",(0,i.jsxs)(s.p,{children:["Test with ",(0,i.jsx)(s.a,{href:"/other/gtube_patterns",children:"GTUBE pattern"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'echo -e "Subject: GTUBE Test\\n\\nXJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X" | \\\n  sendmail test@yourdomain.com\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Should trigger ",(0,i.jsx)(s.code,{children:"GTUBE"})," symbol with high score and ",(0,i.jsx)(s.code,{children:"reject"})," action. Check MTA logs for rejection."]}),"\n",(0,i.jsx)(s.p,{children:"Test spam-like content:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'echo -e "Subject: FREE MONEY NOW\\n\\nCLICK HERE FOR FREE MONEY" | sendmail test@yourdomain.com\n'})}),"\n",(0,i.jsx)(s.p,{children:"Should add spam headers and deliver with higher score."}),"\n",(0,i.jsx)(s.p,{children:"Check message processing in web interface History tab."}),"\n",(0,i.jsx)(s.h2,{id:"step-5-fine-tuning",children:"Step 5: Fine-tuning"}),"\n",(0,i.jsx)(s.p,{children:"Adjust thresholds:"}),"\n",(0,i.jsxs)(s.p,{children:["Edit ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/actions.conf"})," based on results:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Too many false positives: increase ",(0,i.jsx)(s.code,{children:"add_header"})," to 8"]}),"\n",(0,i.jsxs)(s.li,{children:["Missing spam: decrease ",(0,i.jsx)(s.code,{children:"add_header"})," to 4"]}),"\n",(0,i.jsxs)(s.li,{children:["Greylisting delays: increase ",(0,i.jsx)(s.code,{children:"greylist"})," to 6"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Enable Bayesian learning in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/classifier-bayes.conf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'backend = "redis";\nnew_schema = true;\nexpire = 8640000;  # 100 days\n\nautolearn {\n  spam_threshold = 12.0;\n  ham_threshold = -2.0;\n  check_balance = true;\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:"Train with spam and ham samples:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rspamc learn_spam /path/to/spam-message.eml\nrspamc learn_ham /path/to/ham-message.eml\n\n# Bulk training\nfind /path/to/spam/ -type f | xargs -I {} rspamc learn_spam {}\nfind /path/to/ham/ -type f | xargs -I {} rspamc learn_ham {}\n\n# Check statistics\nrspamc stat | grep -A2 BAYES\n"})}),"\n",(0,i.jsx)(s.p,{children:"Train with at least 200 spam and 200 ham messages. Keep ratio balanced (within 2:1)."}),"\n",(0,i.jsx)(s.p,{children:"Restart:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart rspamd\n"})}),"\n",(0,i.jsx)(s.h2,{id:"checklist",children:"Checklist"}),"\n",(0,i.jsx)(s.p,{children:"After setup:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Messages analyzed and scored"}),"\n",(0,i.jsx)(s.li,{children:"Spam rejected or marked based on thresholds"}),"\n",(0,i.jsx)(s.li,{children:"Web interface accessible"}),"\n",(0,i.jsx)(s.li,{children:"MTA integrated with Rspamd"}),"\n",(0,i.jsx)(s.li,{children:"Message processing visible in web UI"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsx)(s.h3,{id:"connection-refused",children:"Connection Refused"}),"\n",(0,i.jsx)(s.p,{children:"If MTA can't connect to port 11332:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl status rspamd\nsudo ss -tlnp | grep rspamd  # Should show 11332, 11333, 11334\nsudo lsof -i :11332  # Check port conflicts\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Fix: Verify ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-proxy.inc"})," exists and restart Rspamd."]}),"\n",(0,i.jsx)(s.p,{children:"For SELinux (RHEL/CentOS):"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo setsebool -P antivirus_can_scan_system 1\n"})}),"\n",(0,i.jsx)(s.h3,{id:"no-spam-headers",children:"No Spam Headers"}),"\n",(0,i.jsxs)(s.p,{children:["If messages have no ",(0,i.jsx)(s.code,{children:"X-Spam-*"})," headers:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rspamc configdump milter_headers\nrspamc stat  # Check messages scanned\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Enable in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/milter_headers.conf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'use = ["x-spamd-bar", "x-spam-level", "x-spam-status", "authentication-results"];\n'})}),"\n",(0,i.jsx)(s.p,{children:"Verify Postfix configuration:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"postconf | grep milter\n"})}),"\n",(0,i.jsx)(s.h3,{id:"all-messages-marked-as-spam",children:"All Messages Marked as Spam"}),"\n",(0,i.jsx)(s.p,{children:"Check which symbols are triggering:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'echo "test message" | rspamc\nrspamc stat | grep -A2 BAYES\n'})}),"\n",(0,i.jsx)(s.p,{children:"Common causes:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Imbalanced Bayes training"}),": Reset and retrain with balanced samples"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rspamc learn_spam --reset\nrspamc learn_ham --reset\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"DNS issues"}),": Configure local resolver in ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/options.inc"})]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'dns {\n  nameserver = ["127.0.0.1"];\n  timeout = 2s;\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Low thresholds"}),": Increase values in ",(0,i.jsx)(s.code,{children:"actions.conf"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"web-interface-wont-load",children:"Web Interface Won't Load"}),"\n",(0,i.jsx)(s.p,{children:"Check controller is running:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo ss -tlnp | grep 11334\ncurl -I http://localhost:11334/\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Fix: Verify ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-controller.inc"})," exists with password."]}),"\n",(0,i.jsx)(s.p,{children:"For remote access, use SSH tunnel:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ssh -L 11334:localhost:11334 user@your-server\n"})}),"\n",(0,i.jsx)(s.p,{children:"For SELinux:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo setsebool -P antivirus_can_scan_system 1\nsudo semanage port -a -t antivirus_port_t -p tcp 11334\n"})}),"\n",(0,i.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Monitor history tab and adjust thresholds"}),"\n",(0,i.jsxs)(s.li,{children:["Read ",(0,i.jsx)(s.a,{href:"/guides/configuration/fundamentals",children:"configuration fundamentals"})]}),"\n",(0,i.jsxs)(s.li,{children:["Review ",(0,i.jsx)(s.a,{href:"/developers/architecture",children:"architecture"})," for troubleshooting"]}),"\n",(0,i.jsxs)(s.li,{children:["Back up ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/"})," and Redis data"]}),"\n",(0,i.jsxs)(s.li,{children:["Explore ",(0,i.jsx)(s.a,{href:"/developers/writing_rules",children:"rule writing"})," for custom rules"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/configuration/",children:"Configuration reference"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/support",children:"Community support"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/faq",children:"FAQ"})}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,i.jsx)(s.h3,{id:"worker-count",children:"Worker Count"}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-normal.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:"count = 4;  # Match CPU cores\n"})}),"\n",(0,i.jsx)(s.h3,{id:"dns-configuration",children:"DNS Configuration"}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/options.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'dns {\n  timeout = 1s;\n  retransmits = 2;\n  sockets = 16;\n  nameserver = ["127.0.0.1"];\n}\n'})}),"\n",(0,i.jsx)(s.h3,{id:"memory-and-size-limits",children:"Memory and Size Limits"}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/options.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:"max_lua_urls = 1024;\nmax_urls = 10000;\nmax_recipients = 1024;\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-normal.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:"task_timeout = 8s;\nmax_message_size = 50M;\n"})}),"\n",(0,i.jsx)(s.h2,{id:"security-hardening",children:"Security Hardening"}),"\n",(0,i.jsx)(s.h3,{id:"web-interface-access",children:"Web Interface Access"}),"\n",(0,i.jsx)(s.p,{children:"Keep controller bound to localhost. Use SSH tunnel for remote access."}),"\n",(0,i.jsx)(s.h3,{id:"https-optional",children:"HTTPS (Optional)"}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/worker-controller.inc"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'secure_ip = "127.0.0.1";\nssl_certificate = "/path/to/cert.pem";\nssl_certificate_key = "/path/to/key.pem";\n'})}),"\n",(0,i.jsx)(s.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,i.jsxs)(s.p,{children:["In ",(0,i.jsx)(s.code,{children:"/etc/rspamd/local.d/ratelimit.conf"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-hcl",children:'rates {\n  to = {\n    bucket = {\n      rate = "10 / 1m";\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(s.h3,{id:"updates",children:"Updates"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo apt update && sudo apt upgrade rspamd  # Debian/Ubuntu\nsudo dnf update rspamd                      # RHEL/Rocky\n"})}),"\n",(0,i.jsx)(s.h2,{id:"backup-and-recovery",children:"Backup and Recovery"}),"\n",(0,i.jsx)(s.h3,{id:"configuration-backup",children:"Configuration Backup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo tar -czf rspamd-config-$(date +%F).tar.gz /etc/rspamd/local.d/ /etc/rspamd/override.d/\n"})}),"\n",(0,i.jsx)(s.h3,{id:"redis-data-backup",children:"Redis Data Backup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"redis-cli SAVE\nsudo cp /var/lib/redis/dump.rdb /backup/\n"})}),"\n",(0,i.jsx)(s.h3,{id:"restore",children:"Restore"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo tar -xzf rspamd-config-YYYY-MM-DD.tar.gz -C /\nsudo systemctl restart rspamd\n"})})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);