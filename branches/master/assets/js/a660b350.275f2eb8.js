"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[8614],{5953:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"developers/architecture","title":"Rspamd architecture","description":"Overview","source":"@site/docs/developers/architecture.md","sourceDirName":"developers","slug":"/developers/architecture","permalink":"/docs.rspamd.com/branches/master/developers/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/developers/architecture.md","tags":[],"version":"current","frontMatter":{"title":"Rspamd architecture"},"sidebar":"docs","previous":{"title":"ClickHouse Analytics Platform","permalink":"/docs.rspamd.com/branches/master/tutorials/clickhouse_analytics"},"next":{"title":"Rspamd architecture","permalink":"/docs.rspamd.com/branches/master/developers/architecture"}}');var r=i(4848),l=i(8453);const t={title:"Rspamd architecture"},a="Rspamd architecture",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Architecture",id:"core-architecture",level:2},{value:"Main Components",id:"main-components",level:3},{value:"Message Processing Flow",id:"message-processing-flow",level:3},{value:"Rules and Modules System",id:"rules-and-modules-system",level:2},{value:"Rule Examples",id:"rule-examples",level:3},{value:"Module Types",id:"module-types",level:3},{value:"Scoring and Actions System",id:"scoring-and-actions-system",level:2},{value:"Metrics and Weights",id:"metrics-and-weights",level:3},{value:"Action Thresholds",id:"action-thresholds",level:3},{value:"Dynamic Scoring",id:"dynamic-scoring",level:3},{value:"Statistical Classification",id:"statistical-classification",level:2},{value:"Bayesian Classification",id:"bayesian-classification",level:3},{value:"Neural Networks Plugin",id:"neural-networks-plugin",level:3},{value:"Fuzzy Hashing",id:"fuzzy-hashing",level:3},{value:"Protocol and Integration",id:"protocol-and-integration",level:2},{value:"HTTP API",id:"http-api",level:3},{value:"MTA Integration",id:"mta-integration",level:3},{value:"Performance Optimizations",id:"performance-optimizations",level:2},{value:"Rule Scheduling",id:"rule-scheduling",level:3},{value:"Caching and Memory Management",id:"caching-and-memory-management",level:3},{value:"Configuration and Management",id:"configuration-and-management",level:2},{value:"Configuration System",id:"configuration-system",level:3},{value:"Signal Management",id:"signal-management",level:3},{value:"Extensibility",id:"extensibility",level:2},{value:"Lua Framework",id:"lua-framework",level:3},{value:"Plugin Architecture",id:"plugin-architecture",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"rspamd-architecture",children:"Rspamd architecture"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd is a high-performance mail processing framework built on an event-driven, non-blocking architecture. It operates as a standalone service that integrates with Mail Transfer Agents (MTAs) through a well-defined HTTP/JSON API, maintaining strict isolation from MTA internals for enhanced security."}),"\n",(0,r.jsx)(n.h2,{id:"core-architecture",children:"Core Architecture"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd's architecture consists of several key components working together to provide comprehensive mail processing capabilities:"}),"\n",(0,r.jsx)(n.h3,{id:"main-components",children:"Main Components"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Main Process"}),": Coordinates worker processes and handles configuration management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Normal Workers"}),": Handle message processing and HTTP requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Proxy Worker"}),": Provides Milter protocol support and forwarding capabilities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Controller Process"}),": Provides web interface and management API"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fuzzy Storage"}),": Manages fuzzy hashing for near-duplicate detection"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"message-processing-flow",children:"Message Processing Flow"}),"\n",(0,r.jsx)(n.p,{children:"Every message processed by Rspamd follows a structured pipeline that ensures thorough analysis while maintaining high performance."}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TB\n    subgraph "MTA Integration"\n        MTA[Mail Transfer Agent]\n        Milter[Milter Protocol]\n        HTTP[HTTP API]\n    end\n    \n    subgraph "Rspamd Core"\n        Main[Main Process]\n        Normal1[Normal Worker 1]\n        Normal2[Normal Worker 2]\n        Proxy[Proxy Worker]\n        Controller[Controller Process]\n        Fuzzy[Fuzzy Storage]\n    end\n    \n    subgraph "Storage & Cache"\n        Redis[Redis Cache]\n        DB[Statistics DB]\n        Files[Config Files]\n    end\n    \n    subgraph "External Services"\n        RBL[RBL Services]\n        Reputation[Reputation APIs]\n        LLM[LLM Services (GPT)]\n        Custom[Custom Services]\n    end\n    \n    MTA --\x3e Milter\n    MTA --\x3e HTTP\n    \n    Milter --\x3e Proxy\n    HTTP --\x3e Main\n    \n    Main --\x3e Normal1\n    Main --\x3e Normal2\n    Main --\x3e Proxy\n    Main --\x3e Controller\n    Main --\x3e Fuzzy\n    \n    Normal1 --\x3e Redis\n    Normal2 --\x3e Redis\n    Proxy --\x3e Redis\n    \n    Normal1 --\x3e DB\n    Normal1 --\x3e RBL\n    Normal1 --\x3e Reputation\n    Normal1 --\x3e LLM\n    Normal1 --\x3e Custom\n    \n    Controller --\x3e Redis\n    Controller --\x3e DB\n    Controller --\x3e Files'}),"\n",(0,r.jsx)(n.h2,{id:"rules-and-modules-system",children:"Rules and Modules System"}),"\n",(0,r.jsxs)(n.p,{children:["Rspamd uses a modular approach where functionality is implemented through ",(0,r.jsx)(n.strong,{children:"modules"})," that define ",(0,r.jsx)(n.strong,{children:"rules"}),". Each rule represents a specific message property or characteristic:"]}),"\n",(0,r.jsx)(n.mermaid,{value:'flowchart TD\n    Start([Message Received]) --\x3e Parse[Parse Message]\n    Parse --\x3e PreFilters[Pre-filter Modules]\n    PreFilters --\x3e Rules[Rule Processing]\n    \n    subgraph "Rule Processing Pipeline"\n        Rules --\x3e Auth[Authentication<br/>SPF, DKIM, DMARC]\n        Auth --\x3e Content[Content Analysis<br/>Regexp, Phishing]\n        Content --\x3e Stats[Statistical Analysis<br/>Bayes, Neural Networks]\n        Stats --\x3e Reputation[Reputation Checks<br/>RBL, URL Lists]\n        Reputation --\x3e Fuzzy[Fuzzy Matching<br/>Near-duplicates]\n        Fuzzy --\x3e Custom[Custom Rules<br/>Lua Modules]\n    end\n    \n    Custom --\x3e Score[Calculate Final Score]\n    Score --\x3e Action{Determine Action}\n    \n    Action --\x3e|Score < 0| NoAction[No Action]\n    Action --\x3e|0 \u2264 Score < 6| Greylist[Greylist]\n    Action --\x3e|6 \u2264 Score < 12| AddHeader[Add Header]\n    Action --\x3e|12 \u2264 Score < 20| Rewrite[Rewrite Subject]\n    Action --\x3e|Score \u2265 20| Reject[Reject]\n    \n    NoAction --\x3e Response[Return Response to MTA]\n    Greylist --\x3e Response\n    AddHeader --\x3e Response\n    Rewrite --\x3e Response\n    Reject --\x3e Response\n    \n    Response --\x3e End([End])'}),"\n",(0,r.jsx)(n.h3,{id:"rule-examples",children:"Rule Examples"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SPF_ALLOW"})," - message validated by SPF"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"BAYES_SPAM"})," - statistical spam classification"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"NEURAL_SPAM"})," - neural network spam detection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DKIM_VALID"})," - valid DKIM signature"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"URL_PHISHING"})," - phishing URL detected"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"module-types",children:"Module Types"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd supports multiple module implementations:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"C Modules"})," (Internal)"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Embedded in the core binary"}),"\n",(0,r.jsx)(n.li,{children:"High-performance critical functions"}),"\n",(0,r.jsx)(n.li,{children:"Examples: DKIM, SPF, regexp"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Lua Modules"})," (External)"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Full access to Rspamd Lua API"}),"\n",(0,r.jsx)(n.li,{children:"Flexible and easily customizable"}),"\n",(0,r.jsx)(n.li,{children:"Examples: multimap, rbl, phishing"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Advanced Plugins"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Statistical and ML-based analysis"}),"\n",(0,r.jsx)(n.li,{children:"Learn from existing symbols and patterns"}),"\n",(0,r.jsx)(n.li,{children:"Provide adaptive classification"}),"\n"]}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Module Architecture"\n        subgraph "C Modules (Internal)"\n            SPF[SPF Module]\n            DKIM[DKIM Module]\n            Regexp[Regexp Module]\n            Chartable[Chartable Module]\n            Fuzzy[Fuzzy Check Module]\n        end\n        \n        subgraph "Lua Modules (External)"\n            Multimap[Multimap Module]\n            RBL[RBL Module]\n            Phishing[Phishing Module]\n            Whitelist[Whitelist Module]\n            Custom[Custom Lua Rules]\n        end\n        \n        subgraph "Statistical & ML Plugins"\n            Bayes[Bayesian Classifier]\n            Neural[Neural Networks Plugin<br/>Perceptron clustering]\n            Reputation[IP/URL Reputation]\n            GPT[GPT Plugin<br/>LLM Integration]\n        end\n    end\n    \n    subgraph "Rspamd Core Engine"\n        Scanner[Message Scanner]\n        Symbols[Symbol Registry]\n        Config[Configuration]\n        API[Lua API]\n    end\n    \n    subgraph "External Data Sources"\n        Redis[(Redis Cache)]\n        Database[(Statistics DB)]\n        LLM[LLM Services]\n        Files[Configuration Files]\n    end\n    \n    SPF --\x3e Symbols\n    DKIM --\x3e Symbols\n    Regexp --\x3e Symbols\n    Chartable --\x3e Symbols\n    Fuzzy --\x3e Symbols\n    \n    Multimap --\x3e API\n    RBL --\x3e API\n    Phishing --\x3e API\n    Whitelist --\x3e API\n    Custom --\x3e API\n    \n    API --\x3e Symbols\n    \n    Bayes --\x3e Redis\n    Neural --\x3e Symbols\n    Reputation --\x3e Redis\n    GPT --\x3e LLM\n    \n    Bayes --\x3e Symbols\n    Neural --\x3e Symbols\n    Reputation --\x3e Symbols\n    GPT --\x3e Symbols\n    \n    Scanner --\x3e SPF\n    Scanner --\x3e DKIM\n    Scanner --\x3e Multimap\n    Scanner --\x3e Bayes\n    \n    Config --\x3e Files\n    Config --\x3e Scanner'}),"\n",(0,r.jsx)(n.h2,{id:"scoring-and-actions-system",children:"Scoring and Actions System"}),"\n",(0,r.jsx)(n.h3,{id:"metrics-and-weights",children:"Metrics and Weights"}),"\n",(0,r.jsxs)(n.p,{children:["Rules are assigned ",(0,r.jsx)(n.strong,{children:"weights"})," that represent their significance in determining message classification. The cumulative score determines the recommended action."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Weight Guidelines:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Negative weights: decrease spam probability (ham indicators)"}),"\n",(0,r.jsx)(n.li,{children:"Positive weights: increase spam probability (spam indicators)"}),"\n",(0,r.jsx)(n.li,{children:"Higher absolute values: more significant rules"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"action-thresholds",children:"Action Thresholds"}),"\n",(0,r.jsx)(n.p,{children:"Based on the total score, Rspamd recommends one of several actions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No action"})," (score < greylist): Message is likely legitimate"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Greylist"})," (greylist \u2264 score < add_header): Temporary delay recommended"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Add header"})," (add_header \u2264 score < rewrite_subject): Mark as likely spam"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rewrite subject"})," (rewrite_subject \u2264 score < reject): Modify subject line"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reject"})," (score \u2265 reject): Block message completely"]}),"\n"]}),"\n",(0,r.jsx)(n.mermaid,{value:'graph LR\n    subgraph "Rule Weights"\n        R1["`SPF_ALLOW\n        Weight: -1.0`"]\n        R2["`BAYES_SPAM\n        Weight: 0-5.0`"]\n        R3["`NEURAL_SPAM\n        Weight: 0-10.0`"]\n        R4["`URL_PHISHING\n        Weight: 7.5`"]\n        R5["`DKIM_VALID\n        Weight: -0.5`"]\n    end\n    \n    subgraph "Score Calculation"\n        Sum["`Total Score =\n        Sum of all triggered rules`"]\n    end\n    \n    subgraph "Action Thresholds"\n        Actions["`No Action: < 0\n        Greylist: 0-6\n        Add Header: 6-12\n        Rewrite Subject: 12-20\n        Reject: \u2265 20`"]\n    end\n    \n    subgraph "Examples"\n        E1["`Example 1:\n        SPF_ALLOW (-1.0) +\n        DKIM_VALID (-0.5) =\n        -1.5 \u2192 No Action`"]\n        \n        E2["`Example 2:\n        BAYES_SPAM (3.2) +\n        NEURAL_SPAM (4.8) =\n        8.0 \u2192 Add Header`"]\n        \n        E3["`Example 3:\n        URL_PHISHING (7.5) +\n        BAYES_SPAM (4.9) +\n        NEURAL_SPAM (8.2) =\n        20.6 \u2192 Reject`"]\n    end\n    \n    R1 --\x3e Sum\n    R2 --\x3e Sum\n    R3 --\x3e Sum\n    R4 --\x3e Sum\n    R5 --\x3e Sum\n    \n    Sum --\x3e Actions\n    Actions --\x3e E1\n    Actions --\x3e E2\n    Actions --\x3e E3'}),"\n",(0,r.jsx)(n.h3,{id:"dynamic-scoring",children:"Dynamic Scoring"}),"\n",(0,r.jsxs)(n.p,{children:["Advanced rules can provide ",(0,r.jsx)(n.strong,{children:"dynamic weights"})," based on confidence levels. For example:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Bayesian classifier: weight varies from 0 to maximum based on probability"}),"\n",(0,r.jsx)(n.li,{children:"Neural networks plugin: clustering-based confidence scoring"}),"\n",(0,r.jsx)(n.li,{children:"Reputation plugins: score based on IP/URL history"}),"\n",(0,r.jsx)(n.li,{children:"GPT plugin: LLM-based analysis with confidence scores"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"statistical-classification",children:"Statistical Classification"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd employs multiple statistical and machine learning algorithms:"}),"\n",(0,r.jsx)(n.h3,{id:"bayesian-classification",children:"Bayesian Classification"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"OSB-Bayes algorithm"})," with 2-word windows"]}),"\n",(0,r.jsx)(n.li,{children:"Token-based message analysis"}),"\n",(0,r.jsx)(n.li,{children:"Multiple backend support (Redis, SQLite, files)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"neural-networks-plugin",children:"Neural Networks Plugin"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Perceptron-based clustering"})," using existing symbols as features"]}),"\n",(0,r.jsx)(n.li,{children:"Adaptive learning from symbol patterns"}),"\n",(0,r.jsx)(n.li,{children:"Provides additional classification signals"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"fuzzy-hashing",children:"Fuzzy Hashing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Near-duplicate detection"})," using fuzzy hashes"]}),"\n",(0,r.jsx)(n.li,{children:"Distributed fuzzy storage"}),"\n",(0,r.jsx)(n.li,{children:"Bulk message identification"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"protocol-and-integration",children:"Protocol and Integration"}),"\n",(0,r.jsx)(n.h3,{id:"http-api",children:"HTTP API"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd communicates through HTTP/JSON protocol:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RESTful endpoints"})," for all operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JSON message format"})," for requests/responses"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication and SSL/TLS"})," support"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compression support"})," (zstd) for efficient data transfer"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"mta-integration",children:"MTA Integration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Milter protocol"})," support via proxy worker for Postfix/Sendmail"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HTTP proxy mode"})," for load balancing and forwarding"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Direct HTTP integration"})," for custom MTA setups"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"After-queue processing"})," for existing mail flows"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-optimizations",children:"Performance Optimizations"}),"\n",(0,r.jsx)(n.h3,{id:"rule-scheduling",children:"Rule Scheduling"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd optimizes rule execution through intelligent scheduling:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Negative rules first"}),": Prevent false positives early"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Weight-based priority"}),": Important rules execute first"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Frequency optimization"}),": Common rules get priority"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Early termination"}),": Stop processing when definitive result reached"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"caching-and-memory-management",children:"Caching and Memory Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Redis caching"})," for statistical data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory-mapped files"})," for fast data access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection pooling"})," for external services"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Asynchronous I/O"})," for non-blocking operations"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-and-management",children:"Configuration and Management"}),"\n",(0,r.jsx)(n.h3,{id:"configuration-system",children:"Configuration System"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"UCL format"})," (Universal Configuration Language)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hierarchical structure"})," with includes and overrides"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Runtime reloading"})," without service interruption"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation and testing"})," modes"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"signal-management",children:"Signal Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SIGHUP"}),": Graceful restart with config reload"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SIGTERM"}),": Clean shutdown"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SIGUSR1"}),": Log file rotation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SIGUSR2"}),": Worker respawn"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"extensibility",children:"Extensibility"}),"\n",(0,r.jsx)(n.h3,{id:"lua-framework",children:"Lua Framework"}),"\n",(0,r.jsx)(n.p,{children:"Rspamd provides a comprehensive Lua API enabling:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Custom rule development"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"External service integration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Protocol extensions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Advanced message manipulation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Machine learning model integration"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"plugin-architecture",children:"Plugin Architecture"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Composable functionality"})," through plugins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event-driven hooks"})," for message processing stages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shared data structures"})," between modules"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Runtime module loading/unloading"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(6540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);