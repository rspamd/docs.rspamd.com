"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[6016],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var o=s(96540);const r={},t=o.createContext(r);function a(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(t.Provider,{value:n},e.children)}},44815:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"modules/asn","title":"ASN module","description":"The ASN module retrieves ASN numbers and related information such as the country code of the ASN owner and the IP\'s announced subnet. These details are then made available to other plugins as mempool variables.","source":"@site/docs/modules/asn.md","sourceDirName":"modules","slug":"/modules/asn","permalink":"/docs.rspamd.com/branches/master/modules/asn","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/asn.md","tags":[],"version":"current","frontMatter":{"title":"ASN module"},"sidebar":"docs","previous":{"title":"ARC module","permalink":"/docs.rspamd.com/branches/master/modules/arc"},"next":{"title":"Bayes expiry module","permalink":"/docs.rspamd.com/branches/master/modules/bayes_expiry"}}');var r=s(74848),t=s(28453);const a={title:"ASN module"},d="ASN module",i={},c=[{value:"Configuration",id:"configuration",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",sup:"sup",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"asn-module",children:"ASN module"})}),"\n",(0,r.jsx)(n.p,{children:"The ASN module retrieves ASN numbers and related information such as the country code of the ASN owner and the IP's announced subnet. These details are then made available to other plugins as mempool variables."}),"\n",(0,r.jsxs)(n.p,{children:["The module exports ",(0,r.jsx)(n.code,{children:"asn"}),", ",(0,r.jsx)(n.code,{children:"country"})," and ",(0,r.jsx)(n.code,{children:"ipnet"}),(0,r.jsx)(n.sup,{children:(0,r.jsx)(n.a,{href:"#fn",children:"1"})})," as mempool variables available from Lua after prefilters stage."]}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ASN module is enabled by default and its settings can be found in ",(0,r.jsx)(n.code,{children:"/etc/rspamd/local.d/asn.conf"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'# Provider: just "rspamd" for now\nprovider_type = "rspamd";\n# Provider-specific configuration\nprovider_info {\n  ip4 = "asn.rspamd.com";\n  ip6 = "asn6.rspamd.com";\n}\n# If defined, insert symbol with lookup results\nsymbol = "ASN";\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{name:"fn",children:(0,r.jsx)(n.sup,{children:"1:"})})," till version 2.0 as it is a dup of ASN"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);