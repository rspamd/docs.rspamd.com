"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[6315],{5692:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"modules/once_received","title":"Once received module","description":"This module is intended to do simple checks for mail with one Received header. The underlying concept is that genuine emails tend to have multiple received headers, whereas spam originating from compromised user devices often exhibit certain negative characteristics, such as the use of dynamic or broadband IP addresses.","source":"@site/docs/modules/once_received.md","sourceDirName":"modules","slug":"/modules/once_received","permalink":"/docs.rspamd.com/branches/master/modules/once_received","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/once_received.md","tags":[],"version":"current","frontMatter":{"title":"Once received module"},"sidebar":"docs","previous":{"title":"Neural network module","permalink":"/docs.rspamd.com/branches/master/modules/neural"},"next":{"title":"Phishing module","permalink":"/docs.rspamd.com/branches/master/modules/phishing"}}');var t=s(4848),o=s(8453);const d={title:"Once received module"},r="Once received module",c={},a=[{value:"Configuration",id:"configuration",level:2},{value:"Example",id:"example",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"once-received-module",children:"Once received module"})}),"\n",(0,t.jsxs)(n.p,{children:["This module is intended to do simple checks for mail with one ",(0,t.jsx)(n.code,{children:"Received"})," header. The underlying concept is that genuine emails tend to have multiple received headers, whereas spam originating from compromised user devices often exhibit certain negative characteristics, such as the use of ",(0,t.jsx)(n.code,{children:"dynamic"})," or ",(0,t.jsx)(n.code,{children:"broadband"})," IP addresses."]}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Configuring this module is quite straightforward: you simply need to define a ",(0,t.jsx)(n.code,{children:"symbol"})," for generic emails with only one received header, specify a ",(0,t.jsx)(n.code,{children:"symbol_strict"})," for emails that exhibit negative patterns or have unresolved hostnames, and include ",(0,t.jsx)(n.strong,{children:"good"})," and ",(0,t.jsx)(n.strong,{children:"bad"})," patterns, which can utilise ",(0,t.jsx)(n.a,{href:"http://lua-users.org/wiki/PatternsTutorial",children:"lua patterns"}),". Use ",(0,t.jsx)(n.code,{children:"good_host"})," lines to exclude certain hosts from this module, and ",(0,t.jsx)(n.code,{children:"bad_host"})," lines to identify specific negative patterns. Additionally, you can create a ",(0,t.jsx)(n.code,{children:"whitelist"})," to define a list of networks for which the ",(0,t.jsx)(n.code,{children:"once_received"})," checks should be excluded."]}),"\n",(0,t.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-hcl",children:'once_received {\n    good_host = "^mail";\n    bad_host = "static";\n    bad_host = "dynamic";\n    symbol_strict = "ONCE_RECEIVED_STRICT";\n    symbol = "ONCE_RECEIVED";\n    whitelist = "/tmp/ip.map";\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["As is typical, the IP map can include both IPv4 and IPv6 addresses, as well as networks in CIDR notation. You may also add optional comments to the map, indicated by a ",(0,t.jsx)(n.code,{children:"#"})," symbol."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>r});var i=s(6540);const t={},o=i.createContext(t);function d(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);