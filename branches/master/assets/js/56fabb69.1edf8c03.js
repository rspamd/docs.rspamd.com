"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[3770],{6641:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"getting-started/understanding-rspamd","title":"Understanding Rspamd","description":"Before diving into configuration and setup, it\'s crucial to understand what Rspamd does and what you can configure. This mental model will help you make informed decisions throughout your spam filtering journey.","source":"@site/docs/getting-started/understanding-rspamd.md","sourceDirName":"getting-started","slug":"/getting-started/understanding-rspamd","permalink":"/docs.rspamd.com/branches/master/getting-started/understanding-rspamd","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/getting-started/understanding-rspamd.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Understanding Rspamd","sidebar_position":1},"sidebar":"docs","previous":{"title":"Getting Started with Rspamd","permalink":"/docs.rspamd.com/branches/master/getting-started/"},"next":{"title":"Installation Guide","permalink":"/docs.rspamd.com/branches/master/getting-started/installation"}}');var r=s(4848),i=s(8453);const o={title:"Understanding Rspamd",sidebar_position:1},l="Understanding Rspamd",d={},a=[{value:"What is Rspamd?",id:"what-is-rspamd",level:2},{value:"The Email Analysis Pipeline",id:"the-email-analysis-pipeline",level:3},{value:"Core Concepts You Need to Know",id:"core-concepts-you-need-to-know",level:2},{value:"1. Modules - The Test Runners",id:"1-modules---the-test-runners",level:3},{value:"2. Symbols - Test Results",id:"2-symbols---test-results",level:3},{value:"3. Scores - How Much Each Test Matters",id:"3-scores---how-much-each-test-matters",level:3},{value:"4. Actions - What to Do at Different Score Levels",id:"4-actions---what-to-do-at-different-score-levels",level:3},{value:"5. Workers - Different Processes for Different Jobs",id:"5-workers---different-processes-for-different-jobs",level:3},{value:"What Can You Configure in Rspamd?",id:"what-can-you-configure-in-rspamd",level:2},{value:"1. Which Tests to Run (Modules)",id:"1-which-tests-to-run-modules",level:3},{value:"2. Test Sensitivity (Module Settings)",id:"2-test-sensitivity-module-settings",level:3},{value:"3. Symbol Weights (Scores)",id:"3-symbol-weights-scores",level:3},{value:"4. Action Thresholds",id:"4-action-thresholds",level:3},{value:"5. Worker Configuration",id:"5-worker-configuration",level:3},{value:"6. System Behavior (General Options)",id:"6-system-behavior-general-options",level:3},{value:"Configuration Mental Model",id:"configuration-mental-model",level:2},{value:"Common Configuration Patterns",id:"common-configuration-patterns",level:2},{value:"The &quot;Quick Start&quot; Pattern",id:"the-quick-start-pattern",level:3},{value:"The &quot;Tuned Environment&quot; Pattern",id:"the-tuned-environment-pattern",level:3},{value:"The &quot;High Performance&quot; Pattern",id:"the-high-performance-pattern",level:3},{value:"What&#39;s Next?",id:"whats-next",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2}];function c(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"understanding-rspamd",children:"Understanding Rspamd"})}),"\n",(0,r.jsxs)(n.p,{children:["Before diving into configuration and setup, it's crucial to understand ",(0,r.jsx)(n.strong,{children:"what Rspamd does"})," and ",(0,r.jsx)(n.strong,{children:"what you can configure"}),". This mental model will help you make informed decisions throughout your spam filtering journey."]}),"\n",(0,r.jsx)(n.h2,{id:"what-is-rspamd",children:"What is Rspamd?"}),"\n",(0,r.jsxs)(n.p,{children:["Rspamd is an ",(0,r.jsx)(n.strong,{children:"email analysis engine"}),' that examines messages and decides what to do with them based on their "spaminess" score. Think of it as a sophisticated bouncer for your email server.']}),"\n",(0,r.jsx)(n.h3,{id:"the-email-analysis-pipeline",children:"The Email Analysis Pipeline"}),"\n",(0,r.jsx)(n.mermaid,{value:"flowchart LR\n    A[Email Arrives] --\x3e B[Rspamd Analysis]\n    B --\x3e C[Multiple Tests]\n    C --\x3e D[Symbols Generated]  \n    D --\x3e E[Score Calculation]\n    E --\x3e F[Action Decision]\n    F --\x3e G[Result to MTA]"}),"\n",(0,r.jsx)(n.p,{children:"Here's what happens when an email arrives:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Email arrives"})," at your mail server (MTA)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rspamd analysis"})," begins - the message is passed to Rspamd"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multiple tests"})," run simultaneously (DNS checks, content analysis, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Symbols generated"}),' - each test that matches produces a "symbol" (like ',(0,r.jsx)(n.code,{children:"FORGED_SENDER"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Score calculation"})," - each symbol has a weight that adds to the total score"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action decision"})," - based on the total score, an action is chosen"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Result to MTA"})," - Rspamd tells your mail server what to do"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"core-concepts-you-need-to-know",children:"Core Concepts You Need to Know"}),"\n",(0,r.jsx)(n.h3,{id:"1-modules---the-test-runners",children:"1. Modules - The Test Runners"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Modules"})," are units of code that analyze messages. Each module can run multiple tests."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Module"}),(0,r.jsx)(n.th,{children:"What It Checks"}),(0,r.jsx)(n.th,{children:"Example Symbol"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"SPF"})}),(0,r.jsx)(n.td,{children:"Sender IP authorization"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"R_SPF_FAIL"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"DKIM"})}),(0,r.jsx)(n.td,{children:"Digital signatures"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"R_DKIM_INVALID"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Bayesian"})}),(0,r.jsx)(n.td,{children:"Statistical analysis"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"BAYES_SPAM"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RBL"})}),(0,r.jsx)(n.td,{children:"DNS blacklists"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"MSBL_EBL"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Regexp"})}),(0,r.jsx)(n.td,{children:"Content patterns"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"FORGED_SENDER"})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"2-symbols---test-results",children:"2. Symbols - Test Results"}),"\n",(0,r.jsxs)(n.p,{children:["When a test matches, it produces a ",(0,r.jsx)(n.strong,{children:"symbol"})," - a short, descriptive name for what was detected."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FORGED_SENDER"})," - Envelope and header sender addresses differ"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"BAYES_SPAM"})," - Bayesian classifier thinks this is spam"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"R_DKIM_INVALID"})," - DKIM signature verification failed"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-scores---how-much-each-test-matters",children:"3. Scores - How Much Each Test Matters"}),"\n",(0,r.jsxs)(n.p,{children:["Each symbol has a ",(0,r.jsx)(n.strong,{children:"score"})," (weight) that contributes to the message's total spam score."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example scoring"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"FORGED_SENDER: +0.30    (slightly suspicious)\nBAYES_SPAM: +3.50      (strong spam indicator)  \nR_DKIM_INVALID: +0.10   (minor technical issue)\n                -------\nTotal Score: +3.90\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-actions---what-to-do-at-different-score-levels",children:"4. Actions - What to Do at Different Score Levels"}),"\n",(0,r.jsxs)(n.p,{children:["Based on the total score, Rspamd recommends an ",(0,r.jsx)(n.strong,{children:"action"}),":"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Action"}),(0,r.jsx)(n.th,{children:"Score Threshold"}),(0,r.jsx)(n.th,{children:"What Happens"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"No action"})}),(0,r.jsx)(n.td,{children:"< 4.0"}),(0,r.jsx)(n.td,{children:"Message passes through normally"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Greylist"})}),(0,r.jsx)(n.td,{children:"4.0 - 5.9"}),(0,r.jsx)(n.td,{children:"Temporarily delay (legitimate senders retry)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Add header"})}),(0,r.jsx)(n.td,{children:"6.0 - 14.9"}),(0,r.jsx)(n.td,{children:"Mark as spam but deliver to inbox/spam folder"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Reject"})}),(0,r.jsx)(n.td,{children:"15.0+"}),(0,r.jsx)(n.td,{children:"Refuse the message entirely"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"5-workers---different-processes-for-different-jobs",children:"5. Workers - Different Processes for Different Jobs"}),"\n",(0,r.jsxs)(n.p,{children:["Rspamd runs multiple ",(0,r.jsx)(n.strong,{children:"worker"})," processes, each handling specific tasks:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scanner"})," - Analyzes messages (the main worker)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Controller"})," - Provides web interface and API"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Proxy"})," - Handles MTA integration (milter protocol)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fuzzy Storage"})," - Manages fuzzy hashes for near-duplicate detection"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"what-can-you-configure-in-rspamd",children:"What Can You Configure in Rspamd?"}),"\n",(0,r.jsx)(n.p,{children:"Understanding what's configurable helps you focus your efforts where they matter most."}),"\n",(0,r.jsx)(n.h3,{id:"1-which-tests-to-run-modules",children:"1. Which Tests to Run (Modules)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": Enable/disable analysis modules\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Different environments need different tests\n",(0,r.jsx)(n.strong,{children:"Example"}),": Disable antivirus scanning if you have a separate antivirus system"]}),"\n",(0,r.jsx)(n.h3,{id:"2-test-sensitivity-module-settings",children:"2. Test Sensitivity (Module Settings)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": Fine-tune how modules behave\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Adapt to your specific email patterns\n",(0,r.jsx)(n.strong,{children:"Example"}),": Adjust Bayesian classifier learning rates"]}),"\n",(0,r.jsx)(n.h3,{id:"3-symbol-weights-scores",children:"3. Symbol Weights (Scores)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": How much each symbol contributes to the total score\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Balance false positives vs. spam catch rate\n",(0,r.jsx)(n.strong,{children:"Example"}),": Increase weight of ",(0,r.jsx)(n.code,{children:"FORGED_SENDER"})," if sender forgery is common"]}),"\n",(0,r.jsx)(n.h3,{id:"4-action-thresholds",children:"4. Action Thresholds"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": Score levels that trigger different actions\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Match your organization's spam tolerance\n",(0,r.jsx)(n.strong,{children:"Example"}),": Lower rejection threshold for high-security environments"]}),"\n",(0,r.jsx)(n.h3,{id:"5-worker-configuration",children:"5. Worker Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": How Rspamd processes operate\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Performance optimization and integration requirements\n",(0,r.jsx)(n.strong,{children:"Example"}),": Configure proxy worker for Postfix milter integration"]}),"\n",(0,r.jsx)(n.h3,{id:"6-system-behavior-general-options",children:"6. System Behavior (General Options)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What"}),": Timeouts, DNS settings, logging levels\n",(0,r.jsx)(n.strong,{children:"Why configure"}),": Adapt to your infrastructure and debugging needs\n",(0,r.jsx)(n.strong,{children:"Example"}),": Set DNS timeout for slow networks"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-mental-model",children:"Configuration Mental Model"}),"\n",(0,r.jsx)(n.p,{children:"Think of Rspamd configuration in layers:"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph TB\n    A[System Layer] --\x3e B[Worker Layer]\n    B --\x3e C[Module Layer]\n    C --\x3e D[Scoring Layer]\n    D --\x3e E[Action Layer]\n    \n    A1[DNS settings, timeouts] -.-> A\n    B1[Process types, ports] -.-> B\n    C1[Which tests to run] -.-> C\n    D1[Symbol weights] -.-> D\n    E1[Score thresholds] -.-> E"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Configuration Priority"})," (most common to least):"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action thresholds"})," - Almost everyone adjusts these"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Symbol scores"})," - Fine-tuning for your environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Module settings"})," - Specific feature configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Worker settings"})," - Integration and performance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"System options"})," - Usually only for special requirements"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-configuration-patterns",children:"Common Configuration Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"the-quick-start-pattern",children:'The "Quick Start" Pattern'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Adjust action thresholds only"}),"\n",(0,r.jsx)(n.li,{children:"Use default modules and scores"}),"\n",(0,r.jsx)(n.li,{children:"Focus on MTA integration"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best for"}),": Getting started, small deployments"]}),"\n",(0,r.jsx)(n.h3,{id:"the-tuned-environment-pattern",children:'The "Tuned Environment" Pattern'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Customize symbol scores based on testing"}),"\n",(0,r.jsx)(n.li,{children:"Enable/disable specific modules"}),"\n",(0,r.jsx)(n.li,{children:"Adjust learning and feedback mechanisms"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best for"}),": Production deployments, specific requirements"]}),"\n",(0,r.jsx)(n.h3,{id:"the-high-performance-pattern",children:'The "High Performance" Pattern'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Optimize worker configuration"}),"\n",(0,r.jsx)(n.li,{children:"Disable unnecessary modules"}),"\n",(0,r.jsx)(n.li,{children:"Fine-tune system timeouts"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best for"}),": High-volume email processing"]}),"\n",(0,r.jsx)(n.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,r.jsx)(n.p,{children:"Now that you understand Rspamd's architecture and configuration model:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/getting-started/installation",children:"Choose your installation method"})})," based on your scenario"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/getting-started/first-setup",children:"Complete the first success experience"})})," to get working spam filtering"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/configuration/fundamentals",children:"Learn configuration fundamentals"})})," to customize for your needs"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Rspamd analyzes emails and produces scores"})," that determine actions\n\u2705 ",(0,r.jsx)(n.strong,{children:"Modules run tests"})," that produce symbols with associated scores",(0,r.jsx)(n.br,{}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"You primarily configure"})," which tests to run, their weights, and action thresholds\n\u2705 ",(0,r.jsx)(n.strong,{children:"Start simple"})," with action thresholds, then customize based on your needs\n\u2705 ",(0,r.jsx)(n.strong,{children:"Different scenarios"})," require different configuration approaches"]}),"\n",(0,r.jsx)(n.p,{children:"Understanding these fundamentals will make the rest of your Rspamd journey much smoother!"})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);