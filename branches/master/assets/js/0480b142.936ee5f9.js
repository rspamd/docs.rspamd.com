"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[8070],{7208(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"faq","title":"Frequently Asked Questions","description":"This FAQ covers common questions about Rspamd installation, configuration, and operation. For detailed guides, see the documentation index.","source":"@site/docs/faq.md","sourceDirName":".","slug":"/faq","permalink":"/docs.rspamd.com/branches/master/faq","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/faq.md","tags":[],"version":"current","frontMatter":{"title":"Frequently Asked Questions"},"sidebar":"docs","previous":{"title":"ClickHouse Analytics Platform","permalink":"/docs.rspamd.com/branches/master/tutorials/clickhouse_analytics"},"next":{"title":"Rspamd Support","permalink":"/docs.rspamd.com/branches/master/support"}}');var i=s(4848),d=s(8453);const l={title:"Frequently Asked Questions"},a="Frequently Asked Questions",c={},o=[{value:"Quick Navigation",id:"quick-navigation",level:2},{value:"Getting Help",id:"getting-help",level:2},{value:"Where can I get help with Rspamd?",id:"where-can-i-get-help-with-rspamd",level:3},{value:"How do I report bugs?",id:"how-do-i-report-bugs",level:3},{value:"How is &quot;Rspamd&quot; spelled?",id:"how-is-rspamd-spelled",level:3},{value:"Installation",id:"installation",level:2},{value:"What versions are supported?",id:"what-versions-are-supported",level:3},{value:"Should I use experimental packages?",id:"should-i-use-experimental-packages",level:3},{value:"How are official packages built?",id:"how-are-official-packages-built",level:3},{value:"Initial Setup",id:"initial-setup",level:2},{value:"How do I configure DNS resolution?",id:"how-do-i-configure-dns-resolution",level:3},{value:"Configuration",id:"configuration",level:2},{value:"How do I view my current configuration?",id:"how-do-i-view-my-current-configuration",level:3},{value:"What are the configuration directories?",id:"what-are-the-configuration-directories",level:3},{value:"What is the difference between local.d and override.d?",id:"what-is-the-difference-between-locald-and-overrided",level:3},{value:"Why isn&#39;t my configuration working?",id:"why-isnt-my-configuration-working",level:3},{value:"How do I change a symbol&#39;s score?",id:"how-do-i-change-a-symbols-score",level:3},{value:"How do I list enabled plugins?",id:"how-do-i-list-enabled-plugins",level:3},{value:"How do I disable a module?",id:"how-do-i-disable-a-module",level:3},{value:"How do I disable a specific rule?",id:"how-do-i-disable-a-specific-rule",level:3},{value:"Scores and Actions",id:"scores-and-actions",level:2},{value:"What actions does Rspamd support?",id:"what-actions-does-rspamd-support",level:3},{value:"Why is my score zero but the message is rejected?",id:"why-is-my-score-zero-but-the-message-is-rejected",level:3},{value:"Why do I get different scores for the same message?",id:"why-do-i-get-different-scores-for-the-same-message",level:3},{value:"Why do some symbols have variable scores?",id:"why-do-some-symbols-have-variable-scores",level:3},{value:"Modules",id:"modules",level:2},{value:"How do I whitelist senders or skip checks?",id:"how-do-i-whitelist-senders-or-skip-checks",level:3},{value:"How do I blacklist file extensions?",id:"how-do-i-blacklist-file-extensions",level:3},{value:"What does URIBL_BLOCKED mean?",id:"what-does-uribl_blocked-mean",level:3},{value:"Why do I see &quot;monitored&quot; errors?",id:"why-do-i-see-monitored-errors",level:3},{value:"Why aren&#39;t fuzzy checks working?",id:"why-arent-fuzzy-checks-working",level:3},{value:"Statistics and Learning",id:"statistics-and-learning",level:2},{value:"Which backend should I use for statistics?",id:"which-backend-should-i-use-for-statistics",level:3},{value:"How do I train the Bayes classifier?",id:"how-do-i-train-the-bayes-classifier",level:3},{value:"Can I retrain messages for fuzzy storage?",id:"can-i-retrain-messages-for-fuzzy-storage",level:3},{value:"What does &quot;inv_chi_square: exp overflow&quot; mean?",id:"what-does-inv_chi_square-exp-overflow-mean",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"How do I debug a module?",id:"how-do-i-debug-a-module",level:3},{value:"How do I get a core dump after a crash?",id:"how-do-i-get-a-core-dump-after-a-crash",level:3},{value:"How do I use ASAN packages for debugging?",id:"how-do-i-use-asan-packages-for-debugging",level:3},{value:"How do I analyze a core file?",id:"how-do-i-analyze-a-core-file",level:3},{value:"How do I limit core file disk usage?",id:"how-do-i-limit-core-file-disk-usage",level:3},{value:"Administration",id:"administration",level:2},{value:"How do I read Rspamd logs?",id:"how-do-i-read-rspamd-logs",level:3},{value:"How do I customize log format?",id:"how-do-i-customize-log-format",level:3},{value:"What Redis keys does Rspamd use?",id:"what-redis-keys-does-rspamd-use",level:3},{value:"How do I delete Redis keys by pattern?",id:"how-do-i-delete-redis-keys-by-pattern",level:3},{value:"How do I use Unix sockets with Redis?",id:"how-do-i-use-unix-sockets-with-redis",level:3},{value:"What should I back up?",id:"what-should-i-back-up",level:3},{value:"Why do I get errors after migrating to different hardware?",id:"why-do-i-get-errors-after-migrating-to-different-hardware",level:3},{value:"Web Interface",id:"web-interface",level:2},{value:"What are the password types?",id:"what-are-the-password-types",level:3},{value:"How do I create a secure password?",id:"how-do-i-create-a-secure-password",level:3},{value:"How do I run the WebUI behind a proxy?",id:"how-do-i-run-the-webui-behind-a-proxy",level:3},{value:"Where does the WebUI store settings?",id:"where-does-the-webui-store-settings",level:3},{value:"Why can&#39;t I edit some maps in WebUI?",id:"why-cant-i-edit-some-maps-in-webui",level:3},{value:"How do I set up WebUI clustering?",id:"how-do-i-set-up-webui-clustering",level:3},{value:"Why does the User column show &quot;undefined&quot;?",id:"why-does-the-user-column-show-undefined",level:3},{value:"MTA Integration",id:"mta-integration",level:2},{value:"How do I distinguish inbound from outbound mail?",id:"how-do-i-distinguish-inbound-from-outbound-mail",level:3},{value:"Can I scan outbound mail safely?",id:"can-i-scan-outbound-mail-safely",level:3},{value:"Can I use Rspamd only for DKIM signing?",id:"can-i-use-rspamd-only-for-dkim-signing",level:3},{value:"Lua Development",id:"lua-development",level:2},{value:"What&#39;s the difference between plugins and rules?",id:"whats-the-difference-between-plugins-and-rules",level:3},{value:"What is the table form of function calls?",id:"what-is-the-table-form-of-function-calls",level:3},{value:"How do I use Rspamd modules in Lua?",id:"how-do-i-use-rspamd-modules-in-lua",level:3},{value:"How do I log from Lua?",id:"how-do-i-log-from-lua",level:3},{value:"Should I use <code>local</code> for variables?",id:"should-i-use-local-for-variables",level:3},{value:"How do I create regexps safely?",id:"how-do-i-create-regexps-safely",level:3},{value:"Quick Reference",id:"quick-reference",level:2},{value:"Common Commands",id:"common-commands",level:3},{value:"Common Paths",id:"common-paths",level:3},{value:"What are rspamc and rspamadm?",id:"what-are-rspamc-and-rspamadm",level:3}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"frequently-asked-questions",children:"Frequently Asked Questions"})}),"\n",(0,i.jsxs)(n.p,{children:["This FAQ covers common questions about Rspamd installation, configuration, and operation. For detailed guides, see the ",(0,i.jsx)(n.a,{href:"/",children:"documentation index"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"quick-navigation",children:"Quick Navigation"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Topic"}),(0,i.jsx)(n.th,{children:"Questions"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#getting-help",children:"Getting Help"})}),(0,i.jsx)(n.td,{children:"Support channels, bug reports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#installation",children:"Installation"})}),(0,i.jsx)(n.td,{children:"Versions, packages, builds"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#initial-setup",children:"Initial Setup"})}),(0,i.jsx)(n.td,{children:"DNS resolver, first configuration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#configuration",children:"Configuration"})}),(0,i.jsx)(n.td,{children:"File structure, changing settings, paths"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#scores-and-actions",children:"Scores & Actions"})}),(0,i.jsx)(n.td,{children:"How scoring works, actions, thresholds"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#modules",children:"Modules"})}),(0,i.jsx)(n.td,{children:"Enabling/disabling, whitelisting, DNSBL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#statistics-and-learning",children:"Statistics & Learning"})}),(0,i.jsx)(n.td,{children:"Bayes, fuzzy hashes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#troubleshooting",children:"Troubleshooting"})}),(0,i.jsx)(n.td,{children:"Crashes, debugging, core dumps"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#administration",children:"Administration"})}),(0,i.jsx)(n.td,{children:"Logs, Redis, backups"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#web-interface",children:"Web Interface"})}),(0,i.jsx)(n.td,{children:"Passwords, proxy setup, cluster"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#mta-integration",children:"MTA Integration"})}),(0,i.jsx)(n.td,{children:"Inbound vs outbound, milter"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#lua-development",children:"Lua Development"})}),(0,i.jsx)(n.td,{children:"Writing rules, API usage"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,i.jsx)(n.h3,{id:"where-can-i-get-help-with-rspamd",children:"Where can I get help with Rspamd?"}),"\n",(0,i.jsx)(n.p,{children:"The primary support channels are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://lists.rspamd.com/",children:"Mailing list"})})," \u2014 For detailed questions and discussions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://t.me/rspamd",children:"Telegram group"})})," \u2014 Real-time chat support"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/rspamd/rspamd/issues",children:"GitHub Issues"})})," \u2014 Bug reports and feature requests"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"/support",children:"support page"})," for all available resources."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-report-bugs",children:"How do I report bugs?"}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.strong,{children:"crashes"}),": Obtain a core file and ASAN log (see ",(0,i.jsx)(n.a,{href:"#troubleshooting",children:"Troubleshooting"}),") before reporting."]}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.strong,{children:"rule issues"}),": Include a ",(0,i.jsx)(n.strong,{children:"message sample"})," that triggers the problem. You may redact irrelevant headers and content, but:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"For SPF issues: Include SMTP From (or HELO) and sender IP"}),"\n",(0,i.jsx)(n.li,{children:"For DKIM/ARC/statistics: Preserve all headers and content"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Bug reports without message samples will not be considered unless the bug is trivial or includes a patch."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Where to report:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Rspamd core issues: ",(0,i.jsx)(n.a,{href:"https://github.com/rspamd/rspamd/issues",children:"rspamd/rspamd"})]}),"\n",(0,i.jsxs)(n.li,{children:["Documentation issues: ",(0,i.jsx)(n.a,{href:"https://github.com/rspamd/rspamd.com/issues",children:"rspamd/rspamd.com"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"We prefer patches/pull requests over plain bug reports."}),"\n",(0,i.jsx)(n.h3,{id:"how-is-rspamd-spelled",children:'How is "Rspamd" spelled?'}),"\n",(0,i.jsxs)(n.p,{children:['"Rspamd" as a project is capitalized. The process/binary name ',(0,i.jsx)(n.code,{children:"rspamd"})," is lowercase."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.h3,{id:"what-versions-are-supported",children:"What versions are supported?"}),"\n",(0,i.jsx)(n.p,{children:"Rspamd maintains two branches:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stable branch"})," (",(0,i.jsx)(n.code,{children:"rspamd-<version>"}),") \u2014 Recommended for production"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Development branch"})," (",(0,i.jsx)(n.code,{children:"master"}),") \u2014 Latest features, may have regressions"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"When a new major release becomes stable, support for the previous stable branch ends. We do not support old releases."}),"\n",(0,i.jsx)(n.h3,{id:"should-i-use-experimental-packages",children:"Should I use experimental packages?"}),"\n",(0,i.jsxs)(n.p,{children:["Experimental packages are built from ",(0,i.jsx)(n.code,{children:"master"})," and lack detailed changelogs. They include a git hash for tracking changes:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git log <old_hash>..<new_hash>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Consider experimental packages when:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You have a significant bug that's fixed in ",(0,i.jsx)(n.code,{children:"master"})]}),"\n",(0,i.jsx)(n.li,{children:"You're running a small system where you can manually downgrade if needed"}),"\n",(0,i.jsxs)(n.li,{children:["You can test using ",(0,i.jsx)(n.a,{href:"/workers/rspamd_proxy",children:"proxy mirroring"})," without affecting production"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"how-are-official-packages-built",children:"How are official packages built?"}),"\n",(0,i.jsx)(n.p,{children:"Official packages from rspamd.com include these optimizations:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Benefit"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Link Time Optimization (LTO)"}),(0,i.jsx)(n.td,{children:"Better performance"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Bundled LuaJIT 2.1 beta"}),(0,i.jsx)(n.td,{children:"Up to 30% faster than stable LuaJIT"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"jemalloc"}),(0,i.jsx)(n.td,{children:"Optimized memory allocation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Hyperscan/Vectorscan"}),(0,i.jsx)(n.td,{children:"Fast regex matching"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Debug symbols are available in separate packages (",(0,i.jsx)(n.code,{children:"rspamd-dbg"})," for DEB, ",(0,i.jsx)(n.code,{children:"rspamd-debuginfo"})," for RPM)."]}),"\n",(0,i.jsxs)(n.p,{children:["For package installation, see the ",(0,i.jsx)(n.a,{href:"/downloads",children:"Downloads page"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"initial-setup",children:"Initial Setup"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-configure-dns-resolution",children:"How do I configure DNS resolution?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"This is critical."})," DNS is essential for spam filtering (RBLs, DKIM, SPF, etc.). Poor DNS configuration can make Rspamd non-functional."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Use a ",(0,i.jsx)(n.strong,{children:"local recursive resolver"})," (Unbound recommended)"]}),"\n",(0,i.jsx)(n.li,{children:"Do not rely on public DNS (Google, Cloudflare) \u2014 they rate-limit RBL queries"}),"\n",(0,i.jsx)(n.li,{children:"Your ISP's resolver may return incorrect results (browser redirects instead of NXDOMAIN)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'# /etc/rspamd/local.d/options.inc\ndns {\n  nameserver = ["127.0.0.1"];\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"With fallback:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'dns {\n  nameserver = "master-slave:127.0.0.1,8.8.8.8";\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"For large-scale deployments with multiple resolvers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'dns {\n  nameserver = "hash:10.0.0.1,10.1.0.1,10.3.0.1";\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," Rspamd does not use system resolver libraries. Changes require restart. The ",(0,i.jsx)(n.code,{children:"/etc/hosts"})," file is not read."]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"https://wiki.archlinux.org/index.php/unbound",children:"Unbound setup guide"})," for resolver installation."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-view-my-current-configuration",children:"How do I view my current configuration?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm configdump          # Full configuration\nrspamadm configdump -j       # JSON format\nrspamadm configdump -c       # Preserve comments\nrspamadm configdump multimap # Specific section\nrspamadm configdump worker   # Worker configuration\n"})}),"\n",(0,i.jsx)(n.h3,{id:"what-are-the-configuration-directories",children:"What are the configuration directories?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CONFDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/rspamd"})}),(0,i.jsx)(n.td,{children:"Main configuration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LOCAL_CONFDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/rspamd"})}),(0,i.jsx)(n.td,{children:"User configuration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DBDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/var/lib/rspamd"})}),(0,i.jsx)(n.td,{children:"Runtime data (statistics, caches)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RUNDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/var/run/rspamd"})}),(0,i.jsx)(n.td,{children:"PID files"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LOGDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/var/log/rspamd"})}),(0,i.jsx)(n.td,{children:"Log files"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"SHAREDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/usr/share/rspamd"})}),(0,i.jsx)(n.td,{children:"Shared files"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PLUGINSDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"${SHAREDIR}/plugins"})}),(0,i.jsx)(n.td,{children:"Lua plugins"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LUALIBDIR"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"${SHAREDIR}/lualib"})}),(0,i.jsx)(n.td,{children:"Shared Lua libraries"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"what-is-the-difference-between-locald-and-overrided",children:"What is the difference between local.d and override.d?"}),"\n",(0,i.jsx)(n.p,{children:"Both directories extend default configuration without editing core files:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Directory"}),(0,i.jsx)(n.th,{children:"Priority"}),(0,i.jsx)(n.th,{children:"Behavior"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"local.d/"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Merges"})," with defaults. Collections and lists are combined."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"override.d/"})}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Replaces"})," defaults. Entire sections are overwritten."]})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example \u2014 Original config:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'example {\n  option1 = "value";\n  option2 = true;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"local.d/example.conf:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"option2 = false;\noption3 = 1.0;\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Result with local.d:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'example {\n  option1 = "value";   # From default\n  option2 = false;     # From local.d\n  option3 = 1.0;       # From local.d\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Result with override.d:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"example {\n  option2 = false;     # Only override.d content\n  option3 = 1.0;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"why-isnt-my-configuration-working",children:"Why isn't my configuration working?"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common mistake \u2014 Extra nesting:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"# WRONG - local.d/dkim_signing.conf\ndkim_signing {    # Don't add this wrapper!\n  domain { ... }\n}\n\n# CORRECT - local.d/dkim_signing.conf\ndomain { ... }\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Rspamd reports nesting issues in logs and via ",(0,i.jsx)(n.code,{children:"rspamadm configtest"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-change-a-symbols-score",children:"How do I change a symbol's score?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"If using WebUI:"})," The WebUI stores scores in ",(0,i.jsx)(n.code,{children:"$DBDIR/rspamd_dynamic"}),". These take precedence over config files. Edit or remove this file to use config-based scores."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Via configuration:"})," Edit ",(0,i.jsx)(n.code,{children:"local.d/groups.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'symbols {\n  "SOME_SYMBOL" {\n    weight = 1.0;\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Or for a specific group (e.g., ",(0,i.jsx)(n.code,{children:"local.d/rbl_group.conf"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'symbols {\n  "RBL_CUSTOM" {\n    weight = 5.0;\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Verify with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm configdump -g        # Show all groups and scores\nrspamadm configdump -g -j | jq  # JSON for processing\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-list-enabled-plugins",children:"How do I list enabled plugins?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm configdump -m        # List modules with status\nrspamadm configwizard         # Interactive configuration\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-disable-a-module",children:"How do I disable a module?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"# local.d/modulename.conf\nenabled = false;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-disable-a-specific-rule",children:"How do I disable a specific rule?"}),"\n",(0,i.jsxs)(n.p,{children:["Add a condition in ",(0,i.jsx)(n.code,{children:"/etc/rspamd/rspamd.local.lua"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"rspamd_config:add_condition('SOME_SYMBOL', function(task) return false end)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Or use ",(0,i.jsx)(n.a,{href:"/configuration/settings",children:"settings"})," for dynamic control."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"scores-and-actions",children:"Scores and Actions"}),"\n",(0,i.jsx)(n.h3,{id:"what-actions-does-rspamd-support",children:"What actions does Rspamd support?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Action"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"no action"})}),(0,i.jsx)(n.td,{children:"Message passes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"add header"})}),(0,i.jsx)(n.td,{children:"Add spam headers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rewrite subject"})}),(0,i.jsx)(n.td,{children:"Modify subject line"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"soft reject"})}),(0,i.jsx)(n.td,{children:"Temporary rejection (greylisting, ratelimit)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"reject"})}),(0,i.jsx)(n.td,{children:"Permanent rejection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"quarantine"})}),(0,i.jsx)(n.td,{children:"Move to quarantine (requires MTA support)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"discard"})}),(0,i.jsx)(n.td,{children:"Silently drop message"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Configure thresholds in ",(0,i.jsx)(n.code,{children:"local.d/actions.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"reject = 15;\nadd_header = 6;\ngreylist = 4;\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," Always use the ",(0,i.jsx)(n.strong,{children:"action"}),", not the score, to decide message handling. Some modules set actions directly regardless of score."]}),"\n",(0,i.jsx)(n.h3,{id:"why-is-my-score-zero-but-the-message-is-rejected",children:"Why is my score zero but the message is rejected?"}),"\n",(0,i.jsxs)(n.p,{children:["Some modules set ",(0,i.jsx)(n.strong,{children:"passthrough actions"})," that bypass scoring:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"greylist"})," \u2014 Sets ",(0,i.jsx)(n.code,{children:"soft reject"})," for greylisting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ratelimit"})," \u2014 Sets ",(0,i.jsx)(n.code,{children:"soft reject"})," when limit reached"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"antivirus"})," \u2014 Can set actions for virus detection"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"multimap"})," \u2014 Sets actions for matched maps"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"force_actions"})," \u2014 Explicit passthrough actions"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Check logs for ",(0,i.jsx)(n.code,{children:"forced:"})," entries explaining the action."]}),"\n",(0,i.jsx)(n.h3,{id:"why-do-i-get-different-scores-for-the-same-message",children:"Why do I get different scores for the same message?"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Early rejection:"})," Once a message hits ",(0,i.jsx)(n.code,{children:"reject"})," threshold, some checks stop to save resources. Use ",(0,i.jsx)(n.code,{children:"Pass: all"})," header (or ",(0,i.jsx)(n.code,{children:"rspamc -p"}),") to force all checks."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Timeouts:"})," Async rules may not complete before task timeout. Check:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm confighelp options.dns\nrspamadm confighelp workers.normal.task_timeout\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"why-do-some-symbols-have-variable-scores",children:"Why do some symbols have variable scores?"}),"\n",(0,i.jsxs)(n.p,{children:["Rspamd supports ",(0,i.jsx)(n.strong,{children:"dynamic scoring"}),". The symbol score is multiplied by a confidence factor (0-1):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bayes: Score scales with probability (50% \u2192 ~0, 90% \u2192 ~0.95, 100% \u2192 1.0)"}),"\n",(0,i.jsx)(n.li,{children:"Fuzzy: Score scales with match weight"}),"\n",(0,i.jsx)(n.li,{children:"Phishing: Score varies by confidence"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"modules",children:"Modules"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-whitelist-senders-or-skip-checks",children:"How do I whitelist senders or skip checks?"}),"\n",(0,i.jsx)(n.p,{children:"Several options:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/modules/whitelist",children:"Whitelist module"})})," \u2014 For SPF/DKIM/DMARC-based whitelisting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/modules/multimap",children:"Multimap module"})})," \u2014 Flexible list-based checks and actions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/configuration/settings",children:"Settings"})})," \u2014 Disable rules for specific conditions:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'# rspamd.conf.local\nsettings {\n  whitelist_authenticated {\n    authenticated = true;\n    apply {\n      symbols_enabled = ["DKIM_SIGNED", "ARC_SIGNED"];\n      flags = ["skip_process"];\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-blacklist-file-extensions",children:"How do I blacklist file extensions?"}),"\n",(0,i.jsxs)(n.p,{children:["Using multimap in ",(0,i.jsx)(n.code,{children:"local.d/multimap.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'file_extension_blacklist {\n  type = "filename";\n  filter = "extension";\n  map = "${LOCAL_CONFDIR}/local.d/blocked_extensions.map";\n  symbol = "BLOCKED_EXTENSION";\n  prefilter = true;\n  action = "reject";\n  message = "Attachment type not allowed";\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"what-does-uribl_blocked-mean",children:"What does URIBL_BLOCKED mean?"}),"\n",(0,i.jsx)(n.p,{children:"You've exceeded the free query limit for SURBL/URIBL services. This happens when:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Using public DNS (Google, Cloudflare) \u2014 they aggregate queries and hit limits"}),"\n",(0,i.jsx)(n.li,{children:"High mail volume exceeding free tier"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use a local recursive resolver"}),"\n",(0,i.jsxs)(n.li,{children:["Purchase a ",(0,i.jsx)(n.a,{href:"http://www.surbl.org/df",children:"commercial subscription"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The symbol has zero weight and doesn't affect scoring."}),"\n",(0,i.jsx)(n.h3,{id:"why-do-i-see-monitored-errors",children:'Why do I see "monitored" errors?'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"DNS reply returned 'no error' for multi.uribl.com while 'no records with this name' was expected\n"})}),"\n",(0,i.jsx)(n.p,{children:"Rspamd monitors DNS lists by querying addresses that should return NXDOMAIN. Errors indicate:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rate limiting"})," \u2014 You're using public DNS or exceeded free limits"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Broken RBL"})," \u2014 The list is returning false positives"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DNS hijacking"})," \u2014 Your resolver returns redirects instead of NXDOMAIN"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"why-arent-fuzzy-checks-working",children:"Why aren't fuzzy checks working?"}),"\n",(0,i.jsxs)(n.p,{children:["Fuzzy storage uses ",(0,i.jsx)(n.strong,{children:"UDP port 1335"})," (not TCP, not TLS)."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm fuzzyping   # Test connectivity\n"})}),"\n",(0,i.jsx)(n.p,{children:"If you see packet loss, check your firewall allows outbound UDP to port 1335."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"statistics-and-learning",children:"Statistics and Learning"}),"\n",(0,i.jsx)(n.h3,{id:"which-backend-should-i-use-for-statistics",children:"Which backend should I use for statistics?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Redis is recommended"})," for both statistics and fuzzy storage."]}),"\n",(0,i.jsx)(n.p,{children:"Convert from SQLite:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm statconvert \\\n  --spam-db /var/lib/rspamd/bayes.spam.sqlite \\\n  --ham-db /var/lib/rspamd/bayes.ham.sqlite \\\n  --symbol-spam BAYES_SPAM \\\n  --symbol-ham BAYES_HAM \\\n  -h localhost\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Configure in ",(0,i.jsx)(n.code,{children:"local.d/classifier-bayes.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'backend = "redis";\n'})}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/configuration/statistic",children:"Statistics configuration"})," for details."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-train-the-bayes-classifier",children:"How do I train the Bayes classifier?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamc learn_spam message.eml   # Train as spam\nrspamc learn_ham message.eml    # Train as ham\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Requires ",(0,i.jsx)(n.code,{children:"enable"})," level access (check ",(0,i.jsx)(n.code,{children:"enable_password"})," or ",(0,i.jsx)(n.code,{children:"secure_ip"}),")."]}),"\n",(0,i.jsxs)(n.p,{children:["For automatic learning, see ",(0,i.jsx)(n.a,{href:"/configuration/statistic#autolearning",children:"Autolearning documentation"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"can-i-retrain-messages-for-fuzzy-storage",children:"Can I retrain messages for fuzzy storage?"}),"\n",(0,i.jsx)(n.p,{children:"To move a hash between lists:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamc -f 1 fuzzy_del message.eml    # Remove from list 1\nrspamc -f 2 -w 10 fuzzy_add message.eml  # Add to list 2\n"})}),"\n",(0,i.jsx)(n.p,{children:"For statistics, Rspamd handles relearning automatically via the learn cache."}),"\n",(0,i.jsx)(n.h3,{id:"what-does-inv_chi_square-exp-overflow-mean",children:'What does "inv_chi_square: exp overflow" mean?'}),"\n",(0,i.jsx)(n.p,{children:"One statistics class is overloaded while the other is underlearned. Train more messages from both spam and ham classes to balance the classifier."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-debug-a-module",children:"How do I debug a module?"}),"\n",(0,i.jsxs)(n.p,{children:["Enable debug logging in ",(0,i.jsx)(n.code,{children:"local.d/logging.inc"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'debug_modules = ["module_name"];\n'})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-get-a-core-dump-after-a-crash",children:"How do I get a core dump after a crash?"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"1. Create core directory:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir /coreland\nchmod 1777 /coreland\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"2. Configure core pattern:"})}),"\n",(0,i.jsx)(n.p,{children:"Linux:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sysctl kernel.core_pattern=/coreland/%e-%p.core\nsysctl kernel.core_uses_pid=1\nsysctl fs.suid_dumpable=2\n"})}),"\n",(0,i.jsx)(n.p,{children:"FreeBSD:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sysctl kern.corefile=/coreland/%N-%P.core\nsysctl kern.sugid_coredump=1\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"3. Enable systemd core dumps"})," (if applicable):"]}),"\n",(0,i.jsxs)(n.p,{children:["Edit ",(0,i.jsx)(n.code,{children:"/etc/systemd/system.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"DefaultLimitCORE=infinity\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl daemon-reexec\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"4. Install debug symbols:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["DEB: ",(0,i.jsx)(n.code,{children:"apt install rspamd-dbg"})]}),"\n",(0,i.jsxs)(n.li,{children:["RPM: ",(0,i.jsx)(n.code,{children:"dnf install rspamd-debuginfo"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"5. Test setup:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kill -s 4 $(pgrep rspamd | head -1)  # Send SIGILL\nls /coreland/  # Check for core file\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-use-asan-packages-for-debugging",children:"How do I use ASAN packages for debugging?"}),"\n",(0,i.jsxs)(n.p,{children:["ASAN (AddressSanitizer) packages detect memory errors. Install ",(0,i.jsx)(n.code,{children:"rspamd-asan"})," instead of ",(0,i.jsx)(n.code,{children:"rspamd"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Configure ASAN logging:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'export ASAN_OPTIONS="log_path=/tmp/rspamd-asan"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Or in systemd (",(0,i.jsx)(n.code,{children:"systemctl edit rspamd"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'[Service]\nEnvironment="ASAN_OPTIONS=log_path=/tmp/rspamd-asan"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["After a crash, collect both core file and ",(0,i.jsx)(n.code,{children:"/tmp/rspamd-asan.<pid>"})," for bug reports."]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/downloads#asan-packages",children:"Downloads page"})," for more details."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-analyze-a-core-file",children:"How do I analyze a core file?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gdb $(which rspamd) -c /coreland/rspamd.core\n(gdb) bt full\n\n# Or with lldb\nlldb $(which rspamd) -c /coreland/rspamd.core\n(lldb) bt all\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-limit-core-file-disk-usage",children:"How do I limit core file disk usage?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'# local.d/options.inc\ncores_dir = "/coreland/";\nmax_cores_size = 1G;\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"administration",children:"Administration"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-read-rspamd-logs",children:"How do I read Rspamd logs?"}),"\n",(0,i.jsxs)(n.p,{children:["Logs include a ",(0,i.jsx)(n.strong,{children:"tag"})," (e.g., ",(0,i.jsx)(n.code,{children:"<b120f6>"}),") linking related entries:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"grep 'b120f6' /var/log/rspamd/rspamd.log\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The final ",(0,i.jsx)(n.code,{children:"rspamd_task_write_log"})," line shows the complete result."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-customize-log-format",children:"How do I customize log format?"}),"\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.code,{children:"local.d/logging.inc"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:"log_format =<<EOD\nid: <$mid>, ip: [$ip], from: <$smtp_from>, (default: $is_spam ($action): [$scores] [$symbols_scores]), len: $len, time: $time_real\nEOD\n"})}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/configuration/logging",children:"Logging documentation"})," for all variables."]}),"\n",(0,i.jsx)(n.h3,{id:"what-redis-keys-does-rspamd-use",children:"What Redis keys does Rspamd use?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Module"}),(0,i.jsx)(n.th,{children:"Key Pattern"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Statistics"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"<SYMBOL><username>"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Ratelimit"}),(0,i.jsxs)(n.td,{children:["Per-limit keys (see ",(0,i.jsx)(n.a,{href:"/modules/ratelimit",children:"ratelimit docs"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DMARC"}),(0,i.jsx)(n.td,{children:"Per-domain aggregation keys"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Reputation"}),(0,i.jsx)(n.td,{children:"IP/domain reputation keys"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Set ",(0,i.jsx)(n.code,{children:"maxmemory"})," limits and consider separate Redis instances for different data types."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-delete-redis-keys-by-pattern",children:"How do I delete Redis keys by pattern?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"redis-cli --scan --pattern 'rn_SHORT_*' | xargs redis-cli unlink\n"})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-use-unix-sockets-with-redis",children:"How do I use Unix sockets with Redis?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Redis config"})," (",(0,i.jsx)(n.code,{children:"/etc/redis/rspamd.conf"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"bind 127.0.0.1\nport 0\nunixsocket /var/run/redis/rspamd.sock\nunixsocketperm 770\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Rspamd config"})," (",(0,i.jsx)(n.code,{children:"local.d/redis.conf"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'servers = "/var/run/redis/rspamd.sock";\n'})}),"\n",(0,i.jsx)(n.p,{children:"Add rspamd user to redis group:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"usermod -a -G redis _rspamd\n"})}),"\n",(0,i.jsx)(n.h3,{id:"what-should-i-back-up",children:"What should I back up?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Data"}),(0,i.jsx)(n.th,{children:"Location"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Configuration"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/rspamd/"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Runtime data"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/var/lib/rspamd/"})," (exclude ",(0,i.jsx)(n.code,{children:"*.hs"}),", ",(0,i.jsx)(n.code,{children:"*.hsmp"}),", ",(0,i.jsx)(n.code,{children:"*.map"})," caches)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Redis config"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/redis/redis.conf"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Redis data"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/var/lib/redis/dump.rdb"})," (safe to copy while running)"]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"why-do-i-get-errors-after-migrating-to-different-hardware",children:"Why do I get errors after migrating to different hardware?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hyperscan caches"})," are platform-specific. Delete ",(0,i.jsx)(n.code,{children:"*.hs"})," and ",(0,i.jsx)(n.code,{children:"*.hsmp"})," files from ",(0,i.jsx)(n.code,{children:"/var/lib/rspamd/"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"RRD files"})," cannot transfer between architectures. Export and reimport:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# On source system\nrrdtool dump rspamd.rrd > rspamd.rrd.xml\n\n# On target system\nrrdtool restore -f rspamd.rrd.xml rspamd.rrd\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"web-interface",children:"Web Interface"}),"\n",(0,i.jsx)(n.h3,{id:"what-are-the-password-types",children:"What are the password types?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"password"})}),(0,i.jsx)(n.td,{children:"Read-only access"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enable_password"})}),(0,i.jsx)(n.td,{children:"Full access (learning, configuration)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"secure_ip"})}),(0,i.jsx)(n.td,{children:"IPs with full access without password"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["If only ",(0,i.jsx)(n.code,{children:"password"})," is set, it grants full access."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-create-a-secure-password",children:"How do I create a secure password?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm pw\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This generates a PBKDF2/Catena hash. Add to ",(0,i.jsx)(n.code,{children:"local.d/worker-controller.inc"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'password = "$2$...generated_hash...";\nenable_password = "$2$...another_hash...";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-run-the-webui-behind-a-proxy",children:"How do I run the WebUI behind a proxy?"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Nginx:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:'location /rspamd/ {\n  proxy_pass http://localhost:11334/;\n  proxy_set_header Host $host;\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For "";\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Apache:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-apache",children:"RewriteRule ^/rspamd$ /rspamd/ [R,L]\nRewriteRule ^/rspamd/(.*) http://localhost:11334/$1 [P,L]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"where-does-the-webui-store-settings",children:"Where does the WebUI store settings?"}),"\n",(0,i.jsxs)(n.p,{children:["Dynamic settings go to ",(0,i.jsx)(n.code,{children:"$DBDIR/rspamd_dynamic"})," (typically ",(0,i.jsx)(n.code,{children:"/var/lib/rspamd/rspamd_dynamic"}),"). This file has priority 5, so ",(0,i.jsx)(n.code,{children:"override.d"})," (priority 10) can override it."]}),"\n",(0,i.jsx)(n.h3,{id:"why-cant-i-edit-some-maps-in-webui",children:"Why can't I edit some maps in WebUI?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"File must exist and be writable by rspamd user"}),"\n",(0,i.jsx)(n.li,{children:"HTTP maps cannot be edited"}),"\n",(0,i.jsx)(n.li,{children:"Signed maps cannot be edited"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-set-up-webui-clustering",children:"How do I set up WebUI clustering?"}),"\n",(0,i.jsxs)(n.p,{children:["Configure neighbors in ",(0,i.jsx)(n.code,{children:"local.d/options.inc"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'neighbours {\n  server1 {\n    host = "http://server1:11334";\n  }\n  server2 {\n    host = "http://server2:11334";\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/configuration/options#neighbours-list",children:"Options documentation"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"why-does-the-user-column-show-undefined",children:'Why does the User column show "undefined"?'}),"\n",(0,i.jsx)(n.p,{children:"The User column displays the authenticated username from outbound mail scanning. It's empty for inbound mail."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"mta-integration",children:"MTA Integration"}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-distinguish-inbound-from-outbound-mail",children:"How do I distinguish inbound from outbound mail?"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.a,{href:"/configuration/settings",children:"settings module"})," with ",(0,i.jsx)(n.code,{children:"settings-id"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'# Settings configuration\nsettings {\n  outbound {\n    id = "outbound";\n    apply {\n      actions {\n        reject = 150.0;\n        "add header" = 6.0;\n      }\n      groups_disabled = ["hfilter", "rbl"];\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Configure proxy to send the header:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'# Proxy configuration\nupstream "local" {\n  self_scan = yes;\n  settings_id = "outbound";\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Alternatively, use ",(0,i.jsx)(n.code,{children:"authenticated = true"})," or IP-based conditions in settings."]}),"\n",(0,i.jsx)(n.h3,{id:"can-i-scan-outbound-mail-safely",children:"Can I scan outbound mail safely?"}),"\n",(0,i.jsx)(n.p,{children:"Yes. Rspamd automatically applies safe defaults for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authenticated senders"}),"\n",(0,i.jsxs)(n.li,{children:["Senders from ",(0,i.jsx)(n.code,{children:"local_networks"})," (RFC 1918 addresses, loopback)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Many checks are disabled for outbound. Be careful not to accidentally trigger this mode (e.g., by not using XCLIENT on a proxy MTA)."}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/tutorials/scanning_outbound",children:"Scanning Outbound documentation"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"can-i-use-rspamd-only-for-dkim-signing",children:"Can I use Rspamd only for DKIM signing?"}),"\n",(0,i.jsx)(n.p,{children:"Yes, use settings to skip processing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'settings {\n  sign_only {\n    authenticated = true;\n    apply {\n      symbols_enabled = ["DKIM_SIGNED", "ARC_SIGNED"];\n      flags = ["skip_process"];\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"lua-development",children:"Lua Development"}),"\n",(0,i.jsx)(n.h3,{id:"whats-the-difference-between-plugins-and-rules",children:"What's the difference between plugins and rules?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Capabilities"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Rules"})}),(0,i.jsx)(n.td,{children:"Simple checks"}),(0,i.jsxs)(n.td,{children:["Return ",(0,i.jsx)(n.code,{children:"true"}),"/",(0,i.jsx)(n.code,{children:"false"}),", synchronous"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Plugins"})}),(0,i.jsx)(n.td,{children:"Complex logic"}),(0,i.jsxs)(n.td,{children:["Async requests, multiple symbols, ",(0,i.jsx)(n.code,{children:"task:insert_result()"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"rspamd_config:register_symbol"})," for plugins."]}),"\n",(0,i.jsx)(n.h3,{id:"what-is-the-table-form-of-function-calls",children:"What is the table form of function calls?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"-- Sequential form\nfunc(a, b, c, d)\n\n-- Table form (preferred for 3+ arguments)\nfunc({\n  param1 = a,\n  param2 = b,\n  param3 = c,\n  param4 = d\n})\n"})}),"\n",(0,i.jsx)(n.p,{children:"Table form is easier to read, extend, and maintain."}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-use-rspamd-modules-in-lua",children:"How do I use Rspamd modules in Lua?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"local rspamd_logger = require 'rspamd_logger'\nlocal rspamd_regexp = require 'rspamd_regexp'\n"})}),"\n",(0,i.jsx)(n.p,{children:"Additional libraries available:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/rtsisyk/luafun",children:"Lua Functional"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.inf.puc-rio.br/~roberto/lpeg/",children:"Lua LPEG"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-log-from-lua",children:"How do I log from Lua?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'local rspamd_logger = require \'rspamd_logger\'\n\n-- Modern format (recommended)\nrspamd_logger.infox(task, "Processing %s from %s", message_id, sender)\n\n-- Positional arguments\nrspamd_logger.infox("%s %1 %2", "abc", 1, {true, 1})\n-- Output: abc abc 1 [[1] = true, [2] = 1]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"rspamd_logger.slog"})," for string formatting without logging."]}),"\n",(0,i.jsxs)(n.h3,{id:"should-i-use-local-for-variables",children:["Should I use ",(0,i.jsx)(n.code,{children:"local"})," for variables?"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Always use ",(0,i.jsx)(n.code,{children:"local"})]})," unless absolutely necessary. Global variables significantly degrade Lua performance."]}),"\n",(0,i.jsx)(n.h3,{id:"how-do-i-create-regexps-safely",children:"How do I create regexps safely?"}),"\n",(0,i.jsxs)(n.p,{children:["Regexp objects don't have garbage collection. ",(0,i.jsx)(n.strong,{children:"Always use the cache:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"-- CORRECT: Uses cached regexp\nlocal re = rspamd_regexp.create_cached('/pattern/')\n\n-- WRONG: Memory leak!\nlocal re = rspamd_regexp.create('/pattern/')\n"})}),"\n",(0,i.jsx)(n.p,{children:"If you must create dynamic regexps, destroy them manually:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"local re = rspamd_regexp.create(dynamic_pattern)\n-- ... use re ...\nre:destroy()\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Consider using ",(0,i.jsx)(n.a,{href:"/modules/multimap",children:"multimap"})," regexp maps for dynamic patterns."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,i.jsx)(n.h3,{id:"common-commands",children:"Common Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Configuration\nrspamadm configtest              # Validate configuration\nrspamadm configdump              # Show effective config\nrspamadm confighelp options      # Get help on options\n\n# Testing\nrspamc < message.eml             # Scan a message\nrspamc -p < message.eml          # Scan with all checks (Pass: all)\nrspamc stat                      # Show statistics\n\n# Learning\nrspamc learn_spam message.eml    # Train as spam\nrspamc learn_ham message.eml     # Train as ham\nrspamc -f 1 -w 10 fuzzy_add msg  # Add to fuzzy storage\n\n# Administration\nrspamadm control stat            # Runtime statistics\nrspamadm control fuzzystat       # Fuzzy storage statistics\nrspamadm pw                      # Generate password hash\n"})}),"\n",(0,i.jsx)(n.h3,{id:"common-paths",children:"Common Paths"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Path"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/rspamd/local.d/"})}),(0,i.jsx)(n.td,{children:"Local configuration overrides"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/etc/rspamd/override.d/"})}),(0,i.jsx)(n.td,{children:"High-priority overrides"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/var/lib/rspamd/"})}),(0,i.jsx)(n.td,{children:"Runtime data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/var/log/rspamd/rspamd.log"})}),(0,i.jsx)(n.td,{children:"Main log file"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"what-are-rspamc-and-rspamadm",children:"What are rspamc and rspamadm?"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Tool"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Communication"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rspamadm"})}),(0,i.jsx)(n.td,{children:"Administration"}),(0,i.jsx)(n.td,{children:"Local Unix socket"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rspamc"})}),(0,i.jsx)(n.td,{children:"Client operations"}),(0,i.jsx)(n.td,{children:"HTTP to scanner/controller"})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rspamadm help           # List admin commands\nrspamadm help <command> # Command-specific help\n\nrspamc --help           # Client help\nrspamc stat             # Get statistics via HTTP\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var r=s(6540);const i={},d=r.createContext(i);function l(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);