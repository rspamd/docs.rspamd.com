"use strict";(self.webpackChunkrspamd_docs=self.webpackChunkrspamd_docs||[]).push([[2105],{5768:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"modules/known_senders","title":"known_senders module","description":"The knownsenders plugin is designed to help you track and categorize email senders based on their domains. It allows you to maintain a list of known senders and classify incoming emails from these senders. This documentation will guide you through the configuration and usage of the knownsenders plugin.","source":"@site/docs/modules/known_senders.md","sourceDirName":"modules","slug":"/modules/known_senders","permalink":"/docs.rspamd.com/branches/master/modules/known_senders","draft":false,"unlisted":false,"editUrl":"https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/known_senders.md","tags":[],"version":"current","frontMatter":{"title":"known_senders module"},"sidebar":"docs","previous":{"title":"IP Score module","permalink":"/docs.rspamd.com/branches/master/modules/ip_score"},"next":{"title":"Mailing lists module","permalink":"/docs.rspamd.com/branches/master/modules/maillist"}}');var l=i(4848),o=i(8453);const r={title:"known_senders module"},d="Rspamd known_senders Plugin Documentation",t={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Plugin Overview",id:"plugin-overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Domains",id:"domains",level:3},{value:"Maximum Senders",id:"maximum-senders",level:3},{value:"Maximum Time to Live",id:"maximum-time-to-live",level:3},{value:"Use Bloom Filters",id:"use-bloom-filters",level:3},{value:"Unknown Sender Symbol",id:"unknown-sender-symbol",level:3},{value:"Verified Incoming Mail Global Symbol",id:"verified-incoming-mail-global-symbol",level:3},{value:"Verified Incoming Mail Local Symbol",id:"verified-incoming-mail-local-symbol",level:3},{value:"Sender Prefix",id:"sender-prefix",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsxs)(n.h1,{id:"rspamd-known_senders-plugin-documentation",children:["Rspamd ",(0,l.jsx)(n.code,{children:"known_senders"})," Plugin Documentation"]})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"known_senders"})," plugin is designed to help you track and categorize email senders based on their domains. It allows you to maintain a list of known senders and classify incoming emails from these senders. This documentation will guide you through the configuration and usage of the ",(0,l.jsx)(n.code,{children:"known_senders"})," plugin."]}),"\n",(0,l.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#plugin-overview",children:"Plugin Overview"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#configuration",children:"Configuration"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#domains",children:"Domains"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#maximum-senders",children:"Maximum Senders"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#maximum-time-to-live",children:"Maximum Time to Live"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#use-bloom-filters",children:"Use Bloom Filters"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#unknown-sender-symbol",children:"Unknown Sender Symbol"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#verified-incoming-mail-global-symbol",children:"Verified Incoming Mail Global Symbol"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#verified-incoming-mail-local-symbol",children:"Verified Incoming Mail Local Symbol"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#sender-prefix",children:"Sender Prefix"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"plugin-overview",children:"Plugin Overview"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"known_senders"})," plugin is used to maintain a list of known sender domains and classify incoming emails based on these domains. It can be especially useful for distinguishing known senders from potentially malicious or unknown ones. Also it can check if incoming ",(0,l.jsx)(n.code,{children:"in-reply-to"})," mail sender and recipients are verified. This plugin is available from the version 3.7.0."]}),"\n",(0,l.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsxs)(n.p,{children:["To configure the ",(0,l.jsx)(n.code,{children:"known_senders"})," plugin, you need to define it in your Rspamd configuration file (usually ",(0,l.jsx)(n.code,{children:"local.d/known_senders.conf"}),"). Below is an example configuration with explanations for each parameter:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-hcl",children:"# This plugin must be explicitly enabled to work\nenabled = true;\n# Domains to track senders\ndomains = \"https://maps.rspamd.com/freemail/free.txt.zst\";\n\n# Maximum number of elements\nmax_senders = 100000;\n\n# Maximum time to live (when not using bloom filters)\nmax_ttl = 30d;\n\n# Use bloom filters (must be enabled in Redis as a plugin)\nuse_bloom = false;\n\n# Insert symbol for new senders from the specific domains\nsymbol_unknown = 'UNKNOWN_SENDER';\n\n# Insert symbol for verified sender in global replies set\nsymbol_check_mail_global = 'INC_MAIL_KNOWN_GLOBALLY';\n\n# Insert symbol for verified recipients in local replies set\nsymbol_check_mail_local = 'INC_MAIL_KNOWN_LOCALLY';\n\n# Prefix for replies sets\nsender_prefix = 'rsrk';\n"})}),"\n",(0,l.jsx)(n.h3,{id:"domains",children:"Domains"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"domains"})," parameter specifies the URLs or file paths from which the plugin will retrieve sender domains to track. These domains are typically listed in a file in plain text or compressed format."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"maximum-senders",children:"Maximum Senders"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"max_senders"})," parameter sets the maximum number of sender domains that can be stored in the known senders list. Once this limit is reached, older entries may be removed to make room for new ones."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"maximum-time-to-live",children:"Maximum Time to Live"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"max_ttl"})," parameter defines the maximum time a sender domain can remain in the known senders list when not using bloom filters. It is specified in days (e.g., ",(0,l.jsx)(n.code,{children:"30d"}),"). After this period, the sender domain is considered unknown again."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"use-bloom-filters",children:"Use Bloom Filters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"use_bloom"})," parameter enables or disables the use of bloom filters for faster and memory-efficient lookup of known sender domains. To use bloom filters, follow these steps:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Enable Redis Bloom Plugin"}),": In your Redis configuration (usually ",(0,l.jsx)(n.code,{children:"redis.conf"}),"), enable the Redis Bloom plugin. This typically involves adding or uncommenting the following line (please bear in mind that you might need to ",(0,l.jsx)(n.a,{href:"https://github.com/RedisBloom/RedisBloom",children:"compile this plugin"})," manually):"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"loadmodule /path/to/redisbloom.so\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Once you have completed these steps, the ",(0,l.jsx)(n.code,{children:"known_senders"})," plugin will be able to use bloom filters for efficient tracking and classification of known sender domains."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"unknown-sender-symbol",children:"Unknown Sender Symbol"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"symbol_unknown"})," parameter specifies the symbol that will be inserted for new senders from the domains listed in the ",(0,l.jsx)(n.code,{children:"domains"})," configuration. This symbol can be used to further classify emails from unknown senders."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"verified-incoming-mail-global-symbol",children:"Verified Incoming Mail Global Symbol"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"symbol_check_mail_global"})," parameter specifies the symbol that will be inserted if sender in the incoming mail is verified by ",(0,l.jsx)(n.code,{children:"replies"})," module."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"verified-incoming-mail-local-symbol",children:"Verified Incoming Mail Local Symbol"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"symbol_check_mail_local"})," parameter specifies the symbol that will be inserted if recipients in the incoming mail is verified by ",(0,l.jsx)(n.code,{children:"replies"})," module."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"sender-prefix",children:"Sender Prefix"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Description"}),": The ",(0,l.jsx)(n.code,{children:"sender_prefix"})," parameter is used to define keys in the redis that denote replies sets."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Note"}),": If you changed ",(0,l.jsx)(n.code,{children:"sender_prefix"})," in ",(0,l.jsx)(n.code,{children:"local.d/replies.conf"})," you also need to change it in the ",(0,l.jsx)(n.code,{children:"local.d/known_senders.conf"}),"."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var s=i(6540);const l={},o=s.createContext(l);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);