<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-modules/external_services" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">External Services module | Rspamd Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_services"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="External Services module | Rspamd Documentation"><meta data-rh="true" name="description" content="The External Services module, which has been available since Rspamd 1.9.0, enables integration with a range of external services."><meta data-rh="true" property="og:description" content="The External Services module, which has been available since Rspamd 1.9.0, enables integration with a range of external services."><link data-rh="true" rel="icon" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_services"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/modules/external_services" hreflang="en"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_services" hreflang="ru"><link data-rh="true" rel="alternate" href="https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/modules/external_services" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Modules","item":"https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/"},{"@type":"ListItem","position":2,"name":"External Services module","item":"https://rspamd.com/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_services"}]}</script><link rel="alternate" type="application/rss+xml" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/blog/rss.xml" title="Rspamd Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/blog/atom.xml" title="Rspamd Documentation Atom Feed">




<script>window.SEARCH_BACKEND_CONFIG={endpoint:"/api"}</script><link rel="stylesheet" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/assets/css/styles.121a41fd.css">
<script src="/docs.rspamd.com/branches/vstakhov-docs-search/ru/assets/js/runtime~main.beea35c1.js" defer="defer"></script>
<script src="/docs.rspamd.com/branches/vstakhov-docs-search/ru/assets/js/main.d2abe2f4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/img/rspamd_logo_black.png"><link rel="preload" as="image" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/img/rspamd_logo_navbar.png"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.rspamd.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs.rspamd.com/branches/vstakhov-docs-search/ru/img/rspamd_logo_black.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs.rspamd.com/branches/vstakhov-docs-search/ru/img/rspamd_logo_navbar.png" alt="Rspamd Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/about/">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/tutorials/">Tutorials</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/">Modules</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/other/usage_policy">Usage Policy</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/faq">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/support">Support</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/downloads">Downloads</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/blog">Blog</a><a class="navbar__item navbar__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/changelog">Changelog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div><div class="elasticsearch-search-container"><form class="elasticsearch-search-form"><div class="elasticsearch-search-input-container"><input type="text" placeholder="Search documentation..." class="elasticsearch-search-input" aria-label="Search documentation" value=""><div class="elasticsearch-search-shortcut"><span>⌘K</span></div></div></form></div></div><div class="navbar__item"><div id="font-size-control-mount"></div></div><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Переключение между темным и светлым режимом (сейчас используется system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/">About Rspamd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/faq">Frequently asked questions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/about/">About</a><button aria-label="Expand sidebar category &#x27;About&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/support">Rspamd Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/downloads">Downloads</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/configuration/">Configuration</a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/workers/">Workers</a><button aria-label="Expand sidebar category &#x27;Workers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/">Modules</a><button aria-label="Collapse sidebar category &#x27;Modules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/antivirus">Antivirus module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/arc">ARC module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/asn">ASN module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/bayes_expiry">Bayes expiry module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/chartable">Chartable module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/clickhouse">Clickhouse module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/dcc">DCC module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/dkim">DKIM module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/dkim_signing">DKIM signing module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/dmarc">DMARC module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/elastic">Elasticsearch module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/emails">Emails module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_relay">External Relay module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_services">External Services module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/force_actions">Force Actions module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/fuzzy_check">Fuzzy check module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/gpt">GPT Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/greylisting">Greylisting module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/hfilter">Hfilter module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/history_redis">Redis history module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/ip_score">IP Score module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/known_senders">known_senders module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/maillist">Mailing lists module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/metadata_exporter">Metadata exporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/metric_exporter">Metric exporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/mid">MID module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/milter_headers">Milter headers module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/mime_types">Mime types modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/multimap">Multimap module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/mx_check">MX Check module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/neural">Neural network module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/once_received">Once received module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/phishing">Phishing module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/ratelimit">Ratelimit module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/rbl">RBL module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/regexp">Regexp module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/replies">Replies module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/reputation">Reputation module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/rspamd_update">Rspamd update module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/spamassassin">SpamAssassin rules module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/spamtrap">Spamtrap module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/spf">SPF module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/surbl">SURBL module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/trie">Trie module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/url_redirector">URL redirector module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/whitelist">Whitelist module</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/lua/">Lua API</a><button aria-label="Expand sidebar category &#x27;Lua API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/developers/architecture">Developers</a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/other/rspamadm">Other</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/blog">Blog</a></li></ul></nav><button type="button" title="Свернуть сайдбар" aria-label="Свернуть сайдбар" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/"><span>Modules</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">External Services module</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><header><h1>External Services module</h1></header>
<p>The External Services module, which has been available since Rspamd 1.9.0, enables integration with a range of external services.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Прямая ссылка на Configuration" title="Прямая ссылка на Configuration">​</a></h2>
<p>To configure an external service, rules must be defined. If the service detects one or more threats, the configured symbol (such as ICAP_VIRUS) will be set with a description of the threats. If this symbol is set, the reject action will be triggered.</p>
<p>In case of connection errors or failures reported by the external service, the fail symbol (e.g. ICAP_VIRUS_FAIL) will be set with an error message as its description. Patterns can be used for both symbols to assign a dedicated symbol for any threat name or error message.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # symbol_name = &quot;pattern&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JUST_EICAR = &#x27;^Eicar-Test-Signature$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns_fail { # 1.9.0+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # symbol_name = &quot;pattern&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ICAP_LIMITS_EXCEEDED = &#x27;^Container size violation$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<p>By default, the complete email will be sent to the external service system. You can and you have to change this behavior for some services by setting <code>scan_mime_parts = true;</code> to send all mime parts detected as attachments separately. If you also want to scan text mimes and images using the AV scanner, you can set the <code>scan_text_mime</code> or <code>scan_image_mime</code> parameter to &quot;true&quot;.</p>
<p>Furthermore, there are two types of MIME part filters available:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_regex {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE1 = &quot;^invoice\.xls$&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOC1 = &quot;application\/msword&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOC2 = &quot;application\/vnd\.ms-word.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GEN2 = &quot;application\/vnd\.openxmlformats-officedocument.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Mime-Part filename extension matching (no regex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_ext {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doc = &quot;doc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docx = &quot;docx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<p><code>mime_parts_filter_regex</code> will match on the content-type detected by rspamd or mime part header or the declared filename of an attachment or an archive file listing. <code>mime_parts_filter_ext</code> will only match the extension of the declared filename or an archives file list.</p>
<p>Apart from the default settings, specific configuration options need to be set for each rule as described below.</p>
<p>By default, if <a href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/configuration/redis">Redis</a> is configured globally and <code>external_services</code> is not disabled in the Redis configuration, the results will be cached in Redis based on message checksums.</p>
<p>To add settings, modify the <code>/etc/rspamd/local.d/external_services.conf</code> file:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># multiple scanners could be checked, for each we create a configuration block with an arbitrary name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">icap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:1344&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # symbol to add (add it to metric if you want non-zero weight)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbol = &quot;ICAP_VIRUS&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # type of scanner: &quot;icap&quot;, &quot;oletools&quot;, &quot;dcc&quot; or &quot;vadesecure&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Scan mime_parts separately - otherwise the complete mail will be transferred</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #scan_mime_parts = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #scan_text_mime = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #scan_image_mime = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # filter attachments by content-type, filename or filename extension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # setting a filter will also enable scan_mime_parts = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_regex {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE1 = &quot;^invoice\.xls$&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOC1 = &quot;application\/msword&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_ext {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doc = &quot;doc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docx = &quot;docx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # If set force this action if any threat is found (default unset: no action is forced)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # action = &quot;reject&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # If `max_size` is set, messages &gt; n bytes in size are not scanned</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #max_size = 20000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # If set true, log message is emitted for clean messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #log_clean = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # if `patterns` is specified threat name will be matched against provided regexes and the related</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # symbol will be yielded if a match is found. If no match is found, default symbol is yielded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # symbol_name = &quot;pattern&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JUST_EICAR = &#x27;^Eicar-Test-Signature$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # same as above, but matching on the _FAIL symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns_fail {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # symbol_name = &quot;pattern&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # In version 1.7.0+ patterns could be extended</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #patterns = {SANE_MAL = &#x27;Sanesecurity\.Malware\.*&#x27;, CLAM_UNOFFICIAL = &#x27;UNOFFICIAL$&#x27;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # `whitelist` points to a map of IP addresses. Mail from these addresses is not scanned.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  whitelist = &quot;/etc/rspamd/antivirus.wl&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="icap-protocol-specific-details">ICAP protocol specific details<a href="#icap-protocol-specific-details" class="hash-link" aria-label="Прямая ссылка на ICAP protocol specific details" title="Прямая ссылка на ICAP protocol specific details">​</a></h2>
<p>ICAP servers are typically utilized by HTTP proxies or file servers to scan HTTP requests or files. In Rspamd, only the RESPMOD method is supported. In addition to the X-Infection-Found and X-Virus-ID headers, Rspamd also attempts to evaluate other uncommon headers.</p>
<p>Starting from version 3.2, Rspamd supports the complete ICAP protocol, which includes encapsulated HTTP headers. It is also capable of evaluating encapsulated HTTP return codes.</p>
<p>This module has been tested with the following ICAP implementations:</p>
<ul>
<li>Checkpoint Sandblast</li>
<li>ClamAV (using c-icap server and squidclamav)</li>
<li>ESET Server Security for Linux 9.0</li>
<li>F-Secure Internet Gatekeeper</li>
<li>Kaspersky Scan Engine 2.0</li>
<li>Kaspersky Web Traffic Security 6.0</li>
<li>McAfee Web Gateway 9/10/11</li>
<li>Metadefender ICAP</li>
<li>Sophos (via SAVDI)</li>
<li>Symantec Protection Engine for Cloud Services (Rspamd &lt;3.2, &gt;=3.2 untested)</li>
<li>Trend Micro InterScan Web Security Virtual Appliance (IWSVA)</li>
<li>Trend Micro IWSVA 6.0</li>
<li>Trend Micro Web Gateway</li>
</ul>
<p>Please report other working or non-working icap implementations.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clamav_icap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;squidclamav&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>Scan requests are send to an icap URL (e.g. icap://127.0.0.1:1344/squidclamav). herefore, a scheme is required to communicate with the ICAP server in addition to the host and port. Since ICAP servers often have multiple schemes, it is necessary to choose one with RESPMOD support.</p>
<p>If typical error responses are encountered, such as <code>X-Infection-Found: Type=2; Resolution=2; Threat=Encrypted container violation;</code>, they will be reported as a fail symbol (e.g. CLAM_ICAP_FAIL(0.00){Encrypted container violation}).</p>
<p>Depending on the ICAP software there are some extra options available:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">icap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user_agent = &quot;Rspamd&quot;; # Use none, extended or a self defined name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true; # Add X-Client-IP: $IP header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_rcpt_header = true; # Add X-Rcpt-To: $SMTP_RCPT header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_from_header = true; # Add X-Mail-From: $SMTP_FROM header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>Here some configuration examples for ICAP capable products:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># C-ICAP Squidclamav</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">squidclamav {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;squidclamav&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Checkpoint Sandblast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sandblast {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;sandblast&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ESET Gateway Security / Antivirus for Linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;scan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># F-Secure Internet Gatekeeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f-secure {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;respmod&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_rcpt_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_from_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Kaspersky Scan Engine 2.0 (as configured in kavicapd.xml):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kaspersky {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;resp&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Kaspersky Web Traffic Security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kaspersky {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;av/respmod&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># McAfee Web Gateway 9/10/11 (Headers must be activated with personal extra Rules)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mcafee {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;respmod&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Metadefender ICAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadefender {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sophos SAVDI example:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sophos {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # scheme as configured in savdi.conf (name option in service section)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;respmod&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Symantec Protection Engine for Cloud Services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">symantec {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;avscan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Trend Micro IWSVA example (X-Virus-ID/X-Infection-Found headers must be activated):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trend_micro {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;avscan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Trend Micro Web Gateway example (X-Virus-ID/X-Infection-Found headers must be activated):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trend_micro {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;icap&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scheme = &quot;interscan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x_client_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="oletools-specific-details">oletools specific details<a href="#oletools-specific-details" class="hash-link" aria-label="Прямая ссылка на oletools specific details" title="Прямая ссылка на oletools specific details">​</a></h2>
<p>Oletools is an excellent Python module for scanning and analyzing office documents containing macros. Macro-viruses typically use an auto-exec function to load when the document is opened, as well as functions for executing code in a shell or saving files to the system. Oletools classifies harmful functions as either AutoExec or Suspicious. In the default mode, the Oletools module sets the result when at least one AutoExec and one Suspicious function are used.</p>
<p>Please keep in mind that Oletools is not an antivirus scanner. It only analyzes macros. Additionally, there are legitimate office files that contain AutoExec and Suspicious functions. Furthermore, some macro viruses do not use AutoExec functions. If you want more detailed control over the behavior of the Oletools module, please refer to the extended mode below. You may also want to refer to the olevba documentation at <a href="https://github.com/decalage2/oletools/wiki/olevba" target="_blank" rel="noopener noreferrer">https://github.com/decalage2/oletools/wiki/olevba</a></p>
<p>The default behavior of Oletools is useful if you do not want to block all office files with macros, but rather files with macros that use functions typically seen in macro viruses.</p>
<p><strong>Note</strong>: Some Word files may have the .doc extension but actually use the Rich Text Format (RTF), which has its own security vulnerabilities. Currently, oletools returns a RETURN_OPEN_ERROR for RTF files, but this issue will be resolved in a future release.</p>
<p>To use oletools with Rspamd, you need to install a wrapper daemon called <a href="https://github.com/HeinleinSupport/olefy" target="_blank" rel="noopener noreferrer">olefy</a>.</p>
<p>Olefy communicates with Rspamd over TCP and utilizes olevba to generate a report on an office file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oletools-default-mode">oletools default mode<a href="#oletools-default-mode" class="hash-link" aria-label="Прямая ссылка на oletools default mode" title="Прямая ссылка на oletools default mode">​</a></h3>
<p>In order to send only office files to the olevba analyzer enable scan_mime_parts (needed for versions &lt; 1.9.5) set mime_parts_filter_regex and mime_parts_filter_ext like shown below (maybe this list is still incomplete). It is worth noting that sometimes office files may be sent with the generic content-type <code>application/octet-stream</code>. You can enable the <code>UNKNOWN</code> option to capture these, but this may also capture non-office file attachments such as images, PDFs, and so on. Attempting to send non-office files to olevba will result in error messages.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oletools {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # default olefy settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:10050&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # needs to be set explicitly for Rspamd &lt; 1.9.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scan_mime_parts = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # mime-part regex matching in content-type or filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_regex {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #UNKNOWN = &quot;application\/octet-stream&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOC2 = &quot;application\/msword&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOC3 = &quot;application\/vnd\.ms-word.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    XLS = &quot;application\/vnd\.ms-excel.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPT = &quot;application\/vnd\.ms-powerpoint.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GENERIC = &quot;application\/vnd\.openxmlformats-officedocument.*&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # mime-part filename extension matching (no regex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mime_parts_filter_ext {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doc = &quot;doc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dot = &quot;dot&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docx = &quot;docx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dotx = &quot;dotx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docm = &quot;docm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dotm = &quot;dotm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xls = &quot;xls&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xlt = &quot;xlt&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xla = &quot;xla&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xlsx = &quot;xlsx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xltx = &quot;xltx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xlsm = &quot;xlsm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xltm = &quot;xltm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xlam = &quot;xlam&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xlsb = &quot;xlsb&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppt = &quot;ppt&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pot = &quot;pot&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pps = &quot;pps&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppa = &quot;ppa&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pptx = &quot;pptx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    potx = &quot;potx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppsx = &quot;ppsx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppam = &quot;ppam&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pptm = &quot;pptm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    potm = &quot;potm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppsm = &quot;ppsm&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>By default, when using the oletools module, a symbol description will be set as <code>OLETOOLS(1.00)[AutoExec + Suspicious (Document_open,Shell,Chr)]</code>. The words inside the brackets are the macro functions reported by olevba.</p>
<p>If you enable debug mode for external_services the oletools module will also report the description of a function as reported by olevba.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oletools-extended-mode">oletools extended mode<a href="#oletools-extended-mode" class="hash-link" aria-label="Прямая ссылка на oletools extended mode" title="Прямая ссылка на oletools extended mode">​</a></h3>
<p>In extended mode, the oletools module does not trigger on specific categories but always sets a threat string with all the found flags whenever a macro is detected. These flags are sorted alphabetically and displayed at the same position every time they are set. Additionally, all reported functions are set as individual threats. For instance, <code>OLETOOLS (4.00)[A----MS-, Document_open, Shell, Chr]</code>indicates four threats reported: one for the flag list and one for each reported function. Note that the symbol score is counted four times. If you want to modify this behavior, you can use <code>one_shot = true</code>.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services_group.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;OLETOOLS&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 1.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;OLETOOLS found a Macro&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    one_shot = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<p>By having the flags and functions as individual threats, it becomes possible to use the pattern configuration to convert the reported threats into symbols that can be utilized in force_actions or composites.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oletools {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  extended = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # catch Macro, AutoExec, Suspicious and Hex Strings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BAD_MACRO_MYFLAGS   = &#x27;^A..H.MS.$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BAD_MACRO_RISKY_IOC = &#x27;^A...IMS.$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BAD_MACRO_SHELL     = &#x27;^Shell$&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>You can then use those patterns in the group configuration:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services_group.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description = &quot;Oletools content rules&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">symbols = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;OLETOOLS&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 1.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;OLETOOLS found a Macro&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    one_shot = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;BAD_MACRO_MYFLAGS&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 5.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Suspicious hex strings in office document&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;BAD_MACRO_RISKY_IOC&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 10.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Risky macro in office document&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>A little help for the 8 flags:</p>
<p><code>ABDHIMSV</code> or <code>A-------</code></p>
<ul>
<li>A=Auto-executable (auto-executable macros)</li>
<li>B=Base64 strings (Base64-encoded strings (potential obfuscation))</li>
<li>D=Dridex strings (Dridex-encoded strings (potential obfuscation))</li>
<li>H=Hex strings (hex-encoded strings (potential obfuscation))</li>
<li>I=IOCs (macro contains IP, URL or executable filename)</li>
<li>M=Macros (contains VBA Macros)</li>
<li>S=Suspicious keywords (suspicious VBA keywords)</li>
<li>V=VBA strings (VBA string expressions (potential obfuscation))</li>
</ul>
<p>Note that in versions &lt;= 2.7, flags were ordered but stacked to the right in the flag string. For instance, if flags <code>A</code>, <code>I</code>, <code>M</code> and <code>S</code> are be set, the resulting flag string would be <code>----AIMS</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dcc-specific-details">DCC specific details<a href="#dcc-specific-details" class="hash-link" aria-label="Прямая ссылка на DCC specific details" title="Прямая ссылка на DCC specific details">​</a></h2>
<p>This modules performs <a href="https://www.dcc-servers.net/dcc/" target="_blank" rel="noopener noreferrer">DCC</a> lookups to determine
the <em>bulkiness</em> of a message (e.g. how many recipients have seen it).</p>
<p>This is particularly valuable in composite rules, such as when a message is from a freemail domain AND it is identified as bulk by DCC, making it easier to classify it as spam and assign a higher weight to it.</p>
<p>Before enabling this module, kindly review the License terms on the DCC website.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-configuration">Module configuration<a href="#module-configuration" class="hash-link" aria-label="Прямая ссылка на Module configuration" title="Прямая ссылка на Module configuration">​</a></h3>
<p>This module requires that you have the <code>dccifd</code> daemon configured, running and
working correctly.  To do this you must download and build the [latest DCC client]
(<a href="https://www.dcc-servers.net/dcc/source/dcc.tar.Z" target="_blank" rel="noopener noreferrer">https://www.dcc-servers.net/dcc/source/dcc.tar.Z</a>). Once installed, edit
<code>/var/dcc/dcc_conf</code> set <code>DCCIFD_ENABLE=on</code> and set <code>DCCM_LOG_AT=NEVER</code> and
<code>DCCM_REJECT_AT=MANY</code>. Maybe you want DCC to listen to a TCP socket by setting <code>DCCIFD_ARGS=&quot;-SHELO -Smail_host -SSender -SList-ID -p *,10045,127.0.0.0/8&quot;</code>.</p>
<p>Then start the daemon by running <code>/var/dcc/libexec/rcDCC start</code>.</p>
<p>Once the <code>dccifd</code> daemon is started it will listen on the UNIX domain socket /var/dcc/dccifd or on localhost port 10045
and all you have to do is tell the rspamd where <code>dccifd</code> is listening.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dcc {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #servers = &quot;/var/dcc/dccifd&quot; # use unix socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #servers = &quot;127.0.0.1:10045&quot; # use tcp socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>DCC identifies bulky mails by creating hash and therefor DCC needs the complete message to work properly. <code>scan_mime_parts = false</code> is already set in the defaults.</p>
<p>Any messages that DCC returns a <em>reject</em> result for (based on the configured <code>DCCM_REJECT_AT</code>
value) will cause the symbol <code>DCC_REJECT</code> to fire. <code>DCC_BULK</code> will be calculated from the body, fuz1, fuz2 return values and has a dynamic score.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pyzor-specific-details">Pyzor specific details<a href="#pyzor-specific-details" class="hash-link" aria-label="Прямая ссылка на Pyzor specific details" title="Прямая ссылка на Pyzor specific details">​</a></h2>
<p><code>Requires rspamd &gt;2.8</code></p>
<p>Pyzor is a bulk email scanner similar to Razor2 and DCC, which doesn&#x27;t identify spam but instead identifies how often a message (hash) has been seen or how &quot;bulky&quot; a message is.</p>
<p>To integrate Pyzor with Rspamd, a wrapper isn&#x27;t needed as it will be exposed to Rspamd through a systemd socket. To install Pyzor on CentOS/Rocky Linux, run the command <code>yum install pyzor</code>.</p>
<p>After installing Pyzor, enable the module by:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pyzor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # default pyzor settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:5953&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Restart rspamd <code>systemctl restart rspamd</code></p>
<p>Add the systemd socket and service:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># /usr/lib/systemd/system/pyzor.socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Pyzor socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Socket]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenStream=127.0.0.1:5953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept=yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=sockets.target</span><br></span></code></pre></div></div>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># /usr/lib/systemd/system/pyzor@.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Pyzor Socket Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requires=pyzor.socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=-/usr/bin/pyzor check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardInput=socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardError=journal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TimeoutStopSec=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User=_rspamd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NoNewPrivileges=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateDevices=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateTmp=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateUsers=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectControlGroups=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectHome=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectKernelModules=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectKernelTunables=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectSystem=strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre></div></div>
<p>Reload systemd <code>systemctl daemon-reload</code> and enable/start pyzor socket <code>systemctl enable pyzor.socket &amp;&amp; systemctl start pyzor.socket</code></p>
<p><code>pyzor.socket</code> will call <code>pyzor@.service</code> so there is no need to enable/start <code>pyzor@.service</code></p>
<p>Since Pyzor is executed as <code>_rspamd</code> you probably have to create the Pyzor home directory <code>mkdir /var/lib/rspamd/.pyzor</code>, alternatively create a dedicated Pyzor user and edit <code>pyzor@.service</code>.</p>
<p>Once Pyzor is running, the <code>PYZOR</code> symbol weight is calculated dynamically based on the number of times a message has been seen and whitelisted by Pyzor (Count - WL-Count of default_score in percent)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="razor-specific-details">Razor specific details<a href="#razor-specific-details" class="hash-link" aria-label="Прямая ссылка на Razor specific details" title="Прямая ссылка на Razor specific details">​</a></h2>
<p>Razor is, like Pyzor and DCC, a bulk email scanner that doesn&#x27;t detect spam but how often a message (hash) has been seen, or how &quot;bulky&quot; a message is.</p>
<p>To expose Razor to rspamd, a systemd socket is used, and a wrapper is not required.</p>
<p>To install Razor on CentOS/Rocky Linux, run the command yum install <code>perl-Razor-Agent</code>.</p>
<p>After installation, enable the module by modifying the configuration file.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">razor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # default razor settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:11342&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Restart rspamd <code>systemctl restart rspamd</code></p>
<p>Add the systemd socket and service:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># /usr/lib/systemd/system/razor.socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Razor socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Socket]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenStream=127.0.0.1:11342</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept=yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=sockets.target</span><br></span></code></pre></div></div>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># /usr/lib/systemd/system/razor@.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Razor Socket Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requires=razor.socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/bin/sh -c &#x27;/usr/bin/razor-check &amp;&amp; /usr/bin/echo -n &quot;spam&quot; || /usr/bin/echo -n &quot;ham&quot;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardInput=socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardError=journal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TimeoutStopSec=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User=_rspamd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NoNewPrivileges=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateDevices=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateTmp=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateUsers=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectControlGroups=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectHome=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectKernelModules=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectKernelTunables=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProtectSystem=strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre></div></div>
<p>Reload systemd <code>systemctl daemon-reload</code> and enable/start razor socket <code>systemctl enable razor.socket &amp;&amp; systemctl start razor.socket</code></p>
<p><code>razor.socket</code> will call <code>razor@.service</code> so there is no need to enable/start <code>razor@.service</code></p>
<p>The <code>RAZOR</code> symbole will be added based on the exit code of Razor (0 = SPAM or 1 = HAM)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vadesecure-specific-details">VadeSecure specific details<a href="#vadesecure-specific-details" class="hash-link" aria-label="Прямая ссылка на VadeSecure specific details" title="Прямая ссылка на VadeSecure specific details">​</a></h2>
<p>To use the VadeSecure module, a valid installation of Filterd from <a href="https://www.vadesecure.com/en/isp-products/" target="_blank" rel="noopener noreferrer">VadeSecure</a> is required. Please <a href="https://www.vadesecure.com" target="_blank" rel="noopener noreferrer">contact VadeSecure</a> to obtain a valid trial or commercial license to get this product.</p>
<p>Once installed, you can use VadeSecure to adjust symbols based on the category returned by Filterd. The default settings for this module are listed below and can be redefined in the <code>local.d/external_services.conf</code> file as needed:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vadesecure {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = 127.0.0.1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default_port = 23808,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  url = &#x27;/api/v1/scan&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use_https = false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout = 5.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_clean = false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retransmits = 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cache_expire = 7200,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message = &#x27;${SCANNER}: spam message found: &quot;${VIRUS}&quot;&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  detection_category = &quot;hash&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default_score = 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  action = false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_spamcause = true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbol_fail = &#x27;VADE_FAIL&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbol = &#x27;VADE_CHECK&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbols = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_CLEAN&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = -0.5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be clean&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spam = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      high = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        symbol = &#x27;VADE_SPAM_HIGH&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score = 8.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        description = &#x27;VadeSecure decided message to be clearly spam&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      medium = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        symbol = &#x27;VADE_SPAM_MEDIUM&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score = 5.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        description = &#x27;VadeSecure decided message to be highly likely spam&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      low = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        symbol = &#x27;VADE_SPAM_LOW&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score = 2.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        description = &#x27;VadeSecure decided message to be likely spam&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    malware = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_MALWARE&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 8.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be malware&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scam = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_SCAM&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 7.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be scam&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phishing = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_PHISHING&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 8.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be phishing&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    commercial =  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_COMMERCIAL&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 0.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be commercial message&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    community =  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_COMMUNITY&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 0.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be community message&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactional =  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_TRANSACTIONAL&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 0.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be transactional message&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    suspect = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_SUSPECT&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 3.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be suspicious message&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bounce = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      symbol = &#x27;VADE_BOUNCE&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      score = 0.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      description = &#x27;VadeSecure decided message to be bounce message&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    other = &#x27;VADE_OTHER&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>You can define subcategories for symbols if needed (see <code>spam</code> example above).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="spamassassin-specific-details">SpamAssassin specific details<a href="#spamassassin-specific-details" class="hash-link" aria-label="Прямая ссылка на SpamAssassin specific details" title="Прямая ссылка на SpamAssassin specific details">​</a></h2>
<p>Note that the SpamAssassin module in External Services requires the use of the spamd daemon. However, please keep in mind that there is also a dedicated SpamAssassin module for Rspamd, which offers different benefits. The dedicated module can load SpamAssassin rules directly into the Rspamd environment, whereas the External Services module communicates with a separate SpamAssassin installation.</p>
<p>It&#x27;s worth noting that compared to Rspamd, SpamAssassin is much more CPU-intensive and may slow down your server. If you only need to use your existing SpamAssassin rules, the dedicated module is a better option, or you could transfer your rules into multimaps and/or composites.</p>
<p>However, the External Services module offers the benefit of supporting all SpamAssassin features and plugins, such as iXHash. If you&#x27;re using the Neural Network plugin, you may not want to import thousands of extra symbols into Rspamd. Additionally, this module could be a good choice for a soft migration from a SpamAssassin setup to Rspamd.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spamd-setup">Spamd setup<a href="#spamd-setup" class="hash-link" aria-label="Прямая ссылка на Spamd setup" title="Прямая ссылка на Spamd setup">​</a></h3>
<p>Enable the spamassassin spamd daemon to listen on a socket or a TCP port. To improve performance, you may want to consider disabling any unused plugins or remote checks by editing the configuration files located in /etc/mail/spamassassin.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spamassassin-module-default-setup">spamassassin module default setup<a href="#spamassassin-module-default-setup" class="hash-link" aria-label="Прямая ссылка на spamassassin module default setup" title="Прямая ссылка на spamassassin module default setup">​</a></h3>
<p>By default, no special configuration is required for this module. It will automatically set all reported SpamAssassin symbols as strings into the Rspamd SPAMD symbol, and the score reported by spamd will be set as the dynamic score. If you specify a weight for the symbol, it will be used as a multiplier. So, the total score will be calculated as <code>dynamic_score * weight</code>.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spamassassin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbol = &quot;SPAMD&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;spamassassin&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:783&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spamassassin-module-extended-setup">spamassassin module extended setup<a href="#spamassassin-module-extended-setup" class="hash-link" aria-label="Прямая ссылка на spamassassin module extended setup" title="Прямая ссылка на spamassassin module extended setup">​</a></h3>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spamassassin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  extended = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>When setting <code>extended = true</code> the module will set all reported symbols as dedicated threats. However, keep in mind that in the extended configuration, the score is calculated by multiplying the number of threats with the dynamic score and weight, resulting in the total score. If you want to change this behavior, you can <code>set one_shot = true</code>.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services_group.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">symbols = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;SPAMD&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 1.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;SPAMD found symbols&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    one_shot = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Having every symbol set as dedicated threat it is possible to set a Rspamd symbol for reported spamassassin symbols using patters.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spamassassin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  patterns {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # symbol_name = &quot;pattern&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SPAMD_NIXSPAM_IXHASH = &quot;^NIXSPAM_IXHASH$&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SPAMD_GENERIC_IXHASH = &quot;^GENERIC_IXHASH$&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="virustotal-details">Virustotal details<a href="#virustotal-details" class="hash-link" aria-label="Прямая ссылка на Virustotal details" title="Прямая ссылка на Virustotal details">​</a></h2>
<p>To receive results, Rspamd utilizes the <a href="https://virustotal.readme.io/v2.0/reference/file-report" target="_blank" rel="noopener noreferrer"><code>file/report</code></a> endpoint of Virustotal. However, due to the strict policies of Virustotal, it is crucial that you have set your own key in the plugin configuration:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/antivirus.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virustotal {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Obtained from Virustotal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apikey = &quot;xxx&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Change if you use private mirror or another API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #url = &#x27;https://www.virustotal.com/vtapi/v2/file&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Minimum required to get scored</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #minimum_engines = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # After this number we set max score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #full_score_engines = 7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Due to the strict policies of Virustotal, Rspamd does not return the full result. Instead, it only provides the number of engines that matched and the MD5 hash, which can be used to view the full report on the Virustotal website.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloudmark-specific-details">Cloudmark specific details<a href="#cloudmark-specific-details" class="hash-link" aria-label="Прямая ссылка на Cloudmark specific details" title="Прямая ссылка на Cloudmark specific details">​</a></h2>
<p>The cloudmark external service requires Cloudmark Authority Server, refer to the cloudmark website for information.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cloudmark {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = &quot;cloudmark&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  servers = &quot;127.0.0.1:2780&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use_https = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  action = &quot;process&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout = 5.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # add X-CMAE-Score header to the email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add_score_header = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # add additional cloudmark headers to the email </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add_headers = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # log clean messages as well</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_clean = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the threshold at which you consider message spam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  score_threshold = 90;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # maximum message size to scan, 0 to disable and send every message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  max_message = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # symbol to use when scan detects spam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  symbol_spam = &#x27;CLOUDMARK_SPAM&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # a table with match { [score_threshold] = symbol, ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # this allows you to score different thresholds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scores_symbols = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    100: &quot;CLOUDMARK100&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    95: &quot;CLOUDMARK95&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0: &quot;CLOUDMARK0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>You can configure symbol scores in the external_services_group.yml</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># local.d/external_services_group.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">symbols =  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CLOUDMARK_SPAM {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 5.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Spam detected by Cloudmark&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CLOUDMARK100 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 2.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Spam detected by Cloudmark&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CLOUDMARK95 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 1.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Spam detected by Cloudmark&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CLOUDMARK0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight = 0.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description = &quot;Cloudmark HAM&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rspamd/docs.rspamd.com/edit/master/docs/modules/external_services.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Отредактировать эту страницу</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/external_relay"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">External Relay module</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules/force_actions"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Force Actions module</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#icap-protocol-specific-details" class="table-of-contents__link toc-highlight">ICAP protocol specific details</a></li><li><a href="#oletools-specific-details" class="table-of-contents__link toc-highlight">oletools specific details</a><ul><li><a href="#oletools-default-mode" class="table-of-contents__link toc-highlight">oletools default mode</a></li><li><a href="#oletools-extended-mode" class="table-of-contents__link toc-highlight">oletools extended mode</a></li></ul></li><li><a href="#dcc-specific-details" class="table-of-contents__link toc-highlight">DCC specific details</a><ul><li><a href="#module-configuration" class="table-of-contents__link toc-highlight">Module configuration</a></li></ul></li><li><a href="#pyzor-specific-details" class="table-of-contents__link toc-highlight">Pyzor specific details</a></li><li><a href="#razor-specific-details" class="table-of-contents__link toc-highlight">Razor specific details</a></li><li><a href="#vadesecure-specific-details" class="table-of-contents__link toc-highlight">VadeSecure specific details</a></li><li><a href="#spamassassin-specific-details" class="table-of-contents__link toc-highlight">SpamAssassin specific details</a><ul><li><a href="#spamd-setup" class="table-of-contents__link toc-highlight">Spamd setup</a></li><li><a href="#spamassassin-module-default-setup" class="table-of-contents__link toc-highlight">spamassassin module default setup</a></li><li><a href="#spamassassin-module-extended-setup" class="table-of-contents__link toc-highlight">spamassassin module extended setup</a></li></ul></li><li><a href="#virustotal-details" class="table-of-contents__link toc-highlight">Virustotal details</a></li><li><a href="#cloudmark-specific-details" class="table-of-contents__link toc-highlight">Cloudmark specific details</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/tutorials/quickstart">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/configuration">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/modules">Modules</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/tutorials">Tutorials</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/downloads">Downloads</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/changelog">Changelog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rspamd/rspamd" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/tutorials/site_contributing">Contributing</a></li><li class="footer__item"><a class="footer__link-item" href="/docs.rspamd.com/branches/vstakhov-docs-search/ru/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Rspamd Project. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>